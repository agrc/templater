//>>built
define("dojox/wire/ml/Invocation",["dojo","dijit","dojox","dojo/require!dojox/wire/ml/Action"],function(e,t,i){e.provide("dojox.wire.ml.Invocation"),e.require("dojox.wire.ml.Action"),e.declare("dojox.wire.ml.Invocation",i.wire.ml.Action,{object:"",method:"",topic:"",parameters:"",result:"",error:"",_run:function(){if(this.topic){var t=this._getParameters(arguments);try{e.publish(this.topic,t),this.onComplete()}catch(a){this.onError(a)}}else if(this.method){var n=this.object?i.wire.ml._getValue(this.object):e.global;if(!n)return;var t=this._getParameters(arguments),o=n[this.method];if(!o){if(o=n.callMethod,!o)return;t=[this.method,t]}try{var r=!1;if(n.getFeatures){var s=n.getFeatures();if("fetch"==this.method&&s["dojo.data.api.Read"]||"save"==this.method&&s["dojo.data.api.Write"]){var l=t[0];l.onComplete||(l.onComplete=function(){}),this.connect(l,"onComplete","onComplete"),l.onError||(l.onError=function(){}),this.connect(l,"onError","onError"),r=!0}}var d=o.apply(n,t);if(!r)if(d&&d instanceof e.Deferred){var c=this;d.addCallbacks(function(e){c.onComplete(e)},function(e){c.onError(e)})}else this.onComplete(d)}catch(a){this.onError(a)}}},onComplete:function(e){this.result&&i.wire.ml._setValue(this.result,e),this.error&&i.wire.ml._setValue(this.error,"")},onError:function(e){this.error&&(e&&e.message&&(e=e.message),i.wire.ml._setValue(this.error,e))},_getParameters:function(t){if(!this.parameters)return t;var a=[],n=this.parameters.split(",");if(1==n.length){var o=i.wire.ml._getValue(e.trim(n[0]),t);e.isArray(o)?a=o:a.push(o)}else for(var r in n)a.push(i.wire.ml._getValue(e.trim(n[r]),t));return a}})});//# sourceMappingURL=Invocation.js.map