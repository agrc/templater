//>>built
define("dojox/gfx3d/scheduler",["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","./_base","./vector"],function(e,t,i,r,a){r.scheduler={zOrder:function(e,t){return t=t?t:r.scheduler.order,e.sort(function(e,i){return t(i)-t(e)}),e},bsp:function(e,i){i=i?i:r.scheduler.outline;var a=new r.scheduler.BinarySearchTree(e[0],i);return t.forEach(e.slice(1),function(e){a.add(e,i)}),a.iterate(i)},order:function(e){return e.getZOrder()},outline:function(e){return e.getOutline()}};var o=i("dojox.gfx3d.scheduler.BinarySearchTree",null,{constructor:function(e,t){this.plus=null,this.minus=null,this.object=e;var i=t(e);this.orient=i[0],this.normal=a.normalize(i)},add:function(e,i){var o=.5,n=i(e),s=a,d=this.normal,l=this.orient,u=r.scheduler.BinarySearchTree;if(t.every(n,function(e){return Math.floor(o+s.dotProduct(d,s.substract(e,l)))<=0}))this.minus?this.minus.add(e,i):this.minus=new u(e,i);else{if(!t.every(n,function(e){return Math.floor(o+s.dotProduct(d,s.substract(e,l)))>=0}))throw"The case: polygon cross siblings' plate is not implemented yet";this.plus?this.plus.add(e,i):this.plus=new u(e,i)}},iterate:function(e){var t=.5,i=a,r=[],o=null,n={x:0,y:0,z:-1e4};return o=Math.floor(t+i.dotProduct(this.normal,i.substract(n,this.orient)))<=0?[this.plus,this.minus]:[this.minus,this.plus],o[0]&&(r=r.concat(o[0].iterate())),r.push(this.object),o[1]&&(r=r.concat(o[1].iterate())),r}});r.drawer={conservative:function(e,i,r){t.forEach(this.objects,function(e){e.destroy()}),t.forEach(i,function(e){e.draw(r.lighting)})},chart:function(e,i,r){t.forEach(this.todos,function(e){e.draw(r.lighting)})}};var n={scheduler:r.scheduler,drawer:r.drawer,BinarySearchTree:o};return n});//# sourceMappingURL=scheduler.js.map