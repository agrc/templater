//>>built
define("dojox/gfx3d/lighting",["dojo/_base/lang","dojo/_base/Color","dojo/_base/declare","dojox/gfx/_base","./_base"],function(e,t,a,i,o){var r=o.lighting={black:function(){return{r:0,g:0,b:0,a:1}},white:function(){return{r:1,g:1,b:1,a:1}},toStdColor:function(e){return e=i.normalizeColor(e),{r:e.r/255,g:e.g/255,b:e.b/255,a:e.a}},fromStdColor:function(e){return new t([Math.round(255*e.r),Math.round(255*e.g),Math.round(255*e.b),e.a])},scaleColor:function(e,t){return{r:e*t.r,g:e*t.g,b:e*t.b,a:e*t.a}},addColor:function(e,t){return{r:e.r+t.r,g:e.g+t.g,b:e.b+t.b,a:e.a+t.a}},multiplyColor:function(e,t){return{r:e.r*t.r,g:e.g*t.g,b:e.b*t.b,a:e.a*t.a}},saturateColor:function(e){return{r:e.r<0?0:e.r>1?1:e.r,g:e.g<0?0:e.g>1?1:e.g,b:e.b<0?0:e.b>1?1:e.b,a:e.a<0?0:e.a>1?1:e.a}},mixColor:function(e,t,a){return r.addColor(r.scaleColor(a,e),r.scaleColor(1-a,t))},diff2Color:function(e,t){var a=e.r-t.r,i=e.g-t.g,o=e.b-t.b,r=e.a-t.a;return a*a+i*i+o*o+r*r},length2Color:function(e){return e.r*e.r+e.g*e.g+e.b*e.b+e.a*e.a},dot:function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z},scale:function(e,t){return{x:e*t.x,y:e*t.y,z:e*t.z}},add:function(e,t){return{x:e.x+t.x,y:e.y+t.y,z:e.z+t.z}},saturate:function(e){return Math.min(Math.max(e,0),1)},length:function(e){return Math.sqrt(o.lighting.dot(e,e))},normalize:function(e){return r.scale(1/r.length(e),e)},faceforward:function(e,t){var a=o.lighting,i=a.dot(t,e)<0?1:-1;return a.scale(i,e)},reflect:function(e,t){var a=o.lighting;return a.add(e,a.scale(-2*a.dot(e,t),t))},diffuse:function(e,t){for(var a=r.black(),i=0;i<t.length;++i){var o=t[i],n=r.dot(r.normalize(o.direction),e);a=r.addColor(a,r.scaleColor(n,o.color))}return r.saturateColor(a)},specular:function(e,t,a,i){for(var o=r.black(),n=0;n<i.length;++n){var s=i[n],d=r.normalize(r.add(r.normalize(s.direction),t)),l=Math.pow(Math.max(0,r.dot(e,d)),1/a);o=r.addColor(o,r.scaleColor(l,s.color))}return r.saturateColor(o)},phong:function(e,t,a,i){e=r.normalize(e);for(var o=r.black(),n=0;n<i.length;++n){var s=i[n],d=r.reflect(r.scale(-1,r.normalize(t)),e),l=Math.pow(Math.max(0,r.dot(d,r.normalize(s.direction))),a);o=r.addColor(o,r.scaleColor(l,s.color))}return r.saturateColor(o)}};return a("dojox.gfx3d.lighting.Model",null,{constructor:function(e,t,a,i){this.incident=r.normalize(e),this.lights=[];for(var o=0;o<t.length;++o){var n=t[o];this.lights.push({direction:r.normalize(n.direction),color:r.toStdColor(n.color)})}this.ambient=r.toStdColor(a.color?a.color:"white"),this.ambient=r.scaleColor(a.intensity,this.ambient),this.ambient=r.scaleColor(this.ambient.a,this.ambient),this.ambient.a=1,this.specular=r.toStdColor(i?i:"white"),this.specular=r.scaleColor(this.specular.a,this.specular),this.specular.a=1,this.npr_cool={r:0,g:0,b:.4,a:1},this.npr_warm={r:.4,g:.4,b:.2,a:1},this.npr_alpha=.2,this.npr_beta=.6,this.npr_scale=.6},constant:function(e,t,a){a=r.toStdColor(a);var i=a.a,o=r.scaleColor(i,a);return o.a=i,r.fromStdColor(r.saturateColor(o))},matte:function(e,t,a){"string"==typeof t&&(t=r.finish[t]),a=r.toStdColor(a),e=r.faceforward(r.normalize(e),this.incident);var i=r.scaleColor(t.Ka,this.ambient),o=r.saturate(-4*r.dot(e,this.incident)),n=r.scaleColor(o*t.Kd,r.diffuse(e,this.lights)),s=r.scaleColor(a.a,r.multiplyColor(a,r.addColor(i,n)));return s.a=a.a,r.fromStdColor(r.saturateColor(s))},metal:function(e,t,a){"string"==typeof t&&(t=r.finish[t]),a=r.toStdColor(a),e=r.faceforward(r.normalize(e),this.incident);var i,o,n=r.scale(-1,this.incident),s=r.scaleColor(t.Ka,this.ambient),d=r.saturate(-4*r.dot(e,this.incident));return i="phong"in t?r.scaleColor(d*t.Ks*t.phong,r.phong(e,n,t.phong_size,this.lights)):r.scaleColor(d*t.Ks,r.specular(e,n,t.roughness,this.lights)),o=r.scaleColor(a.a,r.addColor(r.multiplyColor(a,s),r.multiplyColor(this.specular,i))),o.a=a.a,r.fromStdColor(r.saturateColor(o))},plastic:function(e,t,a){"string"==typeof t&&(t=r.finish[t]),a=r.toStdColor(a),e=r.faceforward(r.normalize(e),this.incident);var i,o,n=r.scale(-1,this.incident),s=r.scaleColor(t.Ka,this.ambient),d=r.saturate(-4*r.dot(e,this.incident)),l=r.scaleColor(d*t.Kd,r.diffuse(e,this.lights));return i="phong"in t?r.scaleColor(d*t.Ks*t.phong,r.phong(e,n,t.phong_size,this.lights)):r.scaleColor(d*t.Ks,r.specular(e,n,t.roughness,this.lights)),o=r.scaleColor(a.a,r.addColor(r.multiplyColor(a,r.addColor(s,l)),r.multiplyColor(this.specular,i))),o.a=a.a,r.fromStdColor(r.saturateColor(o))},npr:function(e,t,a){"string"==typeof t&&(t=r.finish[t]),a=r.toStdColor(a),e=r.faceforward(r.normalize(e),this.incident);var i=r.scaleColor(t.Ka,this.ambient),o=r.saturate(-4*r.dot(e,this.incident)),n=r.scaleColor(o*t.Kd,r.diffuse(e,this.lights)),s=r.scaleColor(a.a,r.multiplyColor(a,r.addColor(i,n))),d=r.addColor(this.npr_cool,r.scaleColor(this.npr_alpha,s)),l=r.addColor(this.npr_warm,r.scaleColor(this.npr_beta,s)),u=(1+r.dot(this.incident,e))/2,s=r.scaleColor(this.npr_scale,r.addColor(s,r.mixColor(d,l,u)));return s.a=a.a,r.fromStdColor(r.saturateColor(s))}}),o.lighting.finish={defaults:{Ka:.1,Kd:.6,Ks:0,roughness:.05},dull:{Ka:.1,Kd:.6,Ks:.5,roughness:.15},shiny:{Ka:.1,Kd:.6,Ks:1,roughness:.001},glossy:{Ka:.1,Kd:.6,Ks:1,roughness:1e-4},phong_dull:{Ka:.1,Kd:.6,Ks:.5,phong:.5,phong_size:1},phong_shiny:{Ka:.1,Kd:.6,Ks:1,phong:1,phong_size:200},phong_glossy:{Ka:.1,Kd:.6,Ks:1,phong:1,phong_size:300},luminous:{Ka:1,Kd:0,Ks:0,roughness:.05},metalA:{Ka:.35,Kd:.3,Ks:.8,roughness:.05},metalB:{Ka:.3,Kd:.4,Ks:.7,roughness:1/60},metalC:{Ka:.25,Kd:.5,Ks:.8,roughness:1/80},metalD:{Ka:.15,Kd:.6,Ks:.8,roughness:.01},metalE:{Ka:.1,Kd:.7,Ks:.8,roughness:1/120}},r});//# sourceMappingURL=lighting.js.map