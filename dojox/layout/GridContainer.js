//>>built
define("dojox/layout/GridContainer",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/array","dojo/_base/connect","dojo/_base/sniff","dojo/dom-class","dojo/dom-style","dojo/dom-geometry","dojo/dom-construct","dojo/_base/lang","dojo/_base/window","dojo/ready","dojox/layout/GridContainerLite"],function(e,t,i,a,n,r,o,s,d,l,u,h,c){return t("dojox.layout.GridContainer",c,{hasResizableColumns:!0,liveResizeColumns:!1,minColWidth:20,minChildWidth:150,mode:"right",isRightFixed:!1,isLeftFixed:!1,startup:function(){if(this.inherited(arguments),this.hasResizableColumns){for(var e=0;e<this._grid.length-1;e++)this._createGrip(e);this.getParent()||h(l.hitch(this,"_placeGrips"))}},resizeChildAfterDrop:function(e,t,i){this.inherited(arguments)&&this._placeGrips()},onShow:function(){this.inherited(arguments),this._placeGrips()},resize:function(){this.inherited(arguments),this._isShown()&&this.hasResizableColumns&&this._placeGrips()},_createGrip:function(e){var t=this._grid[e],i=d.create("div",{"class":"gridContainerGrip"},this.domNode);t.grip=i,t.gripHandler=[this.connect(i,"onmouseover",function(e){for(var t=!1,i=0;i<this._grid.length-1;i++)if(r.contains(this._grid[i].grip,"gridContainerGripShow")){t=!0;break}t||r.replace(e.target,"gridContainerGripShow","gridContainerGrip")})[0],this.connect(i,"onmouseout",function(e){this._isResized||r.replace(e.target,"gridContainerGrip","gridContainerGripShow")})[0],this.connect(i,"onmousedown","_resizeColumnOn")[0],this.connect(i,"ondblclick","_onGripDbClick")[0]]},_placeGrips:function(){var e,t,a,n=0;i.forEach(this._grid,function(i){i.grip&&(a=i.grip,e||(e=a.offsetWidth/2),n+=s.getMarginBox(i.node).w,o.set(a,"left",n-e+"px"),t||(t=s.getContentBox(this.gridNode).h),t>0&&o.set(a,"height",t+"px"))},this)},_onGripDbClick:function(){this._updateColumnsWidth(this._dragManager),this.resize()},_resizeColumnOn:function(e){this._activeGrip=e.target,this._initX=e.pageX,e.preventDefault(),u.body().style.cursor="ew-resize",this._isResized=!0;var t,r,d=[];for(r=0;r<this._grid.length;r++)d[r]=s.getContentBox(this._grid[r].node).w;for(this._oldTabSize=d,r=0;r<this._grid.length;r++)t=this._grid[r],this._activeGrip==t.grip&&(this._currentColumn=t.node,this._currentColumnWidth=d[r],this._nextColumn=this._grid[r+1].node,this._nextColumnWidth=d[r+1]),t.node.style.width=d[r]+"px";var l=function(e,t){var a=0,r=0;return i.forEach(e,function(e){if(1==e.nodeType){var i=o.getComputedStyle(e),s=n("ie")?t:parseInt(i.minWidth);r=s+parseInt(i.marginLeft)+parseInt(i.marginRight),r>a&&(a=r)}}),a},h=l(this._currentColumn.childNodes,this.minChildWidth),c=l(this._nextColumn.childNodes,this.minChildWidth),m=Math.round(s.getMarginBox(this.gridContainerTable).w*this.minColWidth/100);this._currentMinCol=h,this._nextMinCol=c,m>this._currentMinCol&&(this._currentMinCol=m),m>this._nextMinCol&&(this._nextMinCol=m),this._connectResizeColumnMove=a.connect(u.doc,"onmousemove",this,"_resizeColumnMove"),this._connectOnGripMouseUp=a.connect(u.doc,"onmouseup",this,"_onGripMouseUp")},_onGripMouseUp:function(){u.body().style.cursor="default",a.disconnect(this._connectResizeColumnMove),a.disconnect(this._connectOnGripMouseUp),this._connectOnGripMouseUp=this._connectResizeColumnMove=null,this._activeGrip&&r.replace(this._activeGrip,"gridContainerGrip","gridContainerGripShow"),this._isResized=!1},_resizeColumnMove:function(e){e.preventDefault(),this._connectResizeColumnOff||(a.disconnect(this._connectOnGripMouseUp),this._connectOnGripMouseUp=null,this._connectResizeColumnOff=a.connect(u.doc,"onmouseup",this,"_resizeColumnOff"));var t=e.pageX-this._initX;0!=t&&(this._currentColumnWidth+t<this._currentMinCol||this._nextColumnWidth-t<this._nextMinCol||(this._currentColumnWidth+=t,this._nextColumnWidth-=t,this._initX=e.pageX,this._activeGrip.style.left=parseInt(this._activeGrip.style.left)+t+"px",this.liveResizeColumns&&(this._currentColumn.style.width=this._currentColumnWidth+"px",this._nextColumn.style.width=this._nextColumnWidth+"px",this.resize())))},_resizeColumnOff:function(e){u.body().style.cursor="default",a.disconnect(this._connectResizeColumnMove),a.disconnect(this._connectResizeColumnOff),this._connectResizeColumnOff=this._connectResizeColumnMove=null,this.liveResizeColumns||(this._currentColumn.style.width=this._currentColumnWidth+"px",this._nextColumn.style.width=this._nextColumnWidth+"px");var t,i,o=[],d=[],l=this.gridContainerTable.clientWidth,h=!1;for(i=0;i<this._grid.length;i++)t=this._grid[i].node,n("ie")?(o[i]=s.getMarginBox(t).w,d[i]=s.getContentBox(t).w):(o[i]=s.getContentBox(t).w,d=o);for(i=0;i<d.length;i++)if(d[i]!=this._oldTabSize[i]){h=!0;break}if(h){var c=n("ie")?100:1e4;for(i=0;i<this._grid.length;i++)this._grid[i].node.style.width=Math.round(100*c*o[i]/l)/c+"%";this.resize()}this._activeGrip&&r.replace(this._activeGrip,"gridContainerGrip","gridContainerGripShow"),this._isResized=!1},setColumns:function(e){var t,i;if(e>0){var n=this._grid.length,r=n-e;if(r>0){var o,s,d,l,u=[];if("right"==this.mode){for(d=this.isLeftFixed&&n>0?1:0,s=this.isRightFixed?n-2:n-1,t=s;t>=d;t--){for(l=0,o=this._grid[t].node,i=0;i<o.childNodes.length;i++)if(1==o.childNodes[i].nodeType&&""!=o.childNodes[i].id){l++;break}if(0==l&&(u[u.length]=t),u.length>=r){this._deleteColumn(u);break}}u.length<r&&a.publish("/dojox/layout/gridContainer/noEmptyColumn",[this])}else{for(s=this.isLeftFixed&&n>0?1:0,d=this.isRightFixed?n-1:n,t=s;d>t;t++){for(l=0,o=this._grid[t].node,i=0;i<o.childNodes.length;i++)if(1==o.childNodes[i].nodeType&&""!=o.childNodes[i].id){l++;break}if(0==l&&(u[u.length]=t),u.length>=r){this._deleteColumn(u);break}}u.length<r&&a.publish("/dojox/layout/gridContainer/noEmptyColumn",[this])}}else 0>r&&this._addColumn(Math.abs(r));this.hasResizableColumns&&this._placeGrips()}},_addColumn:function(e){var t,i,a,n=this._grid,r="right"==this.mode,o=this.acceptTypes.join(","),s=this._dragManager;this.hasResizableColumns&&(!this.isRightFixed&&r||this.isLeftFixed&&!r&&1==this.nbZones)&&this._createGrip(n.length-1);for(var l=0;e>l;l++)t=d.create("td",{"class":"gridContainerZone dojoxDndArea",accept:o,id:this.id+"_dz"+this.nbZones}),a=n.length,r?this.isRightFixed?(i=a-1,n.splice(i,0,{node:n[i].node.parentNode.insertBefore(t,n[i].node)})):(i=a,n.push({node:this.gridNode.appendChild(t)})):this.isLeftFixed?(i=1==a?0:1,this._grid.splice(1,0,{node:this._grid[i].node.parentNode.appendChild(t,this._grid[i].node)}),i=1):(i=a-this.nbZones,this._grid.splice(i,0,{node:n[i].node.parentNode.insertBefore(t,n[i].node)})),this.hasResizableColumns&&(!r&&1!=this.nbZones||!r&&1==this.nbZones&&!this.isLeftFixed||r&&e-1>l||r&&l==e-1&&this.isRightFixed)&&this._createGrip(i),s.registerByNode(n[i].node),this.nbZones++;this._updateColumnsWidth(s)},_deleteColumn:function(e){for(var t,n,r=0,o=e.length,s=this._dragManager,l=0;o>l;l++)n="right"==this.mode?e[l]:e[l]-r,t=this._grid[n],this.hasResizableColumns&&t.grip&&(i.forEach(t.gripHandler,function(e){a.disconnect(e)}),d.destroy(this.domNode.removeChild(t.grip)),t.grip=null),s.unregister(t.node),d.destroy(this.gridNode.removeChild(t.node)),this._grid.splice(n,1),this.nbZones--,r++;var u=this._grid[this.nbZones-1];u.grip&&(i.forEach(u.gripHandler,a.disconnect),d.destroy(this.domNode.removeChild(u.grip)),u.grip=null),this._updateColumnsWidth(s)},_updateColumnsWidth:function(e){this.inherited(arguments),null===e&&(e=this._dragManager),e._dropMode.updateAreas(e._areaList)},destroy:function(){a.unsubscribe(this._dropHandler),this.inherited(arguments)}})});//# sourceMappingURL=GridContainer.js.map