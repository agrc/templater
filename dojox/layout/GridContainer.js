//>>built
define("dojox/layout/GridContainer",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/array","dojo/_base/connect","dojo/_base/sniff","dojo/dom-class","dojo/dom-style","dojo/dom-geometry","dojo/dom-construct","dojo/_base/lang","dojo/_base/window","dojo/ready","dojox/layout/GridContainerLite"],function(e,t,i,a,r,o,n,s,l,d,h,u,c){return t("dojox.layout.GridContainer",c,{hasResizableColumns:!0,liveResizeColumns:!1,minColWidth:20,minChildWidth:150,mode:"right",isRightFixed:!1,isLeftFixed:!1,startup:function(){if(this.inherited(arguments),this.hasResizableColumns){for(var e=0;e<this._grid.length-1;e++)this._createGrip(e);this.getParent()||u(d.hitch(this,"_placeGrips"))}},resizeChildAfterDrop:function(e,t,i){this.inherited(arguments)&&this._placeGrips()},onShow:function(){this.inherited(arguments),this._placeGrips()},resize:function(){this.inherited(arguments),this._isShown()&&this.hasResizableColumns&&this._placeGrips()},_createGrip:function(e){var t=this._grid[e],i=l.create("div",{"class":"gridContainerGrip"},this.domNode);t.grip=i,t.gripHandler=[this.connect(i,"onmouseover",function(e){for(var t=!1,i=0;i<this._grid.length-1;i++)if(o.contains(this._grid[i].grip,"gridContainerGripShow")){t=!0;break}t||o.replace(e.target,"gridContainerGripShow","gridContainerGrip")})[0],this.connect(i,"onmouseout",function(e){this._isResized||o.replace(e.target,"gridContainerGrip","gridContainerGripShow")})[0],this.connect(i,"onmousedown","_resizeColumnOn")[0],this.connect(i,"ondblclick","_onGripDbClick")[0]]},_placeGrips:function(){var e,t,a,r=0;i.forEach(this._grid,function(i){i.grip&&(a=i.grip,e||(e=a.offsetWidth/2),r+=s.getMarginBox(i.node).w,n.set(a,"left",r-e+"px"),t||(t=s.getContentBox(this.gridNode).h),t>0&&n.set(a,"height",t+"px"))},this)},_onGripDbClick:function(){this._updateColumnsWidth(this._dragManager),this.resize()},_resizeColumnOn:function(e){this._activeGrip=e.target,this._initX=e.pageX,e.preventDefault(),h.body().style.cursor="ew-resize",this._isResized=!0;var t,o,l=[];for(o=0;o<this._grid.length;o++)l[o]=s.getContentBox(this._grid[o].node).w;for(this._oldTabSize=l,o=0;o<this._grid.length;o++)t=this._grid[o],this._activeGrip==t.grip&&(this._currentColumn=t.node,this._currentColumnWidth=l[o],this._nextColumn=this._grid[o+1].node,this._nextColumnWidth=l[o+1]),t.node.style.width=l[o]+"px";var d=function(e,t){var a=0,o=0;return i.forEach(e,function(e){if(1==e.nodeType){var i=n.getComputedStyle(e),s=r("ie")?t:parseInt(i.minWidth);o=s+parseInt(i.marginLeft)+parseInt(i.marginRight),o>a&&(a=o)}}),a},u=d(this._currentColumn.childNodes,this.minChildWidth),c=d(this._nextColumn.childNodes,this.minChildWidth),m=Math.round(s.getMarginBox(this.gridContainerTable).w*this.minColWidth/100);this._currentMinCol=u,this._nextMinCol=c,m>this._currentMinCol&&(this._currentMinCol=m),m>this._nextMinCol&&(this._nextMinCol=m),this._connectResizeColumnMove=a.connect(h.doc,"onmousemove",this,"_resizeColumnMove"),this._connectOnGripMouseUp=a.connect(h.doc,"onmouseup",this,"_onGripMouseUp")},_onGripMouseUp:function(){h.body().style.cursor="default",a.disconnect(this._connectResizeColumnMove),a.disconnect(this._connectOnGripMouseUp),this._connectOnGripMouseUp=this._connectResizeColumnMove=null,this._activeGrip&&o.replace(this._activeGrip,"gridContainerGrip","gridContainerGripShow"),this._isResized=!1},_resizeColumnMove:function(e){e.preventDefault(),this._connectResizeColumnOff||(a.disconnect(this._connectOnGripMouseUp),this._connectOnGripMouseUp=null,this._connectResizeColumnOff=a.connect(h.doc,"onmouseup",this,"_resizeColumnOff"));var t=e.pageX-this._initX;0!=t&&(this._currentColumnWidth+t<this._currentMinCol||this._nextColumnWidth-t<this._nextMinCol||(this._currentColumnWidth+=t,this._nextColumnWidth-=t,this._initX=e.pageX,this._activeGrip.style.left=parseInt(this._activeGrip.style.left)+t+"px",this.liveResizeColumns&&(this._currentColumn.style.width=this._currentColumnWidth+"px",this._nextColumn.style.width=this._nextColumnWidth+"px",this.resize())))},_resizeColumnOff:function(e){h.body().style.cursor="default",a.disconnect(this._connectResizeColumnMove),a.disconnect(this._connectResizeColumnOff),this._connectResizeColumnOff=this._connectResizeColumnMove=null,this.liveResizeColumns||(this._currentColumn.style.width=this._currentColumnWidth+"px",this._nextColumn.style.width=this._nextColumnWidth+"px");var t,i,n=[],l=[],d=this.gridContainerTable.clientWidth,u=!1;for(i=0;i<this._grid.length;i++)t=this._grid[i].node,r("ie")?(n[i]=s.getMarginBox(t).w,l[i]=s.getContentBox(t).w):(n[i]=s.getContentBox(t).w,l=n);for(i=0;i<l.length;i++)if(l[i]!=this._oldTabSize[i]){u=!0;break}if(u){var c=r("ie")?100:1e4;for(i=0;i<this._grid.length;i++)this._grid[i].node.style.width=Math.round(100*c*n[i]/d)/c+"%";this.resize()}this._activeGrip&&o.replace(this._activeGrip,"gridContainerGrip","gridContainerGripShow"),this._isResized=!1},setColumns:function(e){var t,i;if(e>0){var r=this._grid.length,o=r-e;if(o>0){var n,s,l,d,h=[];if("right"==this.mode){for(l=this.isLeftFixed&&r>0?1:0,s=this.isRightFixed?r-2:r-1,t=s;t>=l;t--){for(d=0,n=this._grid[t].node,i=0;i<n.childNodes.length;i++)if(1==n.childNodes[i].nodeType&&""!=n.childNodes[i].id){d++;break}if(0==d&&(h[h.length]=t),h.length>=o){this._deleteColumn(h);break}}h.length<o&&a.publish("/dojox/layout/gridContainer/noEmptyColumn",[this])}else{for(s=this.isLeftFixed&&r>0?1:0,l=this.isRightFixed?r-1:r,t=s;l>t;t++){for(d=0,n=this._grid[t].node,i=0;i<n.childNodes.length;i++)if(1==n.childNodes[i].nodeType&&""!=n.childNodes[i].id){d++;break}if(0==d&&(h[h.length]=t),h.length>=o){this._deleteColumn(h);break}}h.length<o&&a.publish("/dojox/layout/gridContainer/noEmptyColumn",[this])}}else 0>o&&this._addColumn(Math.abs(o));this.hasResizableColumns&&this._placeGrips()}},_addColumn:function(e){var t,i,a,r=this._grid,o="right"==this.mode,n=this.acceptTypes.join(","),s=this._dragManager;this.hasResizableColumns&&(!this.isRightFixed&&o||this.isLeftFixed&&!o&&1==this.nbZones)&&this._createGrip(r.length-1);for(var d=0;e>d;d++)t=l.create("td",{"class":"gridContainerZone dojoxDndArea",accept:n,id:this.id+"_dz"+this.nbZones}),a=r.length,o?this.isRightFixed?(i=a-1,r.splice(i,0,{node:r[i].node.parentNode.insertBefore(t,r[i].node)})):(i=a,r.push({node:this.gridNode.appendChild(t)})):this.isLeftFixed?(i=1==a?0:1,this._grid.splice(1,0,{node:this._grid[i].node.parentNode.appendChild(t,this._grid[i].node)}),i=1):(i=a-this.nbZones,this._grid.splice(i,0,{node:r[i].node.parentNode.insertBefore(t,r[i].node)})),this.hasResizableColumns&&(!o&&1!=this.nbZones||!o&&1==this.nbZones&&!this.isLeftFixed||o&&e-1>d||o&&d==e-1&&this.isRightFixed)&&this._createGrip(i),s.registerByNode(r[i].node),this.nbZones++;this._updateColumnsWidth(s)},_deleteColumn:function(e){for(var t,r,o=0,n=e.length,s=this._dragManager,d=0;n>d;d++)r="right"==this.mode?e[d]:e[d]-o,t=this._grid[r],this.hasResizableColumns&&t.grip&&(i.forEach(t.gripHandler,function(e){a.disconnect(e)}),l.destroy(this.domNode.removeChild(t.grip)),t.grip=null),s.unregister(t.node),l.destroy(this.gridNode.removeChild(t.node)),this._grid.splice(r,1),this.nbZones--,o++;var h=this._grid[this.nbZones-1];h.grip&&(i.forEach(h.gripHandler,a.disconnect),l.destroy(this.domNode.removeChild(h.grip)),h.grip=null),this._updateColumnsWidth(s)},_updateColumnsWidth:function(e){this.inherited(arguments),null===e&&(e=this._dragManager),e._dropMode.updateAreas(e._areaList)},destroy:function(){a.unsubscribe(this._dropHandler),this.inherited(arguments)}})});//# sourceMappingURL=GridContainer.js.map