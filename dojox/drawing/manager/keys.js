//>>built
define("dojox/drawing/manager/keys",["dojo","../util/common"],function(e,t){var i=!1,a=!0,r="abcdefghijklmnopqrstuvwxyz",n={arrowIncrement:1,arrowShiftIncrement:10,shift:!1,ctrl:!1,alt:!1,cmmd:!1,meta:!1,onDelete:function(e){},onEsc:function(e){},onEnter:function(e){},onArrow:function(e){},onKeyDown:function(e){},onKeyUp:function(e){},listeners:[],register:function(e){var i=t.uid("listener");this.listeners.push({handle:i,scope:e.scope||window,callback:e.callback,keyCode:e.keyCode})},_getLetter:function(e){return!e.meta&&e.keyCode>=65&&e.keyCode<=90?r.charAt(e.keyCode-65):null},_mixin:function(e){return e.meta=this.meta,e.shift=this.shift,e.alt=this.alt,e.cmmd=this.cmmd,e.ctrl=this.ctrl,e.letter=this._getLetter(e),e},editMode:function(e){i=e},enable:function(e){a=e},scanForFields:function(){this._fieldCons&&e.forEach(this._fieldCons,e.disconnect,e),this._fieldCons=[],e.query("input").forEach(function(t){var i=e.connect(t,"focus",this,function(e){this.enable(!1)}),a=e.connect(t,"blur",this,function(e){this.enable(!0)});this._fieldCons.push(i),this._fieldCons.push(a)},this)},init:function(){setTimeout(e.hitch(this,"scanForFields"),500),e.connect(document,"blur",this,function(e){this.meta=this.shift=this.ctrl=this.cmmd=this.alt=!1}),e.connect(document,"keydown",this,function(t){a&&(16==t.keyCode&&(this.shift=!0),17==t.keyCode&&(this.ctrl=!0),18==t.keyCode&&(this.alt=!0),224==t.keyCode&&(this.cmmd=!0),this.meta=this.shift||this.ctrl||this.cmmd||this.alt,i||(this.onKeyDown(this._mixin(t)),8!=t.keyCode&&46!=t.keyCode||e.stopEvent(t)))}),e.connect(document,"keyup",this,function(t){if(a){var r=!1;16==t.keyCode&&(this.shift=!1),17==t.keyCode&&(this.ctrl=!1),18==t.keyCode&&(this.alt=!1),224==t.keyCode&&(this.cmmd=!1),this.meta=this.shift||this.ctrl||this.cmmd||this.alt,!i&&this.onKeyUp(this._mixin(t)),13==t.keyCode&&(this.onEnter(t),r=!0),27==t.keyCode&&(this.onEsc(t),r=!0),8!=t.keyCode&&46!=t.keyCode||(this.onDelete(t),r=!0),r&&!i&&e.stopEvent(t)}}),e.connect(document,"keypress",this,function(t){if(a){var r=this.shift?this.arrowIncrement*this.arrowShiftIncrement:this.arrowIncrement,n=t.alt||this.cmmd,o=0,d=0;32!=t.keyCode||i||e.stopEvent(t),37!=t.keyCode||n||(o=-r),38!=t.keyCode||n||(d=-r),39!=t.keyCode||n||(o=r),40!=t.keyCode||n||(d=r),(o||d)&&(t.x=o,t.y=d,t.shift=this.shift,i||(this.onArrow(t),e.stopEvent(t)))}})}};return e.addOnLoad(n,"init"),n});//# sourceMappingURL=keys.js.map