//>>built
define("dojox/drawing/plugins/drawing/Silverlight",["dojo","dijit","dojox"],function(e,t,a){e.provide("dojox.drawing.plugins.drawing.Silverlight"),a.drawing.plugins.drawing.Silverlight=a.drawing.util.oo.declare(function(t){"silverlight"==a.gfx.renderer&&(this.mouse=t.mouse,this.stencils=t.stencils,this.anchors=t.anchors,this.canvas=t.canvas,this.util=t.util,e.connect(this.stencils,"register",this,function(t){var a,i,r,o,n,d=this,s=function(){a=t.container.connect("onmousedown",function(e){e.superTarget=t,d.mouse.down(e)})};s(),i=e.connect(t,"setTransform",this,function(){}),r=e.connect(t,"onBeforeRender",function(){}),o=e.connect(t,"onRender",this,function(){}),n=e.connect(t,"destroy",this,function(){e.forEach([a,i,r,o,n],e.disconnect,e)})}),e.connect(this.anchors,"onAddAnchor",this,function(t){var a=t.shape.connect("onmousedown",this.mouse,function(e){e.superTarget=t,this.down(e)}),i=e.connect(t,"disconnectMouse",this,function(){e.disconnect(a),e.disconnect(i)})}),this.mouse._down=function(e){var t=this._getXY(e),a=t.x-this.origin.x,i=t.y-this.origin.y;a*=this.zoom,i*=this.zoom,this.origin.startx=a,this.origin.starty=i,this._lastx=a,this._lasty=i,this.drawingType=this.util.attr(e,"drawingType")||"";var r=this._getId(e),o={x:a,y:i,id:r};if(this.onDown(o),this._clickTime=(new Date).getTime(),this._lastClickTime&&this._clickTime-this._lastClickTime<this.doublClickSpeed){var n=this.eventName("doubleClick");this._broadcastEvent(n,o)}this._lastClickTime=this._clickTime},this.mouse.down=function(t){return clearTimeout(this.__downInv),"surface"==this.util.attr(t,"drawingType")?void(this.__downInv=setTimeout(e.hitch(this,function(){this._down(t)}),500)):void this._down(t)},this.mouse._getXY=function(e){if(e.pageX)return{x:e.pageX,y:e.pageY,cancelBubble:!0};for(var t in e);return void 0!==e.x?{x:e.x+this.origin.x,y:e.y+this.origin.y}:{x:e.pageX,y:e.pageY}},this.mouse._getId=function(e){return this.util.attr(e,"id")},this.util.attr=function(t,a,i,r){if(!t)return!1;try{var o;if(o=t.superTarget?t.superTarget:t.superClass?t.superClass:t.target?t.target:t,void 0!==i)return t[a]=i,i;if(o.tagName){if("drawingType"==a&&"object"==o.tagName.toLowerCase())return"surface";var n=e.attr(o,a)}var n=o[a];return n}catch(d){return!1}})},{})});//# sourceMappingURL=Silverlight.js.map