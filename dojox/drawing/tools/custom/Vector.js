//>>built
define("dojox/drawing/tools/custom/Vector",["dojo","../../util/oo","../../manager/_registry","../../util/positioning","../Arrow"],function(e,t,i,a,r){var o=t.declare(r,function(e){this.minimumSize=this.style.arrows.length,this.addShadow({size:3,mult:2})},{draws:!0,type:"dojox.drawing.tools.custom.Vector",minimumSize:30,showAngle:!0,changeAxis:function(e){if(e=void 0!==e?e:this.style.zAxis?0:1,0==e)this.style.zAxis=!1,this.data.cosphi=0;else{this.style.zAxis=!0;var t=this.points,i=this.zPoint();this.setPoints([{x:t[0].x,y:t[0].y},{x:i.x,y:i.y}])}this.render()},_createZeroVector:function(e,t,i){var a="hit"==e?this.minimumSize:this.minimumSize/6,r="hit"==e?i.fill:null;t={cx:this.data.x1,cy:this.data.y1,rx:a,ry:a},this.remove(this[e]),this[e]=this.container.createEllipse(t).setStroke(i).setFill(r),this.util.attr(this[e],"drawingType","stencil")},_create:function(e,t,i){this.remove(this[e]),this[e]=this.container.createLine(t).setStroke(i),this._setNodeAtts(this[e])},onDrag:function(e){if(!this.created){var t=e.start.x,i=e.start.y,a=e.x,r=e.y;if(this.keys.shift&&!this.style.zAxis){var o=this.util.snapAngle(e,.25);a=o.x,r=o.y}if(this.keys.alt){var n=a>t?(a-t)/2:(t-a)/-2,s=r>i?(r-i)/2:(i-r)/-2;t-=n,a-=n,i-=s,r-=s}if(this.style.zAxis){var d=this.zPoint(e);a=d.x,r=d.y}this.setPoints([{x:t,y:i},{x:a,y:r}]),this.render()}},onTransform:function(e){this._isBeingModified||this.onTransformBegin(),this.setPoints(this.points),this.render()},anchorConstrain:function(e,t){if(!this.style.zAxis)return null;var i=this.style.zAngle*Math.PI/180,a=0>e?e>-t:-t>e,r=a?e:-t/Math.tan(i),o=a?-Math.tan(i)*e:t;return{x:r,y:o}},zPoint:function(e){if(void 0===e){if(!this.points[0])return null;var t=this.pointsToData();e={start:{x:t.x1,y:t.y1},x:t.x2,y:t.y2}}var i=this.util.length(e),r=a.angle(e.start,e);return 0>r?r=360+r:r,r=r>135&&315>r?this.style.zAngle:this.util.oppAngle(this.style.zAngle),this.util.pointOnCircle(e.start.x,e.start.y,i,r)},pointsToData:function(e){e=e||this.points;var t=0,i={start:{x:e[0].x,y:e[0].y},x:e[1].x,y:e[1].y};if(this.style.zAxis&&this.util.length(i)>this.minimumSize){var r=a.angle(i.start,i);0>r?r=360+r:r,t=r>135&&315>r?1:-1}return this.data={x1:e[0].x,y1:e[0].y,x2:e[1].x,y2:e[1].y,cosphi:t},this.data},dataToPoints:function(e){if(e=e||this.data,e.radius||e.angle){var t=0,i=this.util.pointOnCircle(e.x,e.y,e.radius,e.angle);(this.style.zAxis||e.cosphi&&0!=e.cosphi)&&(this.style.zAxis=!0,t=e.angle>135&&e.angle<315?1:-1),this.data=e={x1:e.x,y1:e.y,x2:i.x,y2:i.y,cosphi:t}}return this.points=[{x:e.x1,y:e.y1},{x:e.x2,y:e.y2}],this.points},render:function(){this.onBeforeRender(this),this.getRadius()>=this.minimumSize?(this._create("hit",this.data,this.style.currentHit),this._create("shape",this.data,this.style.current)):(this.data.cosphi=0,this._createZeroVector("hit",this.data,this.style.currentHit),this._createZeroVector("shape",this.data,this.style.current))},onUp:function(e){if(!this.created&&this._downOnCanvas){if(this._downOnCanvas=!1,!this.shape){var t=100;e.start.x=this.style.zAxis?e.start.x+t:e.start.x,e.y=e.y+t,this.setPoints([{x:e.start.x,y:e.start.y},{x:e.x,y:e.y}]),this.render()}if(this.getRadius()<this.minimumSize){var i=this.points;this.setPoints([{x:i[0].x,y:i[0].y},{x:i[0].x,y:i[0].y}])}else{var i=this.points,a=this.style.zAxis?this.zPoint(e):this.util.snapAngle(e,this.angleSnap/180);this.setPoints([{x:i[0].x,y:i[0].y},{x:a.x,y:a.y}])}this.renderedOnce=!0,this.onRender(this)}}});return e.setObject("dojox.drawing.tools.custom.Vector",o),o.setup={name:"dojox.drawing.tools.custom.Vector",tooltip:"Vector Tool",iconClass:"iconVector"},i.register(o.setup,"tool"),o});//# sourceMappingURL=Vector.js.map