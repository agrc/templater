//>>built
define("dojox/gauges/AnalogIndicatorBase",["dojo/_base/lang","dojo/_base/declare","dojo/_base/connect","dojo/_base/fx","dojox/gfx","./_Indicator"],function(e,t,a,i,n,r){return t("dojox.gauges.AnalogIndicatorBase",[r],{draw:function(e,t){if(this.shape)this._move(t);else{this.text&&(this.text.parent.remove(this.text),this.text=null);var a=this._gauge._getAngle(Math.min(Math.max(this.value,this._gauge.min),this._gauge.max));this.color=this.color||"#000000",this.length=this.length||this._gauge.radius,this.width=this.width||1,this.offset=this.offset||0,this.highlight=this.highlight||"#D0D0D0";var i=this._getShapes(e,this._gauge,this);if(i){if(i.length>1){this.shape=e.createGroup();for(var r=0;r<i.length;r++)this.shape.add(i[r])}else this.shape=i[0];this.shape.setTransform([{dx:this._gauge.cx,dy:this._gauge.cy},n.matrix.rotateg(a)]),this.shape.connect("onmouseover",this,this.handleMouseOver),this.shape.connect("onmouseout",this,this.handleMouseOut),this.shape.connect("onmousedown",this,this.handleMouseDown),this.shape.connect("touchstart",this,this.handleTouchStart)}if(this.label){var o=this.direction;o||(o="outside");var s;s="inside"==o?-this.length+this.offset-5:this.length+this.offset+5;var l=this._gauge._getRadians(90-a);this._layoutLabel(e,this.label+"",this._gauge.cx,this._gauge.cy,s,l,o)}this.currentValue=this.value}},_layoutLabel:function(e,t,a,i,r,o,s){var l,d=this.font?this.font:n.defaultFont,u=n._base._getTextBox(t,{font:n.makeFontString(n.makeParameters(n.defaultFont,d))}),c=u.w,m=d.size,h=n.normalizedLength(m),f=a+Math.cos(o)*r-c/2,p=i-Math.sin(o)*r-h/2,g=[];l=f;var v=l,y=-Math.tan(o)*l+i+Math.tan(o)*a;y>=p&&p+h>=y&&g.push({x:v,y:y}),l=f+c,v=l,y=-Math.tan(o)*l+i+Math.tan(o)*a,y>=p&&p+h>=y&&g.push({x:v,y:y}),l=p,v=-1/Math.tan(o)*l+a+1/Math.tan(o)*i,y=l,v>=f&&f+c>=v&&g.push({x:v,y:y}),l=p+h,v=-1/Math.tan(o)*l+a+1/Math.tan(o)*i,y=l,v>=f&&f+c>=v&&g.push({x:v,y:y});var b;if("inside"==s)for(var k=0;k<g.length;k++){var M=g[k];if(b=this._distance(M.x,M.y,a,i)-r,b>=0){f=a+Math.cos(o)*(r-b)-c/2,p=i-Math.sin(o)*(r-b)-h/2;break}}else for(k=0;k<g.length;k++)if(M=g[k],b=this._distance(M.x,M.y,a,i)-r,0>=b){f=a+Math.cos(o)*(r-b)-c/2,p=i-Math.sin(o)*(r-b)-h/2;break}this.text=this._gauge.drawText(e,t,f+c/2,p+h,"middle",this.color,this.font)},_distance:function(e,t,a,i){return Math.sqrt((a-e)*(a-e)+(i-t)*(i-t))},_move:function(t){var r=Math.min(Math.max(this.value,this._gauge.min),this._gauge.max),o=this.currentValue;if(t){var s=this._gauge._getAngle(r);this.shape.setTransform([{dx:this._gauge.cx,dy:this._gauge.cy},n.matrix.rotateg(s)]),this.currentValue=r}else if(o!=r){var l=new i.Animation({curve:[o,r],duration:this.duration,easing:this.easing});a.connect(l,"onAnimate",e.hitch(this,function(e){this.shape.setTransform([{dx:this._gauge.cx,dy:this._gauge.cy},n.matrix.rotateg(this._gauge._getAngle(e))]),this.currentValue=e})),l.play()}}})});//# sourceMappingURL=AnalogIndicatorBase.js.map