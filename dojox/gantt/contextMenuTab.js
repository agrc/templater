//>>built
define("dojox/gantt/contextMenuTab",["./GanttTaskControl","dijit/Menu","dijit/Dialog","dijit/form/NumberSpinner","dijit/form/Button","dijit/form/CheckBox","dijit/form/DateTextBox","dijit/form/TimeTextBox","dijit/form/TextBox","dijit/form/Form","dijit/registry","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/_base/html","dojo/date/locale","dojo/request","dojo/dom","dojo/dom-class","dojo/domReady!"],function(e,t,a,i,r,o,n,d,s,l,m,u,c,h,f,y,v,p,g){return u("dojox.gantt.contextMenuTab",[],{constructor:function(e,t,a,i,r,o){this.id=e,this.arrItems=[],this.TabItemContainer=null,this.Description=t,this.tabMenu=r,this.type=a,this.object=null,this.showObjectInfo=i,this.withDefaultValue=o},preValueValidation:function(e){for(var t=0;t<e.length;t++){var a=e[t];if(a.required&&!a.control.textbox.value)return!1}return!0},encodeDate:function(e){return e.getFullYear()+"."+(e.getMonth()+1)+"."+e.getDate()},decodeDate:function(e){var t=e.split(".");return t.length<3?"":new Date(t[0],parseInt(t[1])-1,t[2])},renameTaskAction:function(){var e=this.arrItems[0].control.textbox.value;h.trim(e).length<=0||this.preValueValidation(this.arrItems)&&(this.object.setName(e),this.hide())},deleteAction:function(){this.preValueValidation(this.arrItems)&&(this.object.project.deleteTask(this.object.taskItem.id),this.hide(),this.tabMenu.ganttChart.resource&&this.tabMenu.ganttChart.resource.reConstruct())},durationUpdateAction:function(){var e=this.arrItems[0].control.textbox.value;if(this.preValueValidation(this.arrItems)){if(!this.object.setDuration(e))return void alert("Duration out of Range");this.hide(),this.tabMenu.ganttChart.resource&&this.tabMenu.ganttChart.resource.refresh()}},cpUpdateAction:function(){var e=this.arrItems[0].control.textbox.value;this.preValueValidation(this.arrItems)&&(this.object.setPercentCompleted(e)?this.hide():alert("Complete Percentage out of Range"))},ownerUpdateAction:function(){var e=this.arrItems[0].control.textbox.value;if(this.preValueValidation(this.arrItems)){if(!this.object.setTaskOwner(e))return void alert("Task owner not Valid");this.hide(),this.tabMenu.ganttChart.resource&&this.tabMenu.ganttChart.resource.reConstruct()}},ptUpdateAction:function(){var e=this.arrItems[0].control.textbox.value;this.preValueValidation(this.arrItems)&&(this.object.setPreviousTask(e)?this.hide():alert("Please verify the Previous Task ("+e+")  and adjust its Time Range"))},renameProjectAction:function(){var e=this.arrItems[0].control.textbox.value;h.trim(e).length<=0||this.preValueValidation(this.arrItems)&&(this.object.setName(e),this.hide())},deleteProjectAction:function(){this.preValueValidation(this.arrItems)&&(this.object.ganttChart.deleteProject(this.object.project.id),this.hide(),this.tabMenu.ganttChart.resource&&this.tabMenu.ganttChart.resource.reConstruct())},cpProjectAction:function(){var e=this.arrItems[0].control.textbox.value;this.preValueValidation(this.arrItems)&&(this.object.setPercentCompleted(e)?this.hide():alert("Percentage not Acceptable"))},addTaskAction:function(){if(this.preValueValidation(this.arrItems)){var e=this.arrItems[0].control.textbox.value,t=this.arrItems[1].control.textbox.value,a=this.decodeDate(this.arrItems[2].control.textbox.value),i=this.arrItems[3].control.textbox.value,r=this.arrItems[4].control.textbox.value,o=this.arrItems[5].control.textbox.value,n=this.arrItems[6].control.textbox.value,d=this.arrItems[7].control.textbox.value;if(!(h.trim(e).length<=0)){if(!this.object.insertTask(e,t,a,i,r,d,o,n))return void alert("Please adjust your Customization");this.hide(),this.tabMenu.ganttChart.resource&&this.tabMenu.ganttChart.resource.reConstruct()}}},addSuccessorTaskAction:function(){if(this.preValueValidation(this.arrItems)){var e=this.object.project,t=this.arrItems[0].control.textbox.value,a=this.arrItems[1].control.textbox.value,i=this.decodeDate(this.arrItems[2].control.textbox.value),r=this.arrItems[3].control.textbox.value,o=this.arrItems[4].control.textbox.value,n=this.arrItems[5].control.textbox.value;if(!(h.trim(t).length<=0)){var d=this.object.parentTask?this.object.parentTask.taskItem.id:"",s=this.object.taskItem.id;if(!e.insertTask(t,a,i,r,o,s,n,d))return void alert("Please adjust your Customization");this.hide(),this.tabMenu.ganttChart.resource&&this.tabMenu.ganttChart.resource.reConstruct()}}},addChildTaskAction:function(){if(this.preValueValidation(this.arrItems)){var e=this.object.project,t=this.arrItems[0].control.textbox.value,a=this.arrItems[1].control.textbox.value,i=this.decodeDate(this.arrItems[2].control.textbox.value),r=this.arrItems[3].control.textbox.value,o=this.arrItems[4].control.textbox.value,n=this.arrItems[5].control.textbox.value,d=this.object.taskItem.id;if(!(h.trim(t).length<=0)){if(!e.insertTask(t,a,i,r,o,"",n,d))return void alert("Please adjust your Customization");this.hide(),this.tabMenu.ganttChart.resource&&this.tabMenu.ganttChart.resource.reConstruct()}}},addProjectAction:function(){if(this.preValueValidation(this.arrItems)){var e=this.arrItems[0].control.textbox.value,t=this.arrItems[1].control.textbox.value,a=this.decodeDate(this.arrItems[2].control.textbox.value);if(!(h.trim(e).length<=0||h.trim(t).length<=0)){if(!this.tabMenu.ganttChart.insertProject(e,t,a))return void alert("Please adjust your Customization");this.hide(),this.tabMenu.ganttChart.resource&&this.tabMenu.ganttChart.resource.reConstruct()}}},addAction:function(e){this.actionFunc=this[e]},addItem:function(e,t,a,r){var o;o="startTime"==a||"startDate"==a?new n({type:"text",constraints:{datePattern:"yyyy.M.d",strict:!0}}):"percentage"==a?new i({constraints:{max:100,min:0}}):"duration"==a?new i({constraints:{min:0}}):new s,this.arrItems.push({id:e,name:t,control:o,tab:this,key:a,required:r})},show:function(){this.tabMenu.tabPanelDlg=this.tabMenu.tabPanelDlg||m.byId(this.tabMenu.tabPanelDlgId)||new a({title:"Settings"});try{this.tabMenu.tabPanelDlg.show()}catch(e){return}this.tabMenu.tabPanelDlg.titleNode.innerHTML=this.Description;var t,i,r=this.tabMenu.paneContentArea.firstChild.rows[1].cells[0].firstChild,o=null;this.showObjectInfo&&this.object&&(this.object.constructor==e?(this.insertData(r,"Id",this.object.taskItem.id),this.insertData(r,"Name",this.object.taskItem.name),this.insertData(r,"Start Time",this.encodeDate(this.object.taskItem.startTime)),this.insertData(r,"Duration (hours)",this.object.taskItem.duration+" hours"),this.insertData(r,"Percent Complete (%)",this.object.taskItem.percentage+"%"),this.insertData(r,"Task Assignee",this.object.taskItem.taskOwner),this.insertData(r,"Previous Task Id",this.object.taskItem.previousTaskId)):(this.insertData(r,"Id",this.object.project.id),this.insertData(r,"Name",this.object.project.name),this.insertData(r,"Start date",this.encodeDate(this.object.project.startDate)))),o=r.insertRow(r.rows.length),t=o.insertCell(o.cells.length),t.colSpan=2,t.innerHTML="<hr/>",o=r.insertRow(r.rows.length),t=o.insertCell(o.cells.length),t.colSpan=2,g.add(t,"ganttMenuDialogInputCellHeader"),t.innerHTML="Customization: "+this.Description,c.forEach(this.arrItems,function(a){o=r.insertRow(r.rows.length),t=o.insertCell(o.cells.length),g.add(t,"ganttMenuDialogInputCell"),i=o.insertCell(o.cells.length),g.add(i,"ganttMenuDialogInputCellValue"),t.innerHTML=a.name,i.appendChild(a.control.domNode),this.withDefaultValue&&this.object?this.object.constructor==e?"startTime"==a.key?a.control.textbox.value=this.encodeDate(this.object.taskItem.startTime):a.control.textbox.value=a.key?this.object.taskItem[a.key]:"":"startDate"==a.key?a.control.textbox.value=this.encodeDate(this.object.project.startDate):a.control.textbox.value=a.key?this.object.project[a.key]||this.object[a.key]||"":"":a.control.textbox.placeholder=a.required?"---required---":"---optional---"},this),this.tabMenu.ok.onClick=h.hitch(this,this.actionFunc),this.tabMenu.cancel.onClick=h.hitch(this,this.hide)},hide:function(){try{this.tabMenu.tabPanelDlg.hide()}catch(e){this.tabMenu.tabPanelDlg.destroy()}var e=this.tabMenu.paneContentArea.firstChild.rows[1].cells[0];e.firstChild.parentNode.removeChild(e.firstChild),e.innerHTML="<table></table>",g.add(e.firstChild,"ganttDialogContentCell")},insertData:function(e,t,a){var i,r=e.insertRow(e.rows.length),o=r.insertCell(r.cells.length);g.add(o,"ganttMenuDialogDescCell"),o.innerHTML=t,i=r.insertCell(r.cells.length),g.add(i,"ganttMenuDialogDescCellValue"),i.innerHTML=a}})});//# sourceMappingURL=contextMenuTab.js.map