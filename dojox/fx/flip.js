//>>built
define("dojox/fx/flip",["dojo/_base/kernel","dojo/_base/html","dojo/dom","dojo/dom-construct","dojo/dom-geometry","dojo/_base/connect","dojo/_base/Color","dojo/_base/sniff","dojo/_base/lang","dojo/_base/window","dojo/_base/fx","dojo/fx","./_base"],function(e,t,a,i,r,o,n,s,d,l,m,u,h){e.experimental("dojox.fx.flip");var c="border",f="Width",p="Height",y="Top",v="Right",g="Left",k="Bottom";return h.flip=function(e){var r=i.create("div"),h=e.node=a.byId(e.node),M=h.style,b=null,w=null,x=null,_=e.lightColor||"#dddddd",j=e.darkColor||"#555555",I=t.style(h,"backgroundColor"),F=e.endColor||I,z={},T=[],E=e.duration?e.duration/2:250,S=e.dir||"left",A=.9,C="transparent",G=e.whichAnim,N=e.axis||"center",P=e.depth,D=function(e){return"#000000"===new n(e).toHex()?"#000001":e};s("ie")<7&&(F=D(F),_=D(_),j=D(j),I=D(I),C="black",r.style.filter="chroma(color='#000000')");var L=function(e){return function(){var a=t.coords(e,!0);b={top:a.y,left:a.x,width:a.w,height:a.h}}}(h);L(),w={position:"absolute",top:b.top+"px",left:b.left+"px",height:"0",width:"0",zIndex:e.zIndex||M.zIndex||0,border:"0 solid "+C,fontSize:"0",visibility:"hidden"};var B=[{},{top:b.top,left:b.left}],H={left:[g,v,y,k,f,p,"end"+p+"Min",g,"end"+p+"Max"],right:[v,g,y,k,f,p,"end"+p+"Min",g,"end"+p+"Max"],top:[y,k,g,v,p,f,"end"+f+"Min",y,"end"+f+"Max"],bottom:[k,y,g,v,p,f,"end"+f+"Min",y,"end"+f+"Max"]};x=H[S],"undefined"!=typeof P?(P=Math.max(0,Math.min(1,P))/2,A=.4+(.5-P)):A=Math.min(.9,Math.max(.4,b[x[5].toLowerCase()]/b[x[4].toLowerCase()]));for(var q=B[0],Q=4;6>Q;Q++)"center"==N||"cube"==N?(b["end"+x[Q]+"Min"]=b[x[Q].toLowerCase()]*A,b["end"+x[Q]+"Max"]=b[x[Q].toLowerCase()]/A):"shortside"==N?(b["end"+x[Q]+"Min"]=b[x[Q].toLowerCase()],b["end"+x[Q]+"Max"]=b[x[Q].toLowerCase()]/A):"longside"==N&&(b["end"+x[Q]+"Min"]=b[x[Q].toLowerCase()]*A,b["end"+x[Q]+"Max"]=b[x[Q].toLowerCase()]);"center"==N?q[x[2].toLowerCase()]=b[x[2].toLowerCase()]-(b[x[8]]-b[x[6]])/4:"shortside"==N&&(q[x[2].toLowerCase()]=b[x[2].toLowerCase()]-(b[x[8]]-b[x[6]])/2),z[x[5].toLowerCase()]=b[x[5].toLowerCase()]+"px",z[x[4].toLowerCase()]="0",z[c+x[1]+f]=b[x[4].toLowerCase()]+"px",z[c+x[1]+"Color"]=I,q[c+x[1]+f]=0,q[c+x[1]+"Color"]=j,q[c+x[2]+f]=q[c+x[3]+f]="cube"!=N?(b["end"+x[5]+"Max"]-b["end"+x[5]+"Min"])/2:b[x[6]]/2,q[x[7].toLowerCase()]=b[x[7].toLowerCase()]+b[x[4].toLowerCase()]/2+(e.shift||0),q[x[5].toLowerCase()]=b[x[6]];var O=B[1];O[c+x[0]+"Color"]={start:_,end:F},O[c+x[0]+f]=b[x[4].toLowerCase()],O[c+x[2]+f]=0,O[c+x[3]+f]=0,O[x[5].toLowerCase()]={start:b[x[6]],end:b[x[5].toLowerCase()]},d.mixin(w,z),t.style(r,w),l.body().appendChild(r);var R=function(){i.destroy(r),M.backgroundColor=F,M.visibility="visible"};if("last"==G){for(Q in q)q[Q]={start:q[Q]};q[c+x[1]+"Color"]={start:j,end:F},O=q}return G&&"first"!=G||T.push(m.animateProperty({node:r,duration:E,properties:q})),G&&"last"!=G||T.push(m.animateProperty({node:r,duration:E,properties:O,onEnd:R})),o.connect(T[0],"play",function(){r.style.visibility="visible",M.visibility="hidden"}),u.chain(T)},h.flipCube=function(e){var t=[],a=r.getMarginBox(e.node),i=a.w/2,o=a.h/2,n={top:{pName:"height",args:[{whichAnim:"first",dir:"top",shift:-o},{whichAnim:"last",dir:"bottom",shift:o}]},right:{pName:"width",args:[{whichAnim:"first",dir:"right",shift:i},{whichAnim:"last",dir:"left",shift:-i}]},bottom:{pName:"height",args:[{whichAnim:"first",dir:"bottom",shift:o},{whichAnim:"last",dir:"top",shift:-o}]},left:{pName:"width",args:[{whichAnim:"first",dir:"left",shift:-i},{whichAnim:"last",dir:"right",shift:i}]}},s=n[e.dir||"left"],l=s.args;e.duration=e.duration?2*e.duration:500,e.depth=.8,e.axis="cube";for(var m=l.length-1;m>=0;m--)d.mixin(e,l[m]),t.push(h.flip(e));return u.combine(t)},h.flipPage=function(e){var a=e.node,r=t.coords(a,!0),n=r.x,s=r.y,m=r.w,h=r.h,c=t.style(a,"backgroundColor"),f=e.lightColor||"#dddddd",p=e.darkColor,y=i.create("div"),v=[],g=[],k=e.dir||"right",M={left:["left","right","x","w"],top:["top","bottom","y","h"],right:["left","left","x","w"],bottom:["top","top","y","h"]},b={right:[1,-1],left:[-1,1],top:[-1,1],bottom:[1,-1]};t.style(y,{position:"absolute",width:m+"px",height:h+"px",top:s+"px",left:n+"px",visibility:"hidden"});for(var w=[],x=0;2>x;x++){var _=x%2,j=_?M[k][1]:k,I=_?"last":"first",F=_?c:f,z=_?F:e.startColor||a.style.backgroundColor;g[x]=d.clone(y);var T=function(e){return function(){i.destroy(g[e])}}(x);l.body().appendChild(g[x]),w[x]={backgroundColor:_?z:c},w[x][M[k][0]]=r[M[k][2]]+b[k][0]*x*r[M[k][3]]+"px",t.style(g[x],w[x]),v.push(dojox.fx.flip({node:g[x],dir:j,axis:"shortside",depth:e.depth,duration:e.duration/2,shift:b[k][x]*r[M[k][3]]/2,darkColor:p,lightColor:f,whichAnim:I,endColor:F})),o.connect(v[x],"onEnd",T)}return u.chain(v)},h.flipGrid=function(e){var a=e.rows||4,r=e.cols||4,n=[],s=i.create("div"),m=e.node,h=t.coords(m,!0),c=h.x,f=h.y,p=h.w,y=h.h,v=h.w/r,g=h.h/a,k=[];t.style(s,{position:"absolute",width:v+"px",height:g+"px",backgroundColor:t.style(m,"backgroundColor")});for(var M=0;a>M;M++){var b=M%2,w=b?"right":"left",x=b?1:-1,_=d.clone(m);t.style(_,{position:"absolute",width:p+"px",height:y+"px",top:f+"px",left:c+"px",clip:"rect("+M*g+"px,"+p+"px,"+y+"px,0)"}),l.body().appendChild(_),n[M]=[];for(var j=0;r>j;j++){var I=d.clone(s),F=b?j:r-(j+1),z=function(e,a,i){return function(){a%2?t.style(e,{clip:"rect("+a*g+"px,"+p+"px,"+(a+1)*g+"px,"+(i+1)*v+"px)"}):t.style(e,{clip:"rect("+a*g+"px,"+(p-(i+1)*v)+"px,"+(a+1)*g+"px,0px)"})}}(_,M,j);l.body().appendChild(I),t.style(I,{left:c+F*v+"px",top:f+M*g+"px",visibility:"hidden"});var T=dojox.fx.flipPage({node:I,dir:w,duration:e.duration||900,shift:x*v/2,depth:.2,darkColor:e.darkColor,lightColor:e.lightColor,startColor:e.startColor||e.node.style.backgroundColor}),E=function(e){return function(){i.destroy(e)}}(I);o.connect(T,"play",this,z),o.connect(T,"play",this,E),n[M].push(T)}k.push(u.chain(n[M]))}return o.connect(k[0],"play",function(){t.style(m,{visibility:"hidden"})}),u.combine(k)},h});//# sourceMappingURL=flip.js.map