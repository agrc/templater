//>>built
define("dojox/fx/flip",["dojo/_base/kernel","dojo/_base/html","dojo/dom","dojo/dom-construct","dojo/dom-geometry","dojo/_base/connect","dojo/_base/Color","dojo/_base/sniff","dojo/_base/lang","dojo/_base/window","dojo/_base/fx","dojo/fx","./_base"],function(e,t,a,i,r,o,n,s,d,l,u,h,m){e.experimental("dojox.fx.flip");var c="border",f="Width",p="Height",g="Top",y="Right",v="Left",b="Bottom";return m.flip=function(e){var r=i.create("div"),m=e.node=a.byId(e.node),k=m.style,M=null,w=null,_=null,x=e.lightColor||"#dddddd",j=e.darkColor||"#555555",I=t.style(m,"backgroundColor"),F=e.endColor||I,S={},T=[],E=e.duration?e.duration/2:250,A=e.dir||"left",C=.9,z="transparent",N=e.whichAnim,G=e.axis||"center",D=e.depth,P=function(e){return"#000000"===new n(e).toHex()?"#000001":e};s("ie")<7&&(F=P(F),x=P(x),j=P(j),I=P(I),z="black",r.style.filter="chroma(color='#000000')");var L=function(e){return function(){var a=t.coords(e,!0);M={top:a.y,left:a.x,width:a.w,height:a.h}}}(m);L(),w={position:"absolute",top:M.top+"px",left:M.left+"px",height:"0",width:"0",zIndex:e.zIndex||k.zIndex||0,border:"0 solid "+z,fontSize:"0",visibility:"hidden"};var B=[{},{top:M.top,left:M.left}],H={left:[v,y,g,b,f,p,"end"+p+"Min",v,"end"+p+"Max"],right:[y,v,g,b,f,p,"end"+p+"Min",v,"end"+p+"Max"],top:[g,b,v,y,p,f,"end"+f+"Min",g,"end"+f+"Max"],bottom:[b,g,v,y,p,f,"end"+f+"Min",g,"end"+f+"Max"]};_=H[A],"undefined"!=typeof D?(D=Math.max(0,Math.min(1,D))/2,C=.4+(.5-D)):C=Math.min(.9,Math.max(.4,M[_[5].toLowerCase()]/M[_[4].toLowerCase()]));for(var q=B[0],O=4;6>O;O++)"center"==G||"cube"==G?(M["end"+_[O]+"Min"]=M[_[O].toLowerCase()]*C,M["end"+_[O]+"Max"]=M[_[O].toLowerCase()]/C):"shortside"==G?(M["end"+_[O]+"Min"]=M[_[O].toLowerCase()],M["end"+_[O]+"Max"]=M[_[O].toLowerCase()]/C):"longside"==G&&(M["end"+_[O]+"Min"]=M[_[O].toLowerCase()]*C,M["end"+_[O]+"Max"]=M[_[O].toLowerCase()]);"center"==G?q[_[2].toLowerCase()]=M[_[2].toLowerCase()]-(M[_[8]]-M[_[6]])/4:"shortside"==G&&(q[_[2].toLowerCase()]=M[_[2].toLowerCase()]-(M[_[8]]-M[_[6]])/2),S[_[5].toLowerCase()]=M[_[5].toLowerCase()]+"px",S[_[4].toLowerCase()]="0",S[c+_[1]+f]=M[_[4].toLowerCase()]+"px",S[c+_[1]+"Color"]=I,q[c+_[1]+f]=0,q[c+_[1]+"Color"]=j,q[c+_[2]+f]=q[c+_[3]+f]="cube"!=G?(M["end"+_[5]+"Max"]-M["end"+_[5]+"Min"])/2:M[_[6]]/2,q[_[7].toLowerCase()]=M[_[7].toLowerCase()]+M[_[4].toLowerCase()]/2+(e.shift||0),q[_[5].toLowerCase()]=M[_[6]];var R=B[1];R[c+_[0]+"Color"]={start:x,end:F},R[c+_[0]+f]=M[_[4].toLowerCase()],R[c+_[2]+f]=0,R[c+_[3]+f]=0,R[_[5].toLowerCase()]={start:M[_[6]],end:M[_[5].toLowerCase()]},d.mixin(w,S),t.style(r,w),l.body().appendChild(r);var Q=function(){i.destroy(r),k.backgroundColor=F,k.visibility="visible"};if("last"==N){for(O in q)q[O]={start:q[O]};q[c+_[1]+"Color"]={start:j,end:F},R=q}return N&&"first"!=N||T.push(u.animateProperty({node:r,duration:E,properties:q})),N&&"last"!=N||T.push(u.animateProperty({node:r,duration:E,properties:R,onEnd:Q})),o.connect(T[0],"play",function(){r.style.visibility="visible",k.visibility="hidden"}),h.chain(T)},m.flipCube=function(e){var t=[],a=r.getMarginBox(e.node),i=a.w/2,o=a.h/2,n={top:{pName:"height",args:[{whichAnim:"first",dir:"top",shift:-o},{whichAnim:"last",dir:"bottom",shift:o}]},right:{pName:"width",args:[{whichAnim:"first",dir:"right",shift:i},{whichAnim:"last",dir:"left",shift:-i}]},bottom:{pName:"height",args:[{whichAnim:"first",dir:"bottom",shift:o},{whichAnim:"last",dir:"top",shift:-o}]},left:{pName:"width",args:[{whichAnim:"first",dir:"left",shift:-i},{whichAnim:"last",dir:"right",shift:i}]}},s=n[e.dir||"left"],l=s.args;e.duration=e.duration?2*e.duration:500,e.depth=.8,e.axis="cube";for(var u=l.length-1;u>=0;u--)d.mixin(e,l[u]),t.push(m.flip(e));return h.combine(t)},m.flipPage=function(e){var a=e.node,r=t.coords(a,!0),n=r.x,s=r.y,u=r.w,m=r.h,c=t.style(a,"backgroundColor"),f=e.lightColor||"#dddddd",p=e.darkColor,g=i.create("div"),y=[],v=[],b=e.dir||"right",k={left:["left","right","x","w"],top:["top","bottom","y","h"],right:["left","left","x","w"],bottom:["top","top","y","h"]},M={right:[1,-1],left:[-1,1],top:[-1,1],bottom:[1,-1]};t.style(g,{position:"absolute",width:u+"px",height:m+"px",top:s+"px",left:n+"px",visibility:"hidden"});for(var w=[],_=0;2>_;_++){var x=_%2,j=x?k[b][1]:b,I=x?"last":"first",F=x?c:f,S=x?F:e.startColor||a.style.backgroundColor;v[_]=d.clone(g);var T=function(e){return function(){i.destroy(v[e])}}(_);l.body().appendChild(v[_]),w[_]={backgroundColor:x?S:c},w[_][k[b][0]]=r[k[b][2]]+M[b][0]*_*r[k[b][3]]+"px",t.style(v[_],w[_]),y.push(dojox.fx.flip({node:v[_],dir:j,axis:"shortside",depth:e.depth,duration:e.duration/2,shift:M[b][_]*r[k[b][3]]/2,darkColor:p,lightColor:f,whichAnim:I,endColor:F})),o.connect(y[_],"onEnd",T)}return h.chain(y)},m.flipGrid=function(e){var a=e.rows||4,r=e.cols||4,n=[],s=i.create("div"),u=e.node,m=t.coords(u,!0),c=m.x,f=m.y,p=m.w,g=m.h,y=m.w/r,v=m.h/a,b=[];t.style(s,{position:"absolute",width:y+"px",height:v+"px",backgroundColor:t.style(u,"backgroundColor")});for(var k=0;a>k;k++){var M=k%2,w=M?"right":"left",_=M?1:-1,x=d.clone(u);t.style(x,{position:"absolute",width:p+"px",height:g+"px",top:f+"px",left:c+"px",clip:"rect("+k*v+"px,"+p+"px,"+g+"px,0)"}),l.body().appendChild(x),n[k]=[];for(var j=0;r>j;j++){var I=d.clone(s),F=M?j:r-(j+1),S=function(e,a,i){return function(){a%2?t.style(e,{clip:"rect("+a*v+"px,"+p+"px,"+(a+1)*v+"px,"+(i+1)*y+"px)"}):t.style(e,{clip:"rect("+a*v+"px,"+(p-(i+1)*y)+"px,"+(a+1)*v+"px,0px)"})}}(x,k,j);l.body().appendChild(I),t.style(I,{left:c+F*y+"px",top:f+k*v+"px",visibility:"hidden"});var T=dojox.fx.flipPage({node:I,dir:w,duration:e.duration||900,shift:_*y/2,depth:.2,darkColor:e.darkColor,lightColor:e.lightColor,startColor:e.startColor||e.node.style.backgroundColor}),E=function(e){return function(){i.destroy(e)}}(I);o.connect(T,"play",this,S),o.connect(T,"play",this,E),n[k].push(T)}b.push(h.chain(n[k]))}return o.connect(b[0],"play",function(){t.style(u,{visibility:"hidden"})}),h.combine(b)},m});//# sourceMappingURL=flip.js.map