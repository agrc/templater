//>>built
define("dojox/highlight/_base",["dojo/_base/lang","dojo/_base/array","dojo/dom","dojo/dom-class"],function(e,t,i,a){function n(e){return e.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;")}function r(e){return t.every(e.childNodes,function(e){return 3==e.nodeType||"br"==String(e.nodeName).toLowerCase()})}function o(e){var i=[];return t.forEach(e.childNodes,function(e){if(3==e.nodeType)i.push(e.nodeValue);else{if("br"!=String(e.nodeName).toLowerCase())throw"Complex markup";i.push("\n")}}),i.join("")}function s(e){if(!e.keywordGroups)for(var t in e.keywords){var i=e.keywords[t];i instanceof Object?e.keywordGroups=e.keywords:e.keywordGroups={keyword:e.keywords};break}}function l(e){e.defaultMode&&e.modes&&(s(e.defaultMode),t.forEach(e.modes,s))}function d(e,t,i){if("code"==String(e.tagName).toLowerCase()&&"pre"==String(e.parentNode.tagName).toLowerCase()){var a=document.createElement("div"),n=e.parentNode.parentNode;a.innerHTML='<pre><code class="'+t+'">'+i+"</code></pre>",n.replaceChild(a.firstChild,e.parentNode)}else e.className=t,e.innerHTML=i}function h(e,t){var i=new g(e,t);return{result:i.result,langName:e,partialResult:i.partialResult}}function u(e,t){var i=h(t,o(e));d(e,e.className,i.result)}function c(e){var t="",i="",a=e;for(var n in f.languages)if(f.languages[n].defaultMode){var r=new g(n,a),o=r.keywordCount+r.relevance,s=0;(!t||o>s)&&(s=o,t=r.result,i=r.langName)}return{result:t,langName:i}}function m(e){var t=c(o(e));t.result&&d(e,t.langName,t.result)}var f=e.getObject("dojox.highlight",!0),p="\\b(0x[A-Za-z0-9]+|\\d+(\\.\\d+)?)";f.languages=f.languages||{},f.constants={IDENT_RE:"[a-zA-Z][a-zA-Z0-9_]*",UNDERSCORE_IDENT_RE:"[a-zA-Z_][a-zA-Z0-9_]*",NUMBER_RE:"\\b\\d+(\\.\\d+)?",C_NUMBER_RE:p,APOS_STRING_MODE:{className:"string",begin:"'",end:"'",illegal:"\\n",contains:["escape"],relevance:0},QUOTE_STRING_MODE:{className:"string",begin:'"',end:'"',illegal:"\\n",contains:["escape"],relevance:0},BACKSLASH_ESCAPE:{className:"escape",begin:"\\\\.",end:"^",relevance:0},C_LINE_COMMENT_MODE:{className:"comment",begin:"//",end:"$",relevance:0},C_BLOCK_COMMENT_MODE:{className:"comment",begin:"/\\*",end:"\\*/"},HASH_COMMENT_MODE:{className:"comment",begin:"#",end:"$"},C_NUMBER_MODE:{className:"number",begin:p,end:"^",relevance:0}};var g=function(e,t){this.langName=e,this.lang=f.languages[e],this.modes=[this.lang.defaultMode],this.relevance=0,this.keywordCount=0,this.result=[],this.lang.defaultMode.illegalRe||(this.buildRes(),l(this.lang));try{this.highlight(t),this.result=this.result.join("")}catch(i){if("Illegal"!=i)throw i;this.relevance=0,this.keywordCount=0,this.partialResult=this.result.join(""),this.result=n(t)}};return e.extend(g,{buildRes:function(){t.forEach(this.lang.modes,function(e){e.begin&&(e.beginRe=this.langRe("^"+e.begin)),e.end&&(e.endRe=this.langRe("^"+e.end)),e.illegal&&(e.illegalRe=this.langRe("^(?:"+e.illegal+")"))},this),this.lang.defaultMode.illegalRe=this.langRe("^(?:"+this.lang.defaultMode.illegal+")")},subMode:function(e){var t=this.modes[this.modes.length-1].contains;if(t)for(var i=this.lang.modes,a=0;a<t.length;++a)for(var n=t[a],r=0;r<i.length;++r){var o=i[r];if(o.className==n&&o.beginRe.test(e))return o}return null},endOfMode:function(e){for(var t=this.modes.length-1;t>=0;--t){var i=this.modes[t];if(i.end&&i.endRe.test(e))return this.modes.length-t;if(!i.endsWithParent)break}return 0},isIllegal:function(e){var t=this.modes[this.modes.length-1].illegalRe;return t&&t.test(e)},langRe:function(e,t){var i="m"+(this.lang.case_insensitive?"i":"")+(t?"g":"");return new RegExp(e,i)},buildTerminators:function(){var e=this.modes[this.modes.length-1],i={};e.contains&&t.forEach(this.lang.modes,function(a){t.indexOf(e.contains,a.className)>=0&&(i[a.begin]=1)});for(var a=this.modes.length-1;a>=0;--a){var n=this.modes[a];if(n.end&&(i[n.end]=1),!n.endsWithParent)break}e.illegal&&(i[e.illegal]=1);var r=[];for(a in i)r.push(a);e.terminatorsRe=this.langRe("("+r.join("|")+")")},eatModeChunk:function(e,t){var i=this.modes[this.modes.length-1];i.terminatorsRe||this.buildTerminators(),e=e.substr(t);var a=i.terminatorsRe.exec(e);return a?{buffer:a.index?e.substr(0,a.index):"",lexeme:a[0],end:!1}:{buffer:e,lexeme:"",end:!0}},keywordMatch:function(e,t){var i=t[0];this.lang.case_insensitive&&(i=i.toLowerCase());for(var a in e.keywordGroups)if(i in e.keywordGroups[a])return a;return""},buildLexemes:function(e){var i={};t.forEach(e.lexems,function(e){i[e]=1});var a=[];for(var n in i)a.push(n);e.lexemsRe=this.langRe("("+a.join("|")+")",!0)},processKeywords:function(e){var t=this.modes[this.modes.length-1];if(!t.keywords||!t.lexems)return n(e);t.lexemsRe||this.buildLexemes(t),t.lexemsRe.lastIndex=0;for(var i=[],a=0,r=t.lexemsRe.exec(e);r;){i.push(n(e.substr(a,r.index-a)));var o=this.keywordMatch(t,r);o?(++this.keywordCount,i.push('<span class="'+o+'">'+n(r[0])+"</span>")):i.push(n(r[0])),a=t.lexemsRe.lastIndex,r=t.lexemsRe.exec(e)}return i.push(n(e.substr(a,e.length-a))),i.join("")},processModeInfo:function(e,t,i){var a=this.modes[this.modes.length-1];if(i)return void this.result.push(this.processKeywords(a.buffer+e));if(this.isIllegal(t))throw"Illegal";var n=this.subMode(t);if(n)return a.buffer+=e,this.result.push(this.processKeywords(a.buffer)),n.excludeBegin?(this.result.push(t+'<span class="'+n.className+'">'),n.buffer=""):(this.result.push('<span class="'+n.className+'">'),n.buffer=t),this.modes.push(n),void(this.relevance+="number"==typeof n.relevance?n.relevance:1);var r=this.endOfMode(t);if(r){for(a.buffer+=e,a.excludeEnd?this.result.push(this.processKeywords(a.buffer)+"</span>"+t):this.result.push(this.processKeywords(a.buffer+t)+"</span>");r>1;)this.result.push("</span>"),--r,this.modes.pop();return this.modes.pop(),void(this.modes[this.modes.length-1].buffer="")}},highlight:function(e){var t=0;this.lang.defaultMode.buffer="";do{var i=this.eatModeChunk(e,t);this.processModeInfo(i.buffer,i.lexeme,i.end),t+=i.buffer.length+i.lexeme.length}while(!i.end);if(this.modes.length>1)throw"Illegal"}}),dojox.highlight.processString=function(e,t){return t?h(t,e):c(e)},dojox.highlight.init=function(e){if(e=i.byId(e),!a.contains(e,"no-highlight")&&r(e)){var n=e.className.split(/\s+/),o=t.some(n,function(t){return"_"!=t.charAt(0)&&f.languages[t]?(u(e,t),!0):!1});o||m(e)}},f.Code=function(e,t){f.init(t)},f});//# sourceMappingURL=_base.js.map