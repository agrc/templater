//>>built
define("dojox/highlight/_base",["dojo/_base/lang","dojo/_base/array","dojo/dom","dojo/dom-class"],function(e,t,i,a){function r(e){return e.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;")}function o(e){return t.every(e.childNodes,function(e){return 3==e.nodeType||"br"==String(e.nodeName).toLowerCase()})}function n(e){var i=[];return t.forEach(e.childNodes,function(e){if(3==e.nodeType)i.push(e.nodeValue);else{if("br"!=String(e.nodeName).toLowerCase())throw"Complex markup";i.push("\n")}}),i.join("")}function s(e){if(!e.keywordGroups)for(var t in e.keywords){var i=e.keywords[t];i instanceof Object?e.keywordGroups=e.keywords:e.keywordGroups={keyword:e.keywords};break}}function d(e){e.defaultMode&&e.modes&&(s(e.defaultMode),t.forEach(e.modes,s))}function l(e,t,i){if("code"==String(e.tagName).toLowerCase()&&"pre"==String(e.parentNode.tagName).toLowerCase()){var a=document.createElement("div"),r=e.parentNode.parentNode;a.innerHTML='<pre><code class="'+t+'">'+i+"</code></pre>",r.replaceChild(a.firstChild,e.parentNode)}else e.className=t,e.innerHTML=i}function u(e,t){var i=new p(e,t);return{result:i.result,langName:e,partialResult:i.partialResult}}function c(e,t){var i=u(t,n(e));l(e,e.className,i.result)}function h(e){var t="",i="",a=e;for(var r in f.languages)if(f.languages[r].defaultMode){var o=new p(r,a),n=o.keywordCount+o.relevance,s=0;(!t||n>s)&&(s=n,t=o.result,i=o.langName)}return{result:t,langName:i}}function m(e){var t=h(n(e));t.result&&l(e,t.langName,t.result)}var f=e.getObject("dojox.highlight",!0),g="\\b(0x[A-Za-z0-9]+|\\d+(\\.\\d+)?)";f.languages=f.languages||{},f.constants={IDENT_RE:"[a-zA-Z][a-zA-Z0-9_]*",UNDERSCORE_IDENT_RE:"[a-zA-Z_][a-zA-Z0-9_]*",NUMBER_RE:"\\b\\d+(\\.\\d+)?",C_NUMBER_RE:g,APOS_STRING_MODE:{className:"string",begin:"'",end:"'",illegal:"\\n",contains:["escape"],relevance:0},QUOTE_STRING_MODE:{className:"string",begin:'"',end:'"',illegal:"\\n",contains:["escape"],relevance:0},BACKSLASH_ESCAPE:{className:"escape",begin:"\\\\.",end:"^",relevance:0},C_LINE_COMMENT_MODE:{className:"comment",begin:"//",end:"$",relevance:0},C_BLOCK_COMMENT_MODE:{className:"comment",begin:"/\\*",end:"\\*/"},HASH_COMMENT_MODE:{className:"comment",begin:"#",end:"$"},C_NUMBER_MODE:{className:"number",begin:g,end:"^",relevance:0}};var p=function(e,t){this.langName=e,this.lang=f.languages[e],this.modes=[this.lang.defaultMode],this.relevance=0,this.keywordCount=0,this.result=[],this.lang.defaultMode.illegalRe||(this.buildRes(),d(this.lang));try{this.highlight(t),this.result=this.result.join("")}catch(e){if("Illegal"!=e)throw e;this.relevance=0,this.keywordCount=0,this.partialResult=this.result.join(""),this.result=r(t)}};return e.extend(p,{buildRes:function(){t.forEach(this.lang.modes,function(e){e.begin&&(e.beginRe=this.langRe("^"+e.begin)),e.end&&(e.endRe=this.langRe("^"+e.end)),e.illegal&&(e.illegalRe=this.langRe("^(?:"+e.illegal+")"))},this),this.lang.defaultMode.illegalRe=this.langRe("^(?:"+this.lang.defaultMode.illegal+")")},subMode:function(e){var t=this.modes[this.modes.length-1].contains;if(t)for(var i=this.lang.modes,a=0;a<t.length;++a)for(var r=t[a],o=0;o<i.length;++o){var n=i[o];if(n.className==r&&n.beginRe.test(e))return n}return null},endOfMode:function(e){for(var t=this.modes.length-1;t>=0;--t){var i=this.modes[t];if(i.end&&i.endRe.test(e))return this.modes.length-t;if(!i.endsWithParent)break}return 0},isIllegal:function(e){var t=this.modes[this.modes.length-1].illegalRe;return t&&t.test(e)},langRe:function(e,t){var i="m"+(this.lang.case_insensitive?"i":"")+(t?"g":"");return new RegExp(e,i)},buildTerminators:function(){var e=this.modes[this.modes.length-1],i={};e.contains&&t.forEach(this.lang.modes,function(a){t.indexOf(e.contains,a.className)>=0&&(i[a.begin]=1)});for(var a=this.modes.length-1;a>=0;--a){var r=this.modes[a];if(r.end&&(i[r.end]=1),!r.endsWithParent)break}e.illegal&&(i[e.illegal]=1);var o=[];for(a in i)o.push(a);e.terminatorsRe=this.langRe("("+o.join("|")+")")},eatModeChunk:function(e,t){var i=this.modes[this.modes.length-1];i.terminatorsRe||this.buildTerminators(),e=e.substr(t);var a=i.terminatorsRe.exec(e);return a?{buffer:a.index?e.substr(0,a.index):"",lexeme:a[0],end:!1}:{buffer:e,lexeme:"",end:!0}},keywordMatch:function(e,t){var i=t[0];this.lang.case_insensitive&&(i=i.toLowerCase());for(var a in e.keywordGroups)if(i in e.keywordGroups[a])return a;return""},buildLexemes:function(e){var i={};t.forEach(e.lexems,function(e){i[e]=1});var a=[];for(var r in i)a.push(r);e.lexemsRe=this.langRe("("+a.join("|")+")",!0)},processKeywords:function(e){var t=this.modes[this.modes.length-1];if(!t.keywords||!t.lexems)return r(e);t.lexemsRe||this.buildLexemes(t),t.lexemsRe.lastIndex=0;for(var i=[],a=0,o=t.lexemsRe.exec(e);o;){i.push(r(e.substr(a,o.index-a)));var n=this.keywordMatch(t,o);n?(++this.keywordCount,i.push('<span class="'+n+'">'+r(o[0])+"</span>")):i.push(r(o[0])),a=t.lexemsRe.lastIndex,o=t.lexemsRe.exec(e)}return i.push(r(e.substr(a,e.length-a))),i.join("")},processModeInfo:function(e,t,i){var a=this.modes[this.modes.length-1];if(i)return void this.result.push(this.processKeywords(a.buffer+e));if(this.isIllegal(t))throw"Illegal";var r=this.subMode(t);if(r)return a.buffer+=e,this.result.push(this.processKeywords(a.buffer)),r.excludeBegin?(this.result.push(t+'<span class="'+r.className+'">'),r.buffer=""):(this.result.push('<span class="'+r.className+'">'),r.buffer=t),this.modes.push(r),void(this.relevance+="number"==typeof r.relevance?r.relevance:1);var o=this.endOfMode(t);if(o){for(a.buffer+=e,a.excludeEnd?this.result.push(this.processKeywords(a.buffer)+"</span>"+t):this.result.push(this.processKeywords(a.buffer+t)+"</span>");o>1;)this.result.push("</span>"),--o,this.modes.pop();return this.modes.pop(),void(this.modes[this.modes.length-1].buffer="")}},highlight:function(e){var t=0;this.lang.defaultMode.buffer="";do{var i=this.eatModeChunk(e,t);this.processModeInfo(i.buffer,i.lexeme,i.end),t+=i.buffer.length+i.lexeme.length}while(!i.end);if(this.modes.length>1)throw"Illegal"}}),dojox.highlight.processString=function(e,t){return t?u(t,e):h(e)},dojox.highlight.init=function(e){if(e=i.byId(e),!a.contains(e,"no-highlight")&&o(e)){var r=e.className.split(/\s+/);t.some(r,function(t){return!("_"==t.charAt(0)||!f.languages[t])&&(c(e,t),!0)})||m(e)}},f.Code=function(e,t){f.init(t)},f});//# sourceMappingURL=_base.js.map