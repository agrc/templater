//>>built
define("dojox/form/manager/_NodeMixin",["dojo/_base/lang","dojo/_base/array","dojo/on","dojo/dom","dojo/dom-attr","dojo/query","./_Mixin","dijit/form/_FormWidget","dijit/_base/manager","dojo/_base/declare"],function(e,t,i,a,o,r,n,s,l,d){var u=e.getObject("dojox.form.manager",!0),m=u.actionAdapter,c=u._keys,h=u.changeEvent=function(e){var t="click";switch(e.tagName.toLowerCase()){case"textarea":t="keyup";break;case"select":t="change";break;case"input":switch(e.type.toLowerCase()){case"text":case"password":t="keyup"}}return t},f=function(t,i){var a=o.get(t,"name");if(i=i||this.domNode,!a||a in this.formWidgets)a=null;else{for(var r=t;r&&r!==i;r=r.parentNode)if(o.get(r,"widgetId")&&l.byNode(r).isInstanceOf(s))return null;if("input"==t.tagName.toLowerCase()&&"radio"==t.type.toLowerCase()){var n=this.formNodes[a];n=n&&n.node,n&&e.isArray(n)?n.push(t):this.formNodes[a]={node:[t],connections:[]}}else this.formNodes[a]={node:t,connections:[]}}return a},p=function(i){var a={};return m(function(i,r){var n=o.get(r,"data-dojo-observer")||o.get(r,"observer");n&&"string"==typeof n&&t.forEach(n.split(","),function(t){(t=e.trim(t))&&e.isFunction(this[t])&&(a[t]=1)},this)}).call(this,null,this.formNodes[i].node),c(a)},g=function(a,o){var r=this.formNodes[a],n=r.connections;n.length&&(t.forEach(n,function(e){e.remove()}),n=r.connections=[]),m(function(r,s){var l=h(s);t.forEach(o,function(t){n.push(i(s,l,e.hitch(this,function(e){this.watching&&this[t](this.formNodeValue(a),a,s,e)})))},this)}).call(this,null,r.node)};return d("dojox.form.manager._NodeMixin",null,{destroy:function(){for(var e in this.formNodes)t.forEach(this.formNodes[e].connections,function(e){e.remove()});this.formNodes={},this.inherited(arguments)},registerNode:function(e){"string"==typeof e&&(e=a.byId(e));var t=f.call(this,e);return t&&g.call(this,t,p.call(this,t)),this},unregisterNode:function(e){return e in this.formNodes&&(t.forEach(this.formNodes[e].connections,function(e){e.remove()}),delete this.formNodes[e]),this},registerNodeDescendants:function(e){return"string"==typeof e&&(e=a.byId(e)),r("input, select, textarea, button",e).map(function(t){return f.call(this,t,e)},this).forEach(function(e){e&&g.call(this,e,p.call(this,e))},this),this},unregisterNodeDescendants:function(e){return"string"==typeof e&&(e=a.byId(e)),r("input, select, textarea, button",e).map(function(t){return o.get(e,"name")||null}).forEach(function(e){e&&this.unregisterNode(e)},this),this},formNodeValue:function(i,a){var o,n=2==arguments.length&&void 0!==a;if("string"==typeof i&&(i=this.formNodes[i])&&(i=i.node),!i)return null;if(e.isArray(i))return n?(t.forEach(i,function(e){e.checked=""}),t.forEach(i,function(e){e.checked=e.value===a?"checked":""}),this):(t.some(i,function(e){return!!e.checked&&(o=e,!0)}),o?o.value:"");switch(i.tagName.toLowerCase()){case"select":if(i.multiple){if(n){if(e.isArray(a)){var s={};return t.forEach(a,function(e){s[e]=1}),r("> option",i).forEach(function(e){e.selected=e.value in s}),this}return r("> option",i).forEach(function(e){e.selected=e.value===a}),this}return o=r("> option",i).filter(function(e){return e.selected}).map(function(e){return e.value}),1==o.length?o[0]:o}return n?(r("> option",i).forEach(function(e){e.selected=e.value===a}),this):i.value||"";case"button":return n?(i.innerHTML=""+a,this):i.innerHTML;case"input":if("checkbox"==i.type.toLowerCase())return n?(i.checked=a?"checked":"",this):Boolean(i.checked)}return n?(i.value=""+a,this):i.value},inspectFormNodes:function(i,a,o){var r,n={};if(a)if(e.isArray(a))t.forEach(a,function(e){e in this.formNodes&&(n[e]=i.call(this,e,this.formNodes[e].node,o))},this);else for(r in a)r in this.formNodes&&(n[r]=i.call(this,r,this.formNodes[r].node,a[r]));else for(r in this.formNodes)n[r]=i.call(this,r,this.formNodes[r].node,o);return n}})});//# sourceMappingURL=_NodeMixin.js.map