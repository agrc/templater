//>>built
define("dojox/form/manager/_NodeMixin",["dojo/_base/lang","dojo/_base/array","dojo/on","dojo/dom","dojo/dom-attr","dojo/query","./_Mixin","dijit/form/_FormWidget","dijit/_base/manager","dojo/_base/declare"],function(e,t,a,i,o,r,n,s,l,d){var u=e.getObject("dojox.form.manager",!0),m=u.actionAdapter,h=u._keys,c=u.changeEvent=function(e){var t="click";switch(e.tagName.toLowerCase()){case"textarea":t="keyup";break;case"select":t="change";break;case"input":switch(e.type.toLowerCase()){case"text":case"password":t="keyup"}}return t},f=function(t,a){var i=o.get(t,"name");if(a=a||this.domNode,!i||i in this.formWidgets)i=null;else{for(var r=t;r&&r!==a;r=r.parentNode)if(o.get(r,"widgetId")&&l.byNode(r).isInstanceOf(s))return null;if("input"==t.tagName.toLowerCase()&&"radio"==t.type.toLowerCase()){var n=this.formNodes[i];n=n&&n.node,n&&e.isArray(n)?n.push(t):this.formNodes[i]={node:[t],connections:[]}}else this.formNodes[i]={node:t,connections:[]}}return i},p=function(a){var i={};return m(function(a,r){var n=o.get(r,"data-dojo-observer")||o.get(r,"observer");n&&"string"==typeof n&&t.forEach(n.split(","),function(t){(t=e.trim(t))&&e.isFunction(this[t])&&(i[t]=1)},this)}).call(this,null,this.formNodes[a].node),h(i)},g=function(i,o){var r=this.formNodes[i],n=r.connections;n.length&&(t.forEach(n,function(e){e.remove()}),n=r.connections=[]),m(function(r,s){var l=c(s);t.forEach(o,function(t){n.push(a(s,l,e.hitch(this,function(e){this.watching&&this[t](this.formNodeValue(i),i,s,e)})))},this)}).call(this,null,r.node)};return d("dojox.form.manager._NodeMixin",null,{destroy:function(){for(var e in this.formNodes)t.forEach(this.formNodes[e].connections,function(e){e.remove()});this.formNodes={},this.inherited(arguments)},registerNode:function(e){"string"==typeof e&&(e=i.byId(e));var t=f.call(this,e);return t&&g.call(this,t,p.call(this,t)),this},unregisterNode:function(e){return e in this.formNodes&&(t.forEach(this.formNodes[e].connections,function(e){e.remove()}),delete this.formNodes[e]),this},registerNodeDescendants:function(e){return"string"==typeof e&&(e=i.byId(e)),r("input, select, textarea, button",e).map(function(t){return f.call(this,t,e)},this).forEach(function(e){e&&g.call(this,e,p.call(this,e))},this),this},unregisterNodeDescendants:function(e){return"string"==typeof e&&(e=i.byId(e)),r("input, select, textarea, button",e).map(function(t){return o.get(e,"name")||null}).forEach(function(e){e&&this.unregisterNode(e)},this),this},formNodeValue:function(a,i){var o,n=2==arguments.length&&void 0!==i;if("string"==typeof a&&(a=this.formNodes[a])&&(a=a.node),!a)return null;if(e.isArray(a))return n?(t.forEach(a,function(e){e.checked=""}),t.forEach(a,function(e){e.checked=e.value===i?"checked":""}),this):(t.some(a,function(e){return!!e.checked&&(o=e,!0)}),o?o.value:"");switch(a.tagName.toLowerCase()){case"select":if(a.multiple){if(n){if(e.isArray(i)){var s={};return t.forEach(i,function(e){s[e]=1}),r("> option",a).forEach(function(e){e.selected=e.value in s}),this}return r("> option",a).forEach(function(e){e.selected=e.value===i}),this}return o=r("> option",a).filter(function(e){return e.selected}).map(function(e){return e.value}),1==o.length?o[0]:o}return n?(r("> option",a).forEach(function(e){e.selected=e.value===i}),this):a.value||"";case"button":return n?(a.innerHTML=""+i,this):a.innerHTML;case"input":if("checkbox"==a.type.toLowerCase())return n?(a.checked=i?"checked":"",this):Boolean(a.checked)}return n?(a.value=""+i,this):a.value},inspectFormNodes:function(a,i,o){var r,n={};if(i)if(e.isArray(i))t.forEach(i,function(e){e in this.formNodes&&(n[e]=a.call(this,e,this.formNodes[e].node,o))},this);else for(r in i)r in this.formNodes&&(n[r]=a.call(this,r,this.formNodes[r].node,i[r]));else for(r in this.formNodes)n[r]=a.call(this,r,this.formNodes[r].node,o);return n}})});//# sourceMappingURL=_NodeMixin.js.map