//>>built
define("dojox/form/manager/_NodeMixin",["dojo/_base/lang","dojo/_base/array","dojo/on","dojo/dom","dojo/dom-attr","dojo/query","./_Mixin","dijit/form/_FormWidget","dijit/_base/manager","dojo/_base/declare"],function(e,t,a,i,r,o,n,d,s,l){var u=e.getObject("dojox.form.manager",!0),m=u.actionAdapter,h=u._keys,c=u.changeEvent=function(e){var t="click";switch(e.tagName.toLowerCase()){case"textarea":t="keyup";break;case"select":t="change";break;case"input":switch(e.type.toLowerCase()){case"text":case"password":t="keyup"}}return t},f=function(t,a){var i=r.get(t,"name");if(a=a||this.domNode,!i||i in this.formWidgets)i=null;else{for(var o=t;o&&o!==a;o=o.parentNode)if(r.get(o,"widgetId")&&s.byNode(o).isInstanceOf(d))return null;if("input"==t.tagName.toLowerCase()&&"radio"==t.type.toLowerCase()){var n=this.formNodes[i];n=n&&n.node,n&&e.isArray(n)?n.push(t):this.formNodes[i]={node:[t],connections:[]}}else this.formNodes[i]={node:t,connections:[]}}return i},y=function(a){var i={};return m(function(a,o){var n=r.get(o,"data-dojo-observer")||r.get(o,"observer");n&&"string"==typeof n&&t.forEach(n.split(","),function(t){t=e.trim(t),t&&e.isFunction(this[t])&&(i[t]=1)},this)}).call(this,null,this.formNodes[a].node),h(i)},p=function(i,r){var o=this.formNodes[i],n=o.connections;n.length&&(t.forEach(n,function(e){e.remove()}),n=o.connections=[]),m(function(o,d){var s=c(d);t.forEach(r,function(t){n.push(a(d,s,e.hitch(this,function(e){this.watching&&this[t](this.formNodeValue(i),i,d,e)})))},this)}).call(this,null,o.node)};return l("dojox.form.manager._NodeMixin",null,{destroy:function(){for(var e in this.formNodes)t.forEach(this.formNodes[e].connections,function(e){e.remove()});this.formNodes={},this.inherited(arguments)},registerNode:function(e){"string"==typeof e&&(e=i.byId(e));var t=f.call(this,e);return t&&p.call(this,t,y.call(this,t)),this},unregisterNode:function(e){return e in this.formNodes&&(t.forEach(this.formNodes[e].connections,function(e){e.remove()}),delete this.formNodes[e]),this},registerNodeDescendants:function(e){return"string"==typeof e&&(e=i.byId(e)),o("input, select, textarea, button",e).map(function(t){return f.call(this,t,e)},this).forEach(function(e){e&&p.call(this,e,y.call(this,e))},this),this},unregisterNodeDescendants:function(e){return"string"==typeof e&&(e=i.byId(e)),o("input, select, textarea, button",e).map(function(t){return r.get(e,"name")||null}).forEach(function(e){e&&this.unregisterNode(e)},this),this},formNodeValue:function(a,i){var r,n=2==arguments.length&&void 0!==i;if("string"==typeof a&&(a=this.formNodes[a],a&&(a=a.node)),!a)return null;if(e.isArray(a))return n?(t.forEach(a,function(e){e.checked=""}),t.forEach(a,function(e){e.checked=e.value===i?"checked":""}),this):(t.some(a,function(e){return e.checked?(r=e,!0):!1}),r?r.value:"");switch(a.tagName.toLowerCase()){case"select":if(a.multiple){if(n){if(e.isArray(i)){var d={};return t.forEach(i,function(e){d[e]=1}),o("> option",a).forEach(function(e){e.selected=e.value in d}),this}return o("> option",a).forEach(function(e){e.selected=e.value===i}),this}return r=o("> option",a).filter(function(e){return e.selected}).map(function(e){return e.value}),1==r.length?r[0]:r}return n?(o("> option",a).forEach(function(e){e.selected=e.value===i}),this):a.value||"";case"button":return n?(a.innerHTML=""+i,this):a.innerHTML;case"input":if("checkbox"==a.type.toLowerCase())return n?(a.checked=i?"checked":"",this):Boolean(a.checked)}return n?(a.value=""+i,this):a.value},inspectFormNodes:function(a,i,r){var o,n={};if(i)if(e.isArray(i))t.forEach(i,function(e){e in this.formNodes&&(n[e]=a.call(this,e,this.formNodes[e].node,r))},this);else for(o in i)o in this.formNodes&&(n[o]=a.call(this,o,this.formNodes[o].node,i[o]));else for(o in this.formNodes)n[o]=a.call(this,o,this.formNodes[o].node,r);return n}})});//# sourceMappingURL=_NodeMixin.js.map