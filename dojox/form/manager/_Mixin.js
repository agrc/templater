//>>built
define("dojox/form/manager/_Mixin",["dojo/_base/window","dojo/_base/lang","dojo/_base/array","dojo/on","dojo/dom-attr","dojo/dom-class","dijit/_base/manager","dijit/_Widget","dijit/form/_FormWidget","dijit/form/Button","dijit/form/CheckBox","dojo/_base/declare"],function(e,t,i,a,r,o,n,d,s,l,u,m){var h=t.getObject("dojox.form.manager",!0),c=h.actionAdapter=function(e){return function(a,r,o){t.isArray(r)?i.forEach(r,function(t){e.call(this,a,t,o)},this):e.apply(this,arguments)}},f=(h.inspectorAdapter=function(e){return function(i,a,r){return e.call(this,i,t.isArray(a)?a[0]:a,r)}},{domNode:1,containerNode:1,srcNodeRef:1,bgIframe:1}),y=h._keys=function(e){var t,i=[];for(t in e)e.hasOwnProperty(t)&&i.push(t);return i},p=function(e){var i=e.get("name");if(i&&e.isInstanceOf(s))if(i in this.formWidgets){var a=this.formWidgets[i].widget;t.isArray(a)?a.push(e):this.formWidgets[i].widget=[a,e]}else this.formWidgets[i]={widget:e,connections:[]};else i=null;return i},g=function(e){var a={};return c(function(e,r){var o=r.get("data-dojo-observer")||r.get("observer");o&&"string"==typeof o&&i.forEach(o.split(","),function(e){(e=t.trim(e))&&t.isFunction(this[e])&&(a[e]=1)},this)}).call(this,null,this.formWidgets[e].widget),y(a)},v=function(e,o){var n=this.formWidgets[e],d=n.widget,s=n.connections;if(s.length&&(i.forEach(s,function(e){e.remove()}),s=n.connections=[]),t.isArray(d))i.forEach(d,function(n){i.forEach(o,function(i){s.push(a(n,"change",t.hitch(this,function(t){this.watching&&r.get(n.focusNode,"checked")&&this[i](n.get("value"),e,n,t)})))},this)},this);else{var u=d.isInstanceOf(l)?"click":"change";i.forEach(o,function(i){s.push(a(d,u,t.hitch(this,function(t){this.watching&&this[i](d.get("value"),e,d,t)})))},this)}},b=m("dojox.form.manager._Mixin",null,{watching:!0,startup:function(){this._started||(this.formWidgets={},this.formNodes={},this.registerWidgetDescendants(this),this.inherited(arguments))},destroy:function(){for(var e in this.formWidgets)i.forEach(this.formWidgets[e].connections,function(e){e.remove()});this.formWidgets={},this.inherited(arguments)},registerWidget:function(e){"string"==typeof e?e=n.byId(e):e.tagName&&e.cloneNode&&(e=n.byNode(e));var t=p.call(this,e);return t&&v.call(this,t,g.call(this,t)),this},unregisterWidget:function(e){return e in this.formWidgets&&(i.forEach(this.formWidgets[e].connections,function(e){e.remove()}),delete this.formWidgets[e]),this},registerWidgetDescendants:function(e){"string"==typeof e?e=n.byId(e):e.tagName&&e.cloneNode&&(e=n.byNode(e));var t=i.map(e.getDescendants(),p,this);return i.forEach(t,function(e){e&&v.call(this,e,g.call(this,e))},this),this.registerNodeDescendants?this.registerNodeDescendants(e.domNode):this},unregisterWidgetDescendants:function(e){return"string"==typeof e?e=n.byId(e):e.tagName&&e.cloneNode&&(e=n.byNode(e)),i.forEach(i.map(e.getDescendants(),function(e){return e instanceof s&&e.get("name")||null}),function(e){e&&this.unregisterWidget(e)},this),this.unregisterNodeDescendants?this.unregisterNodeDescendants(e.domNode):this},formWidgetValue:function(e,a){var o,n=2==arguments.length&&void 0!==a;return"string"==typeof e&&(e=this.formWidgets[e])&&(e=e.widget),e?t.isArray(e)?n?(i.forEach(e,function(e){e.set("checked",!1,!this.watching)},this),i.forEach(e,function(e){e.set("checked",e.value===a,!this.watching)},this),this):(i.some(e,function(e){return!!r.get(e.focusNode,"checked")&&(o=e,!0)}),o?o.get("value"):""):e.isInstanceOf&&e.isInstanceOf(u)?n?(e.set("value",Boolean(a),!this.watching),this):Boolean(e.get("value")):n?(e.set("value",a,!this.watching),this):e.get("value"):null},formPointValue:function(e,t){return e&&"string"==typeof e&&(e=this[e]),e&&e.tagName&&e.cloneNode&&o.contains(e,"dojoFormValue")?2==arguments.length&&void 0!==t?(e.innerHTML=t,this):e.innerHTML:null},inspectFormWidgets:function(e,a,r){var o,n={};if(a)if(t.isArray(a))i.forEach(a,function(t){t in this.formWidgets&&(n[t]=e.call(this,t,this.formWidgets[t].widget,r))},this);else for(o in a)o in this.formWidgets&&(n[o]=e.call(this,o,this.formWidgets[o].widget,a[o]));else for(o in this.formWidgets)n[o]=e.call(this,o,this.formWidgets[o].widget,r);return n},inspectAttachedPoints:function(e,a,r){var o,n,d={};if(a)if(t.isArray(a))i.forEach(a,function(t){(n=this[t])&&n.tagName&&n.cloneNode&&(d[t]=e.call(this,t,n,r))},this);else for(o in a)(n=this[o])&&n.tagName&&n.cloneNode&&(d[o]=e.call(this,o,n,a[o]));else for(o in this)o in f||(n=this[o])&&n.tagName&&n.cloneNode&&(d[o]=e.call(this,o,n,r));return d},inspect:function(e,a,r){var o=this.inspectFormWidgets(function(a,r,o){return t.isArray(r)?e.call(this,a,i.map(r,function(e){return e.domNode}),o):e.call(this,a,r.domNode,o)},a,r);return this.inspectFormNodes&&t.mixin(o,this.inspectFormNodes(e,a,r)),t.mixin(o,this.inspectAttachedPoints(e,a,r))}});return t.extend(d,{observer:""}),b});//# sourceMappingURL=_Mixin.js.map