//>>built
define("dojox/form/_RangeSliderMixin",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/fx","dojo/_base/event","dojo/_base/sniff","dojo/dom-style","dojo/dom-geometry","dojo/keys","dijit","dojo/dnd/Mover","dojo/dnd/Moveable","dijit/form/_FormValueWidget","dijit/focus","dojo/fx","dojox/fx"],function(e,t,i,r,a,n,o,s,l,d,u,c,m,h,f){var p=function(e,t){return t-e},g=function(e,t){return e-t},y=e("dojox.form._RangeSliderMixin",null,{_setTabIndexAttr:["sliderHandle","sliderHandleMax"],value:[0,100],postMixInProperties:function(){this.inherited(arguments),this.value=i.map(this.value,function(e){return parseInt(e,10)})},postCreate:function(){this.inherited(arguments),this.value.sort(this._isReversed()?p:g);var t=this,i=e(v,{constructor:function(){this.widget=t}});this._movableMax=new c(this.sliderHandleMax,{mover:i}),this.sliderHandle.setAttribute("aria-valuemin",this.minimum),this.sliderHandle.setAttribute("aria-valuemax",this.maximum),this.sliderHandleMax.setAttribute("aria-valuemin",this.minimum),this.sliderHandleMax.setAttribute("aria-valuemax",this.maximum);var r=e(b,{constructor:function(){this.widget=t}});this._movableBar=new c(this.progressBar,{mover:r}),this.focusNode.removeAttribute("aria-valuemin"),this.focusNode.removeAttribute("aria-valuemax"),this.focusNode.removeAttribute("aria-valuenow")},destroy:function(){this.inherited(arguments),this._movableMax.destroy(),this._movableBar.destroy()},_onKeyPress:function(e){if(!(this.disabled||this.readOnly||e.altKey||e.ctrlKey)){var i=e.target===this.sliderHandleMax,r=e.target===this.progressBar,n=t.delegate(l,this.isLeftToRight()?{PREV_ARROW:l.LEFT_ARROW,NEXT_ARROW:l.RIGHT_ARROW}:{PREV_ARROW:l.RIGHT_ARROW,NEXT_ARROW:l.LEFT_ARROW}),o=0,s=!1;switch(e.keyCode){case n.HOME:return this._setValueAttr(this.minimum,!0,i),void a.stop(e);case n.END:return this._setValueAttr(this.maximum,!0,i),void a.stop(e);case n.PREV_ARROW:case n.DOWN_ARROW:s=!0;case n.NEXT_ARROW:case n.UP_ARROW:o=1;break;case n.PAGE_DOWN:s=!0;case n.PAGE_UP:o=this.pageIncrement;break;default:return void this.inherited(arguments)}s&&(o=-o),o&&(r?this._bumpValue([{change:o,useMaxValue:!1},{change:o,useMaxValue:!0}]):this._bumpValue(o,i),a.stop(e))}},_onHandleClickMax:function(e){this.disabled||this.readOnly||(n("ie")||h.focus(this.sliderHandleMax),a.stop(e))},_onClkIncBumper:function(){this._setValueAttr(this._descending===!1?this.minimum:this.maximum,!0,!0)},_bumpValue:function(e,i){var r=t.isArray(e)?[this._getBumpValue(e[0].change,e[0].useMaxValue),this._getBumpValue(e[1].change,e[1].useMaxValue)]:this._getBumpValue(e,i);this._setValueAttr(r,!0,i)},_getBumpValue:function(e,t){var i=t?1:0;this._isReversed()&&(i=1-i);var r=o.getComputedStyle(this.sliderBarContainer),a=s.getContentBox(this.sliderBarContainer,r),n=this.discreteValues,l=this.value[i];(1>=n||n==1/0)&&(n=a[this._pixelCount]),n--;var d=this.maximum>this.minimum?(l-this.minimum)*n/(this.maximum-this.minimum)+e:0;return 0>d&&(d=0),d>n&&(d=n),d*(this.maximum-this.minimum)/n+this.minimum},_onBarClick:function(e){this.disabled||this.readOnly||(n("ie")||h.focus(this.progressBar),a.stop(e))},_onRemainingBarClick:function(e){if(!this.disabled&&!this.readOnly){n("ie")||h.focus(this.progressBar);var t=s.position(this.sliderBarContainer,!0),i=s.position(this.progressBar,!0),r=e[this._mousePixelCoord],o=i[this._startingPixelCoord],l=o+i[this._pixelCount],d=this._isReversed()?o>=r:r>=l,u=this._isReversed()?t[this._pixelCount]-r+t[this._startingPixelCoord]:r-t[this._startingPixelCoord];this._setPixelValue(u,t[this._pixelCount],!0,d),a.stop(e)}},_setPixelValue:function(e,t,i,r){if(!this.disabled&&!this.readOnly){var a=this._getValueByPixelValue(e,t);this._setValueAttr(a,i,r)}},_getValueByPixelValue:function(e,t){e=0>e?0:e>t?t:e;var i=this.discreteValues;(1>=i||i==1/0)&&(i=t),i--;var r=t/i,a=Math.round(e/r);return(this.maximum-this.minimum)*a/i+this.minimum},_setValueAttr:function(e,i,r){var a=this.value;t.isArray(e)?a=e:r?this._isReversed()?a[0]=e:a[1]=e:this._isReversed()?a[1]=e:a[0]=e,this._lastValueReported="",this.valueNode.value=this.value=e=a,this.value.sort(this._isReversed()?p:g),this.sliderHandle.setAttribute("aria-valuenow",a[0]),this.sliderHandleMax.setAttribute("aria-valuenow",a[1]),m.prototype._setValueAttr.apply(this,arguments),this._printSliderBar(i,r)},_printSliderBar:function(e,t){var i=this.maximum>this.minimum?(this.value[0]-this.minimum)/(this.maximum-this.minimum):0,a=this.maximum>this.minimum?(this.value[1]-this.minimum)/(this.maximum-this.minimum):0,n=i;i>a&&(i=a,a=n);var o=this._isReversed()?100*(1-i):100*i,s=this._isReversed()?100*(1-a):100*a,l=this._isReversed()?100*(1-a):100*i;if(e&&this.slideDuration>0&&this.progressBar.style[this._progressPixelSize]){var d=(parseFloat(this.progressBar.style[this._handleOffsetCoord]),this.slideDuration/10);if(0===d)return;0>d&&(d=0-d);var u={},c={},m={};u[this._handleOffsetCoord]={start:this.sliderHandle.parentNode.style[this._handleOffsetCoord],end:o,units:"%"},c[this._handleOffsetCoord]={start:this.sliderHandleMax.parentNode.style[this._handleOffsetCoord],end:s,units:"%"},m[this._handleOffsetCoord]={start:this.progressBar.style[this._handleOffsetCoord],end:l,units:"%"},m[this._progressPixelSize]={start:this.progressBar.style[this._progressPixelSize],end:100*(a-i),units:"%"};var h=r.animateProperty({node:this.sliderHandle.parentNode,duration:d,properties:u}),p=r.animateProperty({node:this.sliderHandleMax.parentNode,duration:d,properties:c}),g=r.animateProperty({node:this.progressBar,duration:d,properties:m}),y=f.combine([h,p,g]);y.play()}else this.sliderHandle.parentNode.style[this._handleOffsetCoord]=o+"%",this.sliderHandleMax.parentNode.style[this._handleOffsetCoord]=s+"%",this.progressBar.style[this._handleOffsetCoord]=l+"%",this.progressBar.style[this._progressPixelSize]=100*(a-i)+"%"}}),v=e("dijit.form._SliderMoverMax",u,{onMouseMove:function(e){var i=this.widget,r=i._abspos;r||(r=i._abspos=s.position(i.sliderBarContainer,!0),i._setPixelValue_=t.hitch(i,"_setPixelValue"),i._isReversed_=i._isReversed());var a=e[i._mousePixelCoord]-r[i._startingPixelCoord];i._setPixelValue_(i._isReversed_?r[i._pixelCount]-a:a,r[i._pixelCount],!1,!0)},destroy:function(e){u.prototype.destroy.apply(this,arguments);var t=this.widget;t._abspos=null,t._setValueAttr(t.value,!0)}}),b=e("dijit.form._SliderBarMover",u,{onMouseMove:function(e){var i=this.widget;if(!i.disabled&&!i.readOnly){var r=i._abspos,a=i._bar,n=i._mouseOffset;r||(r=i._abspos=s.position(i.sliderBarContainer,!0),i._setPixelValue_=t.hitch(i,"_setPixelValue"),i._getValueByPixelValue_=t.hitch(i,"_getValueByPixelValue"),i._isReversed_=i._isReversed()),a||(a=i._bar=s.position(i.progressBar,!0)),n||(n=i._mouseOffset=e[i._mousePixelCoord]-a[i._startingPixelCoord]);var o=e[i._mousePixelCoord]-r[i._startingPixelCoord]-n,l=o+a[i._pixelCount];pixelValues=[o,l],pixelValues.sort(g),pixelValues[0]<=0&&(pixelValues[0]=0,pixelValues[1]=a[i._pixelCount]),pixelValues[1]>=r[i._pixelCount]&&(pixelValues[1]=r[i._pixelCount],pixelValues[0]=r[i._pixelCount]-a[i._pixelCount]);var d=[i._getValueByPixelValue(i._isReversed_?r[i._pixelCount]-pixelValues[0]:pixelValues[0],r[i._pixelCount]),i._getValueByPixelValue(i._isReversed_?r[i._pixelCount]-pixelValues[1]:pixelValues[1],r[i._pixelCount])];i._setValueAttr(d,!1,!1)}},destroy:function(){u.prototype.destroy.apply(this,arguments);var e=this.widget;e._abspos=null,e._bar=null,e._mouseOffset=null,e._setValueAttr(e.value,!0)}});return y});//# sourceMappingURL=_RangeSliderMixin.js.map