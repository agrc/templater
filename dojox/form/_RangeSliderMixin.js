//>>built
define("dojox/form/_RangeSliderMixin",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/fx","dojo/_base/event","dojo/_base/sniff","dojo/dom-style","dojo/dom-geometry","dojo/keys","dijit","dojo/dnd/Mover","dojo/dnd/Moveable","dijit/form/_FormValueWidget","dijit/focus","dojo/fx","dojox/fx"],function(e,t,a,i,r,o,n,s,d,l,u,m,h,c,f){var y=function(e,t){return t-e},p=function(e,t){return e-t},g=e("dojox.form._RangeSliderMixin",null,{_setTabIndexAttr:["sliderHandle","sliderHandleMax"],value:[0,100],postMixInProperties:function(){this.inherited(arguments),this.value=a.map(this.value,function(e){return parseInt(e,10)})},postCreate:function(){this.inherited(arguments),this.value.sort(this._isReversed()?y:p);var t=this,a=e(v,{constructor:function(){this.widget=t}});this._movableMax=new m(this.sliderHandleMax,{mover:a}),this.sliderHandle.setAttribute("aria-valuemin",this.minimum),this.sliderHandle.setAttribute("aria-valuemax",this.maximum),this.sliderHandleMax.setAttribute("aria-valuemin",this.minimum),this.sliderHandleMax.setAttribute("aria-valuemax",this.maximum);var i=e(b,{constructor:function(){this.widget=t}});this._movableBar=new m(this.progressBar,{mover:i}),this.focusNode.removeAttribute("aria-valuemin"),this.focusNode.removeAttribute("aria-valuemax"),this.focusNode.removeAttribute("aria-valuenow")},destroy:function(){this.inherited(arguments),this._movableMax.destroy(),this._movableBar.destroy()},_onKeyPress:function(e){if(!(this.disabled||this.readOnly||e.altKey||e.ctrlKey)){var a=e.target===this.sliderHandleMax,i=e.target===this.progressBar,o=t.delegate(d,this.isLeftToRight()?{PREV_ARROW:d.LEFT_ARROW,NEXT_ARROW:d.RIGHT_ARROW}:{PREV_ARROW:d.RIGHT_ARROW,NEXT_ARROW:d.LEFT_ARROW}),n=0,s=!1;switch(e.keyCode){case o.HOME:return this._setValueAttr(this.minimum,!0,a),void r.stop(e);case o.END:return this._setValueAttr(this.maximum,!0,a),void r.stop(e);case o.PREV_ARROW:case o.DOWN_ARROW:s=!0;case o.NEXT_ARROW:case o.UP_ARROW:n=1;break;case o.PAGE_DOWN:s=!0;case o.PAGE_UP:n=this.pageIncrement;break;default:return void this.inherited(arguments)}s&&(n=-n),n&&(i?this._bumpValue([{change:n,useMaxValue:!1},{change:n,useMaxValue:!0}]):this._bumpValue(n,a),r.stop(e))}},_onHandleClickMax:function(e){this.disabled||this.readOnly||(o("ie")||c.focus(this.sliderHandleMax),r.stop(e))},_onClkIncBumper:function(){this._setValueAttr(this._descending===!1?this.minimum:this.maximum,!0,!0)},_bumpValue:function(e,a){var i=t.isArray(e)?[this._getBumpValue(e[0].change,e[0].useMaxValue),this._getBumpValue(e[1].change,e[1].useMaxValue)]:this._getBumpValue(e,a);this._setValueAttr(i,!0,a)},_getBumpValue:function(e,t){var a=t?1:0;this._isReversed()&&(a=1-a);var i=n.getComputedStyle(this.sliderBarContainer),r=s.getContentBox(this.sliderBarContainer,i),o=this.discreteValues,d=this.value[a];(1>=o||o==1/0)&&(o=r[this._pixelCount]),o--;var l=this.maximum>this.minimum?(d-this.minimum)*o/(this.maximum-this.minimum)+e:0;return 0>l&&(l=0),l>o&&(l=o),l*(this.maximum-this.minimum)/o+this.minimum},_onBarClick:function(e){this.disabled||this.readOnly||(o("ie")||c.focus(this.progressBar),r.stop(e))},_onRemainingBarClick:function(e){if(!this.disabled&&!this.readOnly){o("ie")||c.focus(this.progressBar);var t=s.position(this.sliderBarContainer,!0),a=s.position(this.progressBar,!0),i=e[this._mousePixelCoord],n=a[this._startingPixelCoord],d=n+a[this._pixelCount],l=this._isReversed()?n>=i:i>=d,u=this._isReversed()?t[this._pixelCount]-i+t[this._startingPixelCoord]:i-t[this._startingPixelCoord];this._setPixelValue(u,t[this._pixelCount],!0,l),r.stop(e)}},_setPixelValue:function(e,t,a,i){if(!this.disabled&&!this.readOnly){var r=this._getValueByPixelValue(e,t);this._setValueAttr(r,a,i)}},_getValueByPixelValue:function(e,t){e=0>e?0:e>t?t:e;var a=this.discreteValues;(1>=a||a==1/0)&&(a=t),a--;var i=t/a,r=Math.round(e/i);return(this.maximum-this.minimum)*r/a+this.minimum},_setValueAttr:function(e,a,i){var r=this.value;t.isArray(e)?r=e:i?this._isReversed()?r[0]=e:r[1]=e:this._isReversed()?r[1]=e:r[0]=e,this._lastValueReported="",this.valueNode.value=this.value=e=r,this.value.sort(this._isReversed()?y:p),this.sliderHandle.setAttribute("aria-valuenow",r[0]),this.sliderHandleMax.setAttribute("aria-valuenow",r[1]),h.prototype._setValueAttr.apply(this,arguments),this._printSliderBar(a,i)},_printSliderBar:function(e,t){var a=this.maximum>this.minimum?(this.value[0]-this.minimum)/(this.maximum-this.minimum):0,r=this.maximum>this.minimum?(this.value[1]-this.minimum)/(this.maximum-this.minimum):0,o=a;a>r&&(a=r,r=o);var n=this._isReversed()?100*(1-a):100*a,s=this._isReversed()?100*(1-r):100*r,d=this._isReversed()?100*(1-r):100*a;if(e&&this.slideDuration>0&&this.progressBar.style[this._progressPixelSize]){var l=(parseFloat(this.progressBar.style[this._handleOffsetCoord]),this.slideDuration/10);if(0===l)return;0>l&&(l=0-l);var u={},m={},h={};u[this._handleOffsetCoord]={start:this.sliderHandle.parentNode.style[this._handleOffsetCoord],end:n,units:"%"},m[this._handleOffsetCoord]={start:this.sliderHandleMax.parentNode.style[this._handleOffsetCoord],end:s,units:"%"},h[this._handleOffsetCoord]={start:this.progressBar.style[this._handleOffsetCoord],end:d,units:"%"},h[this._progressPixelSize]={start:this.progressBar.style[this._progressPixelSize],end:100*(r-a),units:"%"};var c=i.animateProperty({node:this.sliderHandle.parentNode,duration:l,properties:u}),y=i.animateProperty({node:this.sliderHandleMax.parentNode,duration:l,properties:m}),p=i.animateProperty({node:this.progressBar,duration:l,properties:h}),g=f.combine([c,y,p]);g.play()}else this.sliderHandle.parentNode.style[this._handleOffsetCoord]=n+"%",this.sliderHandleMax.parentNode.style[this._handleOffsetCoord]=s+"%",this.progressBar.style[this._handleOffsetCoord]=d+"%",this.progressBar.style[this._progressPixelSize]=100*(r-a)+"%"}}),v=e("dijit.form._SliderMoverMax",u,{onMouseMove:function(e){var a=this.widget,i=a._abspos;i||(i=a._abspos=s.position(a.sliderBarContainer,!0),a._setPixelValue_=t.hitch(a,"_setPixelValue"),a._isReversed_=a._isReversed());var r=e[a._mousePixelCoord]-i[a._startingPixelCoord];a._setPixelValue_(a._isReversed_?i[a._pixelCount]-r:r,i[a._pixelCount],!1,!0)},destroy:function(e){u.prototype.destroy.apply(this,arguments);var t=this.widget;t._abspos=null,t._setValueAttr(t.value,!0)}}),b=e("dijit.form._SliderBarMover",u,{onMouseMove:function(e){var a=this.widget;if(!a.disabled&&!a.readOnly){var i=a._abspos,r=a._bar,o=a._mouseOffset;i||(i=a._abspos=s.position(a.sliderBarContainer,!0),a._setPixelValue_=t.hitch(a,"_setPixelValue"),a._getValueByPixelValue_=t.hitch(a,"_getValueByPixelValue"),a._isReversed_=a._isReversed()),r||(r=a._bar=s.position(a.progressBar,!0)),o||(o=a._mouseOffset=e[a._mousePixelCoord]-r[a._startingPixelCoord]);var n=e[a._mousePixelCoord]-i[a._startingPixelCoord]-o,d=n+r[a._pixelCount];pixelValues=[n,d],pixelValues.sort(p),pixelValues[0]<=0&&(pixelValues[0]=0,pixelValues[1]=r[a._pixelCount]),pixelValues[1]>=i[a._pixelCount]&&(pixelValues[1]=i[a._pixelCount],pixelValues[0]=i[a._pixelCount]-r[a._pixelCount]);var l=[a._getValueByPixelValue(a._isReversed_?i[a._pixelCount]-pixelValues[0]:pixelValues[0],i[a._pixelCount]),a._getValueByPixelValue(a._isReversed_?i[a._pixelCount]-pixelValues[1]:pixelValues[1],i[a._pixelCount])];a._setValueAttr(l,!1,!1)}},destroy:function(){u.prototype.destroy.apply(this,arguments);var e=this.widget;e._abspos=null,e._bar=null,e._mouseOffset=null,e._setValueAttr(e.value,!0)}});return g});//# sourceMappingURL=_RangeSliderMixin.js.map