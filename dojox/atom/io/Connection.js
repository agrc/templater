//>>built
define("dojox/atom/io/Connection",["dojo/_base/declare","dojo/_base/kernel","dojo/_base/xhr","./model"],function(e,t,i,a){return e("dojox.atom.io.Connection",null,{constructor:function(e,t){this.sync=e,this.preventCache=t},preventCache:!1,alertsEnabled:!1,getFeed:function(e,t,i,r){this._getXmlDoc(e,"feed",new a.Feed,a._Constants.ATOM_NS,t,i,r)},getService:function(e,t,i,r){this._getXmlDoc(e,"service",new a.Service(e),a._Constants.APP_NS,t,i,r)},getEntry:function(e,t,i,r){this._getXmlDoc(e,"entry",new a.Entry,a._Constants.ATOM_NS,t,i,r)},_getXmlDoc:function(e,a,r,n,o,s,d){d||(d=t.global);var l=this.alertsEnabled,u={url:e,handleAs:"xml",sync:this.sync,preventCache:this.preventCache,load:function(e,t){var i,s=null,u=e;if(u){if(void 0!==u.getElementsByTagNameNS)i=u.getElementsByTagNameNS(n,a),i&&i.length>0?s=i.item(0):u.lastChild&&(s=u.lastChild);else if(void 0!==u.getElementsByTagName)if((i=u.getElementsByTagName(a))&&i.length>0){for(var c=0;c<i.length;c++)if(i[c].namespaceURI==n){s=i[c];break}}else u.lastChild&&(s=u.lastChild);else{if(!u.lastChild)return void o.call(d,null,null,t);s=u.lastChild}if(r.buildFromDom(s),o)o.call(d,r,u,t);else if(l)throw new Error("The callback value does not exist.")}else o.call(d,null,null,t)}};this.user&&null!==this.user&&(u.user=this.user),this.password&&null!==this.password&&(u.password=this.password),u.error=s?function(e,t){s.call(d,e,t)}:function(){throw new Error("The URL requested cannot be accessed")},i.get(u)},updateEntry:function(e,a,r,n,o,s){s||(s=t.global),e.updated=new Date;var d=e.getEditHref();if(!d)throw new Error("A URL has not been specified for editing this entry.");var l=this,u=this.alertsEnabled,c={url:d,handleAs:"text",contentType:"text/xml",sync:this.sync,preventCache:this.preventCache,load:function(t,i){var r=null;if(n){r=i.xhr.getResponseHeader("Location"),r||(r=d);var o=function(e,t,i){if(a)a.call(s,e,r,i);else if(u)throw new Error("The callback value does not exist.")};l.getEntry(r,o)}else if(a)a.call(s,e,i.xhr.getResponseHeader("Location"),i);else if(u)throw new Error("The callback value does not exist.");return t}};if(this.user&&null!==this.user&&(c.user=this.user),this.password&&null!==this.password&&(c.password=this.password),c.error=r?function(e,t){r.call(s,e,t)}:function(){throw new Error("The URL requested cannot be accessed")},o)c.postData=e.toString(!0),c.headers={"X-Method-Override":"PUT"},i.post(c);else{c.putData=e.toString(!0);i.put(c)}},addEntry:function(e,a,r,n,o,s){s||(s=t.global),e.published=new Date,e.updated=new Date;var d=e.feedUrl,l=this.alertsEnabled;if(!a&&d&&(a=d),a){var u=this,c={url:a,handleAs:"text",contentType:"text/xml",sync:this.sync,preventCache:this.preventCache,postData:e.toString(!0),load:function(t,i){var n=i.xhr.getResponseHeader("Location");if(n||(n=a),i.retrieveEntry){var o=function(e,t,i){if(r)r.call(s,e,n,i);else if(l)throw new Error("The callback value does not exist.")};u.getEntry(n,o)}else if(r)r.call(s,e,n,i);else if(l)throw new Error("The callback value does not exist.");return t}};this.user&&null!==this.user&&(c.user=this.user),this.password&&null!==this.password&&(c.password=this.password),c.error=n?function(e,t){n.call(s,e,t)}:function(){throw new Error("The URL requested cannot be accessed")},i.post(c)}else if(l)throw new Error("The request cannot be processed because the URL parameter is missing.")},deleteEntry:function(e,a,r,n,o){o||(o=t.global);var s=null;if(!(s="string"==typeof e?e:e.getEditHref()))throw a.call(o,!1,null),new Error("The request cannot be processed because the URL parameter is missing.");var d={url:s,handleAs:"text",sync:this.sync,preventCache:this.preventCache,load:function(e,t){return a.call(o,t),e}};this.user&&null!==this.user&&(d.user=this.user),this.password&&null!==this.password&&(d.password=this.password),d.error=r?function(e,t){r.call(o,e,t)}:function(){throw new Error("The URL requested cannot be accessed")},n?(d.headers={"X-Method-Override":"DELETE"},dhxr.post(d)):i.del(d)}})});//# sourceMappingURL=Connection.js.map