//>>built
define("dojox/gesture/Base",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom","dojo/on","dojo/touch","dojo/has","../main"],function(e,t,a,i,n,r,o,s,l){return e.experimental("dojox.gesture.Base"),i.getObject("gesture",!0,l),t(null,{defaultEvent:" ",subEvents:[],touchOnly:!1,_elements:null,constructor:function(e){i.mixin(this,e),this.init()},init:function(){if(this._elements=[],s("touch")||!this.touchOnly){var e=this.defaultEvent;this.call=this._handle(e),this._events=[e],a.forEach(this.subEvents,function(t){this[t]=this._handle(e+"."+t),this._events.push(e+"."+t)},this)}},_handle:function(e){var t=this;return function(a,i){var n=arguments;n.length>2&&(a=n[1],i=n[2]);var o=a&&(a.nodeType||a.attachEvent||a.addEventListener);if(o){var s=t._add(a,e,i),l={remove:function(){s.remove(),t._remove(a,e)}};return l}return r(a,e,i)}},_add:function(e,t,a){var n=this._getGestureElement(e);if(!n){n={target:e,data:{},handles:{}};var s=i.hitch(this,"_process",n,"press"),l=i.hitch(this,"_process",n,"move"),d=i.hitch(this,"_process",n,"release"),c=i.hitch(this,"_process",n,"cancel"),m=n.handles;this.touchOnly?(m.press=r(e,"touchstart",s),m.move=r(e,"touchmove",l),m.release=r(e,"touchend",d),m.cancel=r(e,"touchcancel",c)):(m.press=o.press(e,s),m.move=o.move(e,l),m.release=o.release(e,d),m.cancel=o.cancel(e,c)),this._elements.push(n)}return n.handles[t]=n.handles[t]?++n.handles[t]:1,r(e,t,a)},_getGestureElement:function(e){for(var t,a=0;a<this._elements.length;a++)if(t=this._elements[a],t.target===e)return t},_process:function(e,t,a){a._locking=a._locking||{},a._locking[this.defaultEvent]||this.isLocked(a.currentTarget)||("INPUT"==a.target.tagName&&"radio"!=a.target.type&&"checkbox"!=a.target.type||"TEXTAREA"==a.target.tagName||a.preventDefault(),a._locking[this.defaultEvent]=!0,this[t](e.data,a))},press:function(e,t){},move:function(e,t){},release:function(e,t){},cancel:function(e,t){},fire:function(e,t){e&&t&&(t.bubbles=!0,t.cancelable=!0,r.emit(e,t.type,t))},_remove:function(e,t){var i=this._getGestureElement(e);if(i&&i.handles){i.handles[t]--;var n=i.handles;if(!a.some(this._events,function(e){return n[e]>0})){this._cleanHandles(n);var r=a.indexOf(this._elements,i);r>=0&&this._elements.splice(r,1)}}},_cleanHandles:function(e){for(var t in e)e[t].remove&&e[t].remove(),delete e[t]},lock:function(e){this._lock=e},unLock:function(){this._lock=null},isLocked:function(e){return this._lock&&e?this._lock!==e&&n.isDescendant(e,this._lock):!1},destroy:function(){a.forEach(this._elements,function(e){this._cleanHandles(e.handles)},this),this._elements=null}})});//# sourceMappingURL=Base.js.map