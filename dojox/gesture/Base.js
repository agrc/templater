//>>built
define("dojox/gesture/Base",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom","dojo/on","dojo/touch","dojo/has","../main"],function(e,t,a,i,r,o,n,d,s){return e.experimental("dojox.gesture.Base"),i.getObject("gesture",!0,s),t(null,{defaultEvent:" ",subEvents:[],touchOnly:!1,_elements:null,constructor:function(e){i.mixin(this,e),this.init()},init:function(){if(this._elements=[],d("touch")||!this.touchOnly){var e=this.defaultEvent;this.call=this._handle(e),this._events=[e],a.forEach(this.subEvents,function(t){this[t]=this._handle(e+"."+t),this._events.push(e+"."+t)},this)}},_handle:function(e){var t=this;return function(a,i){var r=arguments;if(r.length>2&&(a=r[1],i=r[2]),a&&(a.nodeType||a.attachEvent||a.addEventListener)){var n=t._add(a,e,i);return{remove:function(){n.remove(),t._remove(a,e)}}}return o(a,e,i)}},_add:function(e,t,a){var r=this._getGestureElement(e);if(!r){r={target:e,data:{},handles:{}};var d=i.hitch(this,"_process",r,"press"),s=i.hitch(this,"_process",r,"move"),l=i.hitch(this,"_process",r,"release"),m=i.hitch(this,"_process",r,"cancel"),u=r.handles;this.touchOnly?(u.press=o(e,"touchstart",d),u.move=o(e,"touchmove",s),u.release=o(e,"touchend",l),u.cancel=o(e,"touchcancel",m)):(u.press=n.press(e,d),u.move=n.move(e,s),u.release=n.release(e,l),u.cancel=n.cancel(e,m)),this._elements.push(r)}return r.handles[t]=r.handles[t]?++r.handles[t]:1,o(e,t,a)},_getGestureElement:function(e){for(var t,a=0;a<this._elements.length;a++)if(t=this._elements[a],t.target===e)return t},_process:function(e,t,a){a._locking=a._locking||{},a._locking[this.defaultEvent]||this.isLocked(a.currentTarget)||("INPUT"==a.target.tagName&&"radio"!=a.target.type&&"checkbox"!=a.target.type||"TEXTAREA"==a.target.tagName||a.preventDefault(),a._locking[this.defaultEvent]=!0,this[t](e.data,a))},press:function(e,t){},move:function(e,t){},release:function(e,t){},cancel:function(e,t){},fire:function(e,t){e&&t&&(t.bubbles=!0,t.cancelable=!0,o.emit(e,t.type,t))},_remove:function(e,t){var i=this._getGestureElement(e);if(i&&i.handles){i.handles[t]--;var r=i.handles;if(!a.some(this._events,function(e){return r[e]>0})){this._cleanHandles(r);var o=a.indexOf(this._elements,i);o>=0&&this._elements.splice(o,1)}}},_cleanHandles:function(e){for(var t in e)e[t].remove&&e[t].remove(),delete e[t]},lock:function(e){this._lock=e},unLock:function(){this._lock=null},isLocked:function(e){return!(!this._lock||!e)&&(this._lock!==e&&r.isDescendant(e,this._lock))},destroy:function(){a.forEach(this._elements,function(e){this._cleanHandles(e.handles)},this),this._elements=null}})});//# sourceMappingURL=Base.js.map