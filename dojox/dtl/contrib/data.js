//>>built
define("dojox/dtl/contrib/data",["dojo/_base/kernel","dojo/_base/lang","../_base","dojo/_base/array"],function(e,t,a,i){var r=t.getObject("contrib.data",!0,a),o=!0;return r._BoundItem=t.extend(function(e,t){this.item=e,this.store=t},{get:function(a){var n=this.store,d=this.item;if("getLabel"==a)return n.getLabel(d);if("getAttributes"==a)return n.getAttributes(d);if("getIdentity"==a)return n.getIdentity?n.getIdentity(d):"Store has no identity API";if(n.hasAttribute(d,a)||("s"==a.slice(-1)&&(o&&(o=!1,e.deprecated("You no longer need an extra s to call getValues, it can be figured out automatically")),a=a.slice(0,-1)),n.hasAttribute(d,a))){var s=n.getValues(d,a);if(s)return t.isArray(s)?(s=i.map(s,function(e){return t.isObject(e)&&n.isItem(e)?new r._BoundItem(e,n):e}),s.get=r._get,s):new r._BoundItem(s,n)}}}),r._BoundItem.prototype.get.safe=!0,r.BindDataNode=t.extend(function(e,t,i,r){this.items=e&&new a._Filter(e),this.query=t&&new a._Filter(t),this.store=new a._Filter(i),this.alias=r},{render:function(e,t){var a=this.items&&this.items.resolve(e),i=this.query&&this.query.resolve(e),o=this.store.resolve(e);if(!o||!o.getFeatures)throw new Error("data_bind didn't receive a store");if(i){var n=!1;if(o.fetch({query:i,sync:!0,scope:this,onComplete:function(e){n=!0,a=e}}),!n)throw new Error("The bind_data tag only works with a query if the store executed synchronously")}var d=[];if(a)for(var s,l=0;s=a[l];l++)d.push(new r._BoundItem(s,o));return e[this.alias]=d,t},unrender:function(e,t){return t},clone:function(){return this}}),t.mixin(r,{_get:function(e){if(this.length)return this[0]instanceof r._BoundItem?this[0].get(e):this[0][e]},bind_data:function(e,t){var a=t.contents.split();if("to"!=a[2]||"as"!=a[4]||!a[5])throw new Error("data_bind expects the format: 'data_bind items to store as varName'");return new r.BindDataNode(a[1],null,a[3],a[5])},bind_query:function(e,t){var a=t.contents.split();if("to"!=a[2]||"as"!=a[4]||!a[5])throw new Error("data_bind expects the format: 'bind_query query to store as varName'");return new r.BindDataNode(null,a[1],a[3],a[5])}}),r._get.safe=!0,a.register.tags("dojox.dtl.contrib",{data:["bind_data","bind_query"]}),r});//# sourceMappingURL=data.js.map