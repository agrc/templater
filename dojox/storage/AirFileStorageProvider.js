//>>built
define("dojox/storage/AirFileStorageProvider",["dojo","dijit","dojox","dojo/require!dojox/storage/manager,dojox/storage/Provider"],function(e,t,i){e.provide("dojox.storage.AirFileStorageProvider"),e.require("dojox.storage.manager"),e.require("dojox.storage.Provider"),e.isAIR&&!function(){if(!t)var t={};t.File=window.runtime.flash.filesystem.File,t.FileStream=window.runtime.flash.filesystem.FileStream,t.FileMode=window.runtime.flash.filesystem.FileMode,e.declare("dojox.storage.AirFileStorageProvider",[i.storage.Provider],{initialized:!1,_storagePath:"__DOJO_STORAGE/",initialize:function(){this.initialized=!1;try{var e=t.File.applicationStorageDirectory.resolvePath(this._storagePath);e.exists||e.createDirectory(),this.initialized=!0}catch(o){}i.storage.manager.loaded()},isAvailable:function(){return!0},put:function(e,i,o,r){if(0==this.isValidKey(e))throw new Error("Invalid key given: "+e);if(r=r||this.DEFAULT_NAMESPACE,0==this.isValidKey(r))throw new Error("Invalid namespace given: "+r);try{this.remove(e,r);var n=t.File.applicationStorageDirectory.resolvePath(this._storagePath+r);n.exists||n.createDirectory();var a=n.resolvePath(e),s=new t.FileStream;s.open(a,t.FileMode.WRITE),s.writeObject(i),s.close()}catch(d){return void o(this.FAILED,e,d.toString(),r)}o&&o(this.SUCCESS,e,null,r)},get:function(e,i){if(0==this.isValidKey(e))throw new Error("Invalid key given: "+e);i=i||this.DEFAULT_NAMESPACE;var o=null,r=t.File.applicationStorageDirectory.resolvePath(this._storagePath+i+"/"+e);if(r.exists&&!r.isDirectory){var n=new t.FileStream;n.open(r,t.FileMode.READ),o=n.readObject(),n.close()}return o},getNamespaces:function(){var e,i=[this.DEFAULT_NAMESPACE],o=t.File.applicationStorageDirectory.resolvePath(this._storagePath),r=o.getDirectoryListing();for(e=0;e<r.length;e++)r[e].isDirectory&&r[e].name!=this.DEFAULT_NAMESPACE&&i.push(r[e].name);return i},getKeys:function(e){if(e=e||this.DEFAULT_NAMESPACE,0==this.isValidKey(e))throw new Error("Invalid namespace given: "+e);var i=[],o=t.File.applicationStorageDirectory.resolvePath(this._storagePath+e);if(o.exists&&o.isDirectory){var r,n=o.getDirectoryListing();for(r=0;r<n.length;r++)i.push(n[r].name)}return i},clear:function(e){if(0==this.isValidKey(e))throw new Error("Invalid namespace given: "+e);var i=t.File.applicationStorageDirectory.resolvePath(this._storagePath+e);i.exists&&i.isDirectory&&i.deleteDirectory(!0)},remove:function(e,i){i=i||this.DEFAULT_NAMESPACE;var o=t.File.applicationStorageDirectory.resolvePath(this._storagePath+i+"/"+e);o.exists&&!o.isDirectory&&o.deleteFile()},putMultiple:function(e,t,i,o){if(this.isValidKeyArray(e)===!1||!t instanceof Array||e.length!=t.length)throw new Error("Invalid arguments: keys = ["+e+"], values = ["+t+"]");if(null!=o&&"undefined"!=typeof o||(o=this.DEFAULT_NAMESPACE),0==this.isValidKey(o))throw new Error("Invalid namespace given: "+o);this._statusHandler=i;try{for(var r=0;r<e.length;r++)this.put(e[r],t[r],null,o)}catch(n){return void(i&&i(this.FAILED,e,n.toString(),o))}i&&i(this.SUCCESS,e,null,o)},getMultiple:function(e,t){if(this.isValidKeyArray(e)===!1)throw new Error("Invalid key array given: "+e);if(null!=t&&"undefined"!=typeof t||(t=this.DEFAULT_NAMESPACE),0==this.isValidKey(t))throw new Error("Invalid namespace given: "+t);for(var i=[],o=0;o<e.length;o++)i[o]=this.get(e[o],t);return i},removeMultiple:function(e,t){t=t||this.DEFAULT_NAMESPACE;for(var i=0;i<e.length;i++)this.remove(e[i],t)},isPermanent:function(){return!0},getMaximumSize:function(){return this.SIZE_NO_LIMIT},hasSettingsUI:function(){return!1},showSettingsUI:function(){throw new Error(this.declaredClass+" does not support a storage settings user-interface")},hideSettingsUI:function(){throw new Error(this.declaredClass+" does not support a storage settings user-interface")}}),i.storage.manager.register("dojox.storage.AirFileStorageProvider",new i.storage.AirFileStorageProvider),i.storage.manager.initialize()}()});//# sourceMappingURL=AirFileStorageProvider.js.map