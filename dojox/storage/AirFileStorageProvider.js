//>>built
define("dojox/storage/AirFileStorageProvider",["dojo","dijit","dojox","dojo/require!dojox/storage/manager,dojox/storage/Provider"],function(e,t,i){e.provide("dojox.storage.AirFileStorageProvider"),e.require("dojox.storage.manager"),e.require("dojox.storage.Provider"),e.isAIR&&!function(){if(!t)var t={};t.File=window.runtime.flash.filesystem.File,t.FileStream=window.runtime.flash.filesystem.FileStream,t.FileMode=window.runtime.flash.filesystem.FileMode,e.declare("dojox.storage.AirFileStorageProvider",[i.storage.Provider],{initialized:!1,_storagePath:"__DOJO_STORAGE/",initialize:function(){this.initialized=!1;try{var e=t.File.applicationStorageDirectory.resolvePath(this._storagePath);e.exists||e.createDirectory(),this.initialized=!0}catch(a){}i.storage.manager.loaded()},isAvailable:function(){return!0},put:function(e,i,a,o){if(0==this.isValidKey(e))throw new Error("Invalid key given: "+e);if(o=o||this.DEFAULT_NAMESPACE,0==this.isValidKey(o))throw new Error("Invalid namespace given: "+o);try{this.remove(e,o);var r=t.File.applicationStorageDirectory.resolvePath(this._storagePath+o);r.exists||r.createDirectory();var n=r.resolvePath(e),s=new t.FileStream;s.open(n,t.FileMode.WRITE),s.writeObject(i),s.close()}catch(l){return void a(this.FAILED,e,l.toString(),o)}a&&a(this.SUCCESS,e,null,o)},get:function(e,i){if(0==this.isValidKey(e))throw new Error("Invalid key given: "+e);i=i||this.DEFAULT_NAMESPACE;var a=null,o=t.File.applicationStorageDirectory.resolvePath(this._storagePath+i+"/"+e);if(o.exists&&!o.isDirectory){var r=new t.FileStream;r.open(o,t.FileMode.READ),a=r.readObject(),r.close()}return a},getNamespaces:function(){var e,i=[this.DEFAULT_NAMESPACE],a=t.File.applicationStorageDirectory.resolvePath(this._storagePath),o=a.getDirectoryListing();for(e=0;e<o.length;e++)o[e].isDirectory&&o[e].name!=this.DEFAULT_NAMESPACE&&i.push(o[e].name);return i},getKeys:function(e){if(e=e||this.DEFAULT_NAMESPACE,0==this.isValidKey(e))throw new Error("Invalid namespace given: "+e);var i=[],a=t.File.applicationStorageDirectory.resolvePath(this._storagePath+e);if(a.exists&&a.isDirectory){var o,r=a.getDirectoryListing();for(o=0;o<r.length;o++)i.push(r[o].name)}return i},clear:function(e){if(0==this.isValidKey(e))throw new Error("Invalid namespace given: "+e);var i=t.File.applicationStorageDirectory.resolvePath(this._storagePath+e);i.exists&&i.isDirectory&&i.deleteDirectory(!0)},remove:function(e,i){i=i||this.DEFAULT_NAMESPACE;var a=t.File.applicationStorageDirectory.resolvePath(this._storagePath+i+"/"+e);a.exists&&!a.isDirectory&&a.deleteFile()},putMultiple:function(e,t,i,a){if(this.isValidKeyArray(e)===!1||!t instanceof Array||e.length!=t.length)throw new Error("Invalid arguments: keys = ["+e+"], values = ["+t+"]");if(null!=a&&"undefined"!=typeof a||(a=this.DEFAULT_NAMESPACE),0==this.isValidKey(a))throw new Error("Invalid namespace given: "+a);this._statusHandler=i;try{for(var o=0;o<e.length;o++)this.put(e[o],t[o],null,a)}catch(r){return void(i&&i(this.FAILED,e,r.toString(),a))}i&&i(this.SUCCESS,e,null,a)},getMultiple:function(e,t){if(this.isValidKeyArray(e)===!1)throw new Error("Invalid key array given: "+e);if(null!=t&&"undefined"!=typeof t||(t=this.DEFAULT_NAMESPACE),0==this.isValidKey(t))throw new Error("Invalid namespace given: "+t);for(var i=[],a=0;a<e.length;a++)i[a]=this.get(e[a],t);return i},removeMultiple:function(e,t){t=t||this.DEFAULT_NAMESPACE;for(var i=0;i<e.length;i++)this.remove(e[i],t)},isPermanent:function(){return!0},getMaximumSize:function(){return this.SIZE_NO_LIMIT},hasSettingsUI:function(){return!1},showSettingsUI:function(){throw new Error(this.declaredClass+" does not support a storage settings user-interface")},hideSettingsUI:function(){throw new Error(this.declaredClass+" does not support a storage settings user-interface")}}),i.storage.manager.register("dojox.storage.AirFileStorageProvider",new i.storage.AirFileStorageProvider),i.storage.manager.initialize()}()});//# sourceMappingURL=AirFileStorageProvider.js.map