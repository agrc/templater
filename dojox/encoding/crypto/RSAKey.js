//>>built
define("dojox/encoding/crypto/RSAKey",["dojo/_base/kernel","dojo/_base/declare","../../math/BigInteger","../../math/random/Simple"],function(e,t,a,i){function r(e,t,i){if(t<e.length+11)throw new Error("Message too long for RSA");for(var r=new Array(t),n=e.length;n&&t;)r[--t]=e.charCodeAt(--n);r[--t]=0;for(var o=i(),s=[0];t>2;){for(s[0]=0;0==s[0];)o.nextBytes(s);r[--t]=s[0]}return r[--t]=2,r[--t]=0,o.destroy(),new a(r)}e.experimental("dojox.encoding.crypto.RSAKey");var n=function(){return new i};return t("dojox.encoding.crypto.RSAKey",null,{constructor:function(e){this.rngf=e||n,this.e=0,this.n=this.d=this.p=this.q=this.dmp1=this.dmq1=this.coeff=null},setPublic:function(e,t){if(!(e&&t&&e.length&&t.length))throw new Error("Invalid RSA public key");this.n=new a(e,16),this.e=parseInt(t,16)},encrypt:function(e){var t=r(e,this.n.bitLength()+7>>3,this.rngf);if(!t)return null;var a=t.modPowInt(this.e,this.n);if(!a)return null;var i=a.toString(16);return i.length%2?"0"+i:i}})});//# sourceMappingURL=RSAKey.js.map