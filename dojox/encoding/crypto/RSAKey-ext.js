//>>built
define("dojox/encoding/crypto/RSAKey-ext",["dojo/_base/kernel","dojo/_base/lang","./RSAKey","../../math/BigInteger-ext"],function(e,t,i,a){function r(e,t){for(var i=e.toByteArray(),a=0,r=i.length;r>a&&!i[a];++a);if(i.length-a!==t-1||2!==i[a])return null;for(++a;i[a];)if(++a>=r)return null;for(var n="";++a<r;)n+=String.fromCharCode(i[a]);return n}return e.experimental("dojox.encoding.crypto.RSAKey-ext"),t.extend(i,{setPrivate:function(e,t,i){if(!(e&&t&&e.length&&t.length))throw new Error("Invalid RSA private key");this.n=new a(e,16),this.e=parseInt(t,16),this.d=new a(i,16)},setPrivateEx:function(e,t,i,r,n,o,s,d){if(!(e&&t&&e.length&&t.length))throw new Error("Invalid RSA private key");this.n=new a(e,16),this.e=parseInt(t,16),this.d=new a(i,16),this.p=new a(r,16),this.q=new a(n,16),this.dmp1=new a(o,16),this.dmq1=new a(s,16),this.coeff=new a(d,16)},generate:function(e,t){var i=this.rngf(),r=e>>1;this.e=parseInt(t,16);for(var n=new a(t,16);;){for(;this.p=new a(e-r,1,i),this.p.subtract(a.ONE).gcd(n).compareTo(a.ONE)||!this.p.isProbablePrime(10););for(;this.q=new a(r,1,i),this.q.subtract(a.ONE).gcd(n).compareTo(a.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var o=this.p;this.p=this.q,this.q=o}var s=this.p.subtract(a.ONE),d=this.q.subtract(a.ONE),l=s.multiply(d);if(!l.gcd(n).compareTo(a.ONE)){this.n=this.p.multiply(this.q),this.d=n.modInverse(l),this.dmp1=this.d.mod(s),this.dmq1=this.d.mod(d),this.coeff=this.q.modInverse(this.p);break}}i.destroy()},decrypt:function(e){var t,i=new a(e,16);if(this.p&&this.q){for(var n=i.mod(this.p).modPow(this.dmp1,this.p),o=i.mod(this.q).modPow(this.dmq1,this.q);n.compareTo(o)<0;)n=n.add(this.p);t=n.subtract(o).multiply(this.coeff).mod(this.p).multiply(this.q).add(o)}else t=i.modPow(this.d,this.n);return t?r(t,this.n.bitLength()+7>>3):null}}),i});//# sourceMappingURL=RSAKey-ext.js.map