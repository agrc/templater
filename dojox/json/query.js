//>>built
define("dojox/json/query",["dojo/_base/kernel","dojo/_base/lang","dojox","dojo/_base/array"],function(dojo,lang,dojox){return lang.getObject("json",!0,dojox),dojox.json._slice=function(e,t,i,a){var n=e.length,o=[];i=i||n,t=0>t?Math.max(0,t+n):Math.min(n,t),i=0>i?Math.max(0,i+n):Math.min(n,i);for(var r=t;i>r;r+=a)o.push(e[r]);return o},dojox.json._find=function(e,t){function i(e){t&&(t!==!0||e instanceof Array?e[t]&&a.push(e[t]):a.push(e));for(var n in e){var o=e[n];t?o&&"object"==typeof o&&i(o):a.push(o)}}var a=[];if(t instanceof Array){if(1==t.length)return e[t[0]];for(var n=0;n<t.length;n++)a.push(e[t[n]])}else i(e);return a},dojox.json._distinctFilter=function(e,t){for(var i=[],a={},n=0,o=e.length;o>n;++n){var r=e[n];t(r,n,e)&&("object"==typeof r&&r?r.__included||(r.__included=!0,i.push(r)):a[r+typeof r]||(a[r+typeof r]=!0,i.push(r)))}for(n=0,o=i.length;o>n;++n)i[n]&&delete i[n].__included;return i},dojox.json.query=function(query,obj){function call(e){prefix=e+"("+prefix}function makeRegex(e,t,i,a,n,o,r,s){return str[s].match(/[\*\?]/)||"~"==r?"/^"+str[s].substring(1,str[s].length-1).replace(/\\([btnfr\\"'])|([^\w\*\?])/g,"\\$1$2").replace(/([\*\?])/g,"[\\w\\W]$1")+("~"==r?"$/i":"$/")+".test("+t+")":e}var depth=0,str=[];query=query.replace(/"(\\.|[^"\\])*"|'(\\.|[^'\\])*'|[\[\]]/g,function(e){return depth+="["==e?1:"]"==e?-1:0,"]"==e&&depth>0?"`]":'"'==e.charAt(0)||"'"==e.charAt(0)?"`"+(str.push(e)-1):e});var prefix="";query.replace(/(\]|\)|push|pop|shift|splice|sort|reverse)\s*\(/,function(){throw new Error("Unsafe function call")}),query=query.replace(/([^<>=]=)([^=])/g,"$1=$2").replace(/@|(\.\s*)?[a-zA-Z\$_]+(\s*:)?/g,function(e){return"."==e.charAt(0)?e:"@"==e?"$obj":(e.match(/:|^(\$|Math|true|false|null)$/)?"":"$obj.")+e}).replace(/\.?\.?\[(`\]|[^\]])*\]|\?.*|\.\.([\w\$_]+)|\.\*/g,function(e,t,i){var a=e.match(/^\.?\.?(\[\s*\^?\?|\^?\?|\[\s*==)(.*?)\]?$/);if(a){var n="";return e.match(/^\./)&&(call("dojox.json._find"),n=",true)"),call(a[1].match(/\=/)?"dojo.map":a[1].match(/\^/)?"dojox.json._distinctFilter":"dojo.filter"),n+",function($obj){return "+a[2]+"})"}return(a=e.match(/^\[\s*([\/\\].*)\]/))?".concat().sort(function(a,b){"+a[1].replace(/\s*,?\s*([\/\\])\s*([^,\\\/]+)/g,function(e,t,i){return"var av= "+i.replace(/\$obj/,"a")+",bv= "+i.replace(/\$obj/,"b")+";if(av>bv||bv==null){return "+("/"==t?1:-1)+";}\nif(bv>av||av==null){return "+("/"==t?-1:1)+";}\n"})+"return 0;})":(a=e.match(/^\[(-?[0-9]*):(-?[0-9]*):?(-?[0-9]*)\]/),a?(call("dojox.json._slice"),","+(a[1]||0)+","+(a[2]||0)+","+(a[3]||1)+")"):e.match(/^\.\.|\.\*|\[\s*\*\s*\]|,/)?(call("dojox.json._find"),("."==e.charAt(1)?",'"+i+"'":e.match(/,/)?","+e:"")+")"):e)}).replace(/(\$obj\s*((\.\s*[\w_$]+\s*)|(\[\s*`([0-9]+)\s*`\]))*)(==|~)\s*`([0-9]+)/g,makeRegex).replace(/`([0-9]+)\s*(==|~)\s*(\$obj\s*((\.\s*[\w_$]+)|(\[\s*`([0-9]+)\s*`\]))*)/g,function(e,t,i,a,n,o,r,s){return makeRegex(e,a,n,o,r,s,i,t)}),query=prefix+("$"==query.charAt(0)?"":"$")+query.replace(/`([0-9]+|\])/g,function(e,t){return"]"==t?"]":str[t]});for(var executor=eval("1&&function($,$1,$2,$3,$4,$5,$6,$7,$8,$9){var $obj=$;return "+query+"}"),i=0;i<arguments.length-1;i++)arguments[i]=arguments[i+1];return obj?executor.apply(this,arguments):executor}});//# sourceMappingURL=query.js.map