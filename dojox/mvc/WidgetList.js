//>>built
define("dojox/mvc/WidgetList",["require","dojo/_base/array","dojo/_base/lang","dojo/_base/declare","dijit/_Container","dijit/_WidgetBase","./Templated"],function(require,array,lang,declare,_Container,_WidgetBase,Templated){function evalParams(params){return eval("({"+params+"})")}function unwatchElements(e){for(var t=null;t=(e._handles||[]).pop();)t.unwatch()}function flatten(e){var t=[];return array.forEach(e,function(e){[].push.apply(t,e)}),t}function loadModules(e,t){if(this.childClz)t(this.childClz);else if(this.childType){var i=lang.isFunction(this.childType)||lang.isFunction(this.childMixins)?array.map(e,function(e){var t=lang.isFunction(this.childType)?this.childType.call(e,this):this.childType,i=lang.isFunction(this.childMixins)?this.childMixins.call(e,this):this.childMixins;return t?[t].concat(lang.isArray(i)?i:i?i.split(","):[]):["dojox/mvc/Templated"]},this):[[this.childType].concat(this.childMixins&&this.childMixins.split(",")||[])];require(array.filter(array.map(flatten(i),function(e){return lang.getObject(e)?undef:e}),function(e){return e!==undef}),function(){t.apply(this,array.map(i,function(e){var t=array.map(e,function(e){return lang.getObject(e)||require(e)});return t.length>1?declare(t,{}):t[0]}))})}else t(Templated)}var childTypeAttr="data-mvc-child-type",childMixinsAttr="data-mvc-child-mixins",childParamsAttr="data-mvc-child-props",childBindingsAttr="data-mvc-child-bindings",undef,WidgetList=declare("dojox.mvc.WidgetList",[_WidgetBase,_Container],{childClz:null,childType:"",childMixins:"",childParams:null,childBindings:null,children:null,partialRebuild:!1,_relTargetProp:"children",postMixInProperties:function(){this.inherited(arguments),this[childTypeAttr]&&(this.childType=this[childTypeAttr]),this[childMixinsAttr]&&(this.childMixins=this[childMixinsAttr])},startup:function(){this.inherited(arguments),this._setChildrenAttr(this.children)},_setChildrenAttr:function(e){var t=this.children;if(this._set("children",e),this._started&&(!this._builtOnce||t!=e)&&(this._builtOnce=!0,this._buildChildren(e),lang.isArray(e))){var i=this;e.watch!=={}.watch&&(this._handles=this._handles||[]).push(e.watch(function(e,t,a){if(!isNaN(e)){var o=i.getChildren()[e-0];o&&o.set(o._relTargetProp||"target",a)}}))}},_buildChildren:function(e){function t(e){if(!(this._beingDestroyed||this._buildChildrenSeq>n)){var t=[].slice.call(arguments,1);e.clz=lang.isFunction(this.childType)||lang.isFunction(this.childMixins)?t:t[0];for(var i=null;i=s.shift();){if(!i.clz){s.unshift(i);break}for(var a=0,o=(i.removals||[]).length;o>a;++a)this.removeChild(i.idx);array.forEach(array.map(i.adds,function(e,t){var a={ownerDocument:this.ownerDocument,parent:this,indexAtStartup:i.idx+t},o=lang.isArray(i.clz)?i.clz[t]:i.clz;a[(lang.isFunction(this.childParams)&&this.childParams.call(a,this)||this.childParams||this[childParamsAttr]&&evalParams.call(a,this[childParamsAttr])||{})._relTargetProp||o.prototype._relTargetProp||"target"]=e;var n=this.childParams||this[childParamsAttr]&&evalParams.call(a,this[childParamsAttr]),r=this.childBindings||this[childBindingsAttr]&&evalParams.call(a,this[childBindingsAttr]);return!this.templateString||a.templateString||o.prototype.templateString||(a.templateString=this.templateString),!r||a.bindings||o.prototype.bindings||(a.bindings=r),new o(lang.delegate(lang.isFunction(n)?n.call(a,this):n,a))},this),function(e,t){this.addChild(e,i.idx+t)},this)}}}unwatchElements(this);for(var i=this.getChildren(),a=null;a=i.pop();)this.removeChild(a),a.destroy();if(lang.isArray(e)){var o=this,n=this._buildChildrenSeq=(this._buildChildrenSeq||0)+1,r={idx:0,removals:[],adds:[].concat(e)},s=[r];lang.isFunction(e.watchElements)&&(this._handles=this._handles||[]).push(e.watchElements(function(i,a,n){if(a&&n&&o.partialRebuild){var r={idx:i,removals:a,adds:n};s.push(r),loadModules.call(o,n,lang.hitch(o,t,r))}else o._buildChildren(e)})),loadModules.call(this,e,lang.hitch(this,t,r))}},destroy:function(){unwatchElements(this),this.inherited(arguments)}});return WidgetList.prototype[childTypeAttr]=WidgetList.prototype[childMixinsAttr]=WidgetList.prototype[childParamsAttr]=WidgetList.prototype[childBindingsAttr]="",WidgetList});//# sourceMappingURL=WidgetList.js.map