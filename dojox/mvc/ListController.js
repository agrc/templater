//>>built
define("dojox/mvc/ListController",["dojo/_base/array","dojo/_base/lang","dojo/_base/declare","./ModelRefController"],function(e,t,i,o){function r(e){for(var t in{_listModelWatchHandle:1,_tableModelWatchHandle:1})e[t]&&(e[t].unwatch(),e[t]=null)}function n(e,t,i){r(e),i&&t!==i&&(i.watchElements?e._listModelWatchHandle=i.watchElements(function(t,i,o){if(i&&o){var r=e.get("cursorIndex");if(i&&r>=t&&r<t+i.length)return void e.set("cursorIndex",-1);(i.length||o.length)&&r>=t&&e.set(e._refCursorProp,e.get("cursor"))}else e.set(e._refCursorProp,e.get(e._refCursorProp))}):i.set&&i.watch&&(e.get("cursorIndex")<0&&e._set("cursorIndex",""),e._tableModelWatchHandle=i.watch(function(t,i,o){i!==o&&t==e.get("cursorIndex")&&e.set(e._refCursorProp,o)}))),e._setCursorIndexAttr(e.cursorIndex)}function a(i,o,r){var n=i[i._refInModelProp];if(n&&o!==r)if(t.isArray(n)){var a=e.indexOf(n,r);if(0>a){var s=i.get("cursorIndex");s>=0&&s<n.length&&n.set(s,r)}else i.set("cursorIndex",a)}else{for(var l in n)if(n[l]==r)return void i.set("cursorIndex",l);var s=i.get("cursorIndex");s&&n.set(s,r)}}return i("dojox.mvc.ListController",o,{idProperty:"uniqueId",cursorId:null,cursorIndex:-1,cursor:null,model:null,_listModelWatchHandle:null,_tableModelWatchHandle:null,_refCursorProp:"cursor",_refModelProp:"cursor",destroy:function(){r(this),this.inherited(arguments)},set:function(e,t){var i=this[this._refCursorProp],o=this[this._refInModelProp];this.inherited(arguments),e==this._refCursorProp&&a(this,i,t),e==this._refInModelProp&&n(this,o,t)},_setCursorIdAttr:function(e){var i=this.cursorId;this._set("cursorId",e);var o=this[this._refInModelProp];if(o&&i!==e)if(t.isArray(o)){for(var r=0;r<o.length;r++)if(o[r][this.idProperty]==e)return void this.set("cursorIndex",r);this._set("cursorIndex",-1)}else{for(var n in o)if(o[n][this.idProperty]==e)return void this.set("cursorIndex",n);this._set("cursorIndex","")}},_setCursorIndexAttr:function(e){this._set("cursorIndex",e),this[this._refInModelProp]&&(this.set(this._refCursorProp,this[this._refInModelProp][e]),this.set("cursorId",this[this._refInModelProp][e]&&this[this._refInModelProp][e][this.idProperty]))},hasControllerProperty:function(e){return this.inherited(arguments)||e==this._refCursorProp}})});//# sourceMappingURL=ListController.js.map