//>>built
define("dojox/mvc/ListController",["dojo/_base/array","dojo/_base/lang","dojo/_base/declare","./ModelRefController"],function(e,t,i,a){function o(e){for(var t in{_listModelWatchHandle:1,_tableModelWatchHandle:1})e[t]&&(e[t].unwatch(),e[t]=null)}function n(e,t,i){o(e),i&&t!==i&&(i.watchElements?e._listModelWatchHandle=i.watchElements(function(t,i,a){if(i&&a){var o=e.get("cursorIndex");if(i&&o>=t&&o<t+i.length)return void e.set("cursorIndex",-1);(i.length||a.length)&&o>=t&&e.set(e._refCursorProp,e.get("cursor"))}else e.set(e._refCursorProp,e.get(e._refCursorProp))}):i.set&&i.watch&&(e.get("cursorIndex")<0&&e._set("cursorIndex",""),e._tableModelWatchHandle=i.watch(function(t,i,a){i!==a&&t==e.get("cursorIndex")&&e.set(e._refCursorProp,a)}))),e._setCursorIndexAttr(e.cursorIndex)}function r(i,a,o){var n=i[i._refInModelProp];if(n&&a!==o)if(t.isArray(n)){var r=e.indexOf(n,o);if(0>r){var s=i.get("cursorIndex");s>=0&&s<n.length&&n.set(s,o)}else i.set("cursorIndex",r)}else{for(var l in n)if(n[l]==o)return void i.set("cursorIndex",l);var s=i.get("cursorIndex");s&&n.set(s,o)}}return i("dojox.mvc.ListController",a,{idProperty:"uniqueId",cursorId:null,cursorIndex:-1,cursor:null,model:null,_listModelWatchHandle:null,_tableModelWatchHandle:null,_refCursorProp:"cursor",_refModelProp:"cursor",destroy:function(){o(this),this.inherited(arguments)},set:function(e,t){var i=this[this._refCursorProp],a=this[this._refInModelProp];this.inherited(arguments),e==this._refCursorProp&&r(this,i,t),e==this._refInModelProp&&n(this,a,t)},_setCursorIdAttr:function(e){var i=this.cursorId;this._set("cursorId",e);var a=this[this._refInModelProp];if(a&&i!==e)if(t.isArray(a)){for(var o=0;o<a.length;o++)if(a[o][this.idProperty]==e)return void this.set("cursorIndex",o);this._set("cursorIndex",-1)}else{for(var n in a)if(a[n][this.idProperty]==e)return void this.set("cursorIndex",n);this._set("cursorIndex","")}},_setCursorIndexAttr:function(e){this._set("cursorIndex",e),this[this._refInModelProp]&&(this.set(this._refCursorProp,this[this._refInModelProp][e]),this.set("cursorId",this[this._refInModelProp][e]&&this[this._refInModelProp][e][this.idProperty]))},hasControllerProperty:function(e){return this.inherited(arguments)||e==this._refCursorProp}})});//# sourceMappingURL=ListController.js.map