//>>built
define("dojox/mvc/ListController",["dojo/_base/array","dojo/_base/lang","dojo/_base/declare","./ModelRefController"],function(e,t,i,a){function n(e){for(var t in{_listModelWatchHandle:1,_tableModelWatchHandle:1})e[t]&&(e[t].unwatch(),e[t]=null)}function o(e,t,i){n(e),i&&t!==i&&(i.watchElements?e._listModelWatchHandle=i.watchElements(function(t,i,a){if(i&&a){var n=e.get("cursorIndex");if(i&&n>=t&&n<t+i.length)return void e.set("cursorIndex",-1);(i.length||a.length)&&n>=t&&e.set(e._refCursorProp,e.get("cursor"))}else e.set(e._refCursorProp,e.get(e._refCursorProp))}):i.set&&i.watch&&(e.get("cursorIndex")<0&&e._set("cursorIndex",""),e._tableModelWatchHandle=i.watch(function(t,i,a){i!==a&&t==e.get("cursorIndex")&&e.set(e._refCursorProp,a)}))),e._setCursorIndexAttr(e.cursorIndex)}function r(i,a,n){var o=i[i._refInModelProp];if(o&&a!==n)if(t.isArray(o)){var r=e.indexOf(o,n);if(0>r){var s=i.get("cursorIndex");s>=0&&s<o.length&&o.set(s,n)}else i.set("cursorIndex",r)}else{for(var d in o)if(o[d]==n)return void i.set("cursorIndex",d);var s=i.get("cursorIndex");s&&o.set(s,n)}}return i("dojox.mvc.ListController",a,{idProperty:"uniqueId",cursorId:null,cursorIndex:-1,cursor:null,model:null,_listModelWatchHandle:null,_tableModelWatchHandle:null,_refCursorProp:"cursor",_refModelProp:"cursor",destroy:function(){n(this),this.inherited(arguments)},set:function(e,t){var i=this[this._refCursorProp],a=this[this._refInModelProp];this.inherited(arguments),e==this._refCursorProp&&r(this,i,t),e==this._refInModelProp&&o(this,a,t)},_setCursorIdAttr:function(e){var i=this.cursorId;this._set("cursorId",e);var a=this[this._refInModelProp];if(a&&i!==e)if(t.isArray(a)){for(var n=0;n<a.length;n++)if(a[n][this.idProperty]==e)return void this.set("cursorIndex",n);this._set("cursorIndex",-1)}else{for(var o in a)if(a[o][this.idProperty]==e)return void this.set("cursorIndex",o);this._set("cursorIndex","")}},_setCursorIndexAttr:function(e){this._set("cursorIndex",e),this[this._refInModelProp]&&(this.set(this._refCursorProp,this[this._refInModelProp][e]),this.set("cursorId",this[this._refInModelProp][e]&&this[this._refInModelProp][e][this.idProperty]))},hasControllerProperty:function(e){return this.inherited(arguments)||e==this._refCursorProp}})});//# sourceMappingURL=ListController.js.map