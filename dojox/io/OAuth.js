//>>built
define("dojox/io/OAuth",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","dojo/_base/xhr","dojo/dom","dojox/encoding/digests/SHA1"],function(e,t,i,a,r,n){return e.getObject("io.OAuth",!0,dojox),dojox.io.OAuth=new function(){function t(e){for(var t=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],i=/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,a=i.exec(e),r={},n=t.length;n--;)r[t[n]]=a[n]||"";var o=r.protocol.toLowerCase(),s=r.authority.toLowerCase();("http"==o&&80==r.port||"https"==o&&443==r.port)&&s.lastIndexOf(":")>-1&&(s=s.substring(0,s.lastIndexOf(":")));var l=r.path||"/";return r.url=o+"://"+s+l,r}function i(e){for(var t="",i=m.length,a=0;a<e;a++)t+=m.charAt(Math.floor(Math.random()*i));return t}function r(){return Math.floor((new Date).valueOf()/1e3)-2}function o(e,t,i){if(i&&"PLAINTEXT"!=i&&"HMAC-SHA1"!=i)throw new Error("dojox.io.OAuth: the only supported signature encodings are PLAINTEXT and HMAC-SHA1.");return"PLAINTEXT"==i?t:n._hmac(e,t)}function s(e){return c(e.consumer.secret)+"&"+(e.token&&e.token.secret?c(e.token.secret):"")}function l(t,a){var n={oauth_consumer_key:a.consumer.key,oauth_nonce:i(16),oauth_signature_method:a.sig_method||"HMAC-SHA1",oauth_timestamp:r(),oauth_version:"1.0"};a.token&&(n.oauth_token=a.token.key),t.content=e.mixin(t.content||{},n)}function d(i){var a,r=[{}];if(i.form){i.content||(i.content={});var n=e.byId(i.form),o=n.getAttributeNode("action");i.url=i.url||(o?o.value:null),a=e.formToObject(n),delete i.form}a&&r.push(a),i.content&&r.push(i.content);var s=t(i.url);if(s.query){var l=e.queryToObject(s.query);for(var d in l)l[d]=encodeURIComponent(l[d]);r.push(l)}i._url=s.url;for(var u=[],h=0,c=r.length;h<c;h++){var m=r[h];for(var d in m)if(e.isArray(m[d]))for(var f=0,g=m.length;f<g;f++)u.push([d,m[f]]);else u.push([d,m[d]])}return i._parameters=u,i}function u(t,i,a){l(i,a),d(i);var r=i._parameters;r.sort(function(e,t){return e[0]>t[0]?1:e[0]<t[0]?-1:e[1]>t[1]?1:e[1]<t[1]?-1:0});var n=e.map(r,function(e){return c(e[0])+"="+c((""+e[1]).length?e[1]:"")}).join("&");return t.toUpperCase()+"&"+c(i._url)+"&"+c(n)}function h(e,t,i){var a=s(i),r=u(e,t,i),n=o(r,a,i.sig_method||"HMAC-SHA1");return t.content.oauth_signature=n,t}var c=this.encode=function(e){return(""+e).length?encodeURIComponent(e).replace(/\!/g,"%21").replace(/\*/g,"%2A").replace(/\'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29"):""},m=(this.decode=function(e){for(var t=[],i=e.split("&"),a=0,r=i.length;a<r;a++){i[a];if(""!=i[a])if(i[a].indexOf("=")>-1){var n=i[a].split("=");t.push([decodeURIComponent(n[0]),decodeURIComponent(n[1])])}else t.push([decodeURIComponent(i[a]),null])}return t},"0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz");this.sign=function(e,t,i){return h(e,t,i)},this.xhr=function(e,t,i,r){return h(e,t,i),a(e,t,r)},this.xhrGet=function(e,t){return this.xhr("GET",e,t)},this.xhrPost=this.xhrRawPost=function(e,t){return this.xhr("POST",e,t,!0)},this.xhrPut=this.xhrRawPut=function(e,t){return this.xhr("PUT",e,t,!0)},this.xhrDelete=function(e,t){return this.xhr("DELETE",e,t)}},dojox.io.OAuth});//# sourceMappingURL=OAuth.js.map