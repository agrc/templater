//>>built
define("dojox/io/OAuth",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","dojo/_base/xhr","dojo/dom","dojox/encoding/digests/SHA1"],function(e,t,a,i,r,n){return e.getObject("io.OAuth",!0,dojox),dojox.io.OAuth=new function(){function t(e){for(var t=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],a=/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,i=a.exec(e),r={},n=t.length;n--;)r[t[n]]=i[n]||"";var o=r.protocol.toLowerCase(),s=r.authority.toLowerCase();("http"==o&&80==r.port||"https"==o&&443==r.port)&&s.lastIndexOf(":")>-1&&(s=s.substring(0,s.lastIndexOf(":")));var l=r.path||"/";return r.url=o+"://"+s+l,r}function a(e){for(var t="",a=c.length,i=0;i<e;i++)t+=c.charAt(Math.floor(Math.random()*a));return t}function r(){return Math.floor((new Date).valueOf()/1e3)-2}function o(e,t,a){if(a&&"PLAINTEXT"!=a&&"HMAC-SHA1"!=a)throw new Error("dojox.io.OAuth: the only supported signature encodings are PLAINTEXT and HMAC-SHA1.");return"PLAINTEXT"==a?t:n._hmac(e,t)}function s(e){return h(e.consumer.secret)+"&"+(e.token&&e.token.secret?h(e.token.secret):"")}function l(t,i){var n={oauth_consumer_key:i.consumer.key,oauth_nonce:a(16),oauth_signature_method:i.sig_method||"HMAC-SHA1",oauth_timestamp:r(),oauth_version:"1.0"};i.token&&(n.oauth_token=i.token.key),t.content=e.mixin(t.content||{},n)}function d(a){var i,r=[{}];if(a.form){a.content||(a.content={});var n=e.byId(a.form),o=n.getAttributeNode("action");a.url=a.url||(o?o.value:null),i=e.formToObject(n),delete a.form}i&&r.push(i),a.content&&r.push(a.content);var s=t(a.url);if(s.query){var l=e.queryToObject(s.query);for(var d in l)l[d]=encodeURIComponent(l[d]);r.push(l)}a._url=s.url;for(var u=[],m=0,h=r.length;m<h;m++){var c=r[m];for(var d in c)if(e.isArray(c[d]))for(var f=0,g=c.length;f<g;f++)u.push([d,c[f]]);else u.push([d,c[d]])}return a._parameters=u,a}function u(t,a,i){l(a,i),d(a);var r=a._parameters;r.sort(function(e,t){return e[0]>t[0]?1:e[0]<t[0]?-1:e[1]>t[1]?1:e[1]<t[1]?-1:0});var n=e.map(r,function(e){return h(e[0])+"="+h((""+e[1]).length?e[1]:"")}).join("&");return t.toUpperCase()+"&"+h(a._url)+"&"+h(n)}function m(e,t,a){var i=s(a),r=u(e,t,a),n=o(r,i,a.sig_method||"HMAC-SHA1");return t.content.oauth_signature=n,t}var h=this.encode=function(e){return(""+e).length?encodeURIComponent(e).replace(/\!/g,"%21").replace(/\*/g,"%2A").replace(/\'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29"):""},c=(this.decode=function(e){for(var t=[],a=e.split("&"),i=0,r=a.length;i<r;i++){a[i];if(""!=a[i])if(a[i].indexOf("=")>-1){var n=a[i].split("=");t.push([decodeURIComponent(n[0]),decodeURIComponent(n[1])])}else t.push([decodeURIComponent(a[i]),null])}return t},"0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz");this.sign=function(e,t,a){return m(e,t,a)},this.xhr=function(e,t,a,r){return m(e,t,a),i(e,t,r)},this.xhrGet=function(e,t){return this.xhr("GET",e,t)},this.xhrPost=this.xhrRawPost=function(e,t){return this.xhr("POST",e,t,!0)},this.xhrPut=this.xhrRawPut=function(e,t){return this.xhr("PUT",e,t,!0)},this.xhrDelete=function(e,t){return this.xhr("DELETE",e,t)}},dojox.io.OAuth});//# sourceMappingURL=OAuth.js.map