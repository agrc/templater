//>>built
define("dojox/io/OAuth",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","dojo/_base/xhr","dojo/dom","dojox/encoding/digests/SHA1"],function(e,t,i,a,r,o){return e.getObject("io.OAuth",!0,dojox),dojox.io.OAuth=new function(){function t(e){for(var t=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],i=/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,a=i.exec(e),r={},o=t.length;o--;)r[t[o]]=a[o]||"";var n=r.protocol.toLowerCase(),s=r.authority.toLowerCase(),l="http"==n&&80==r.port||"https"==n&&443==r.port;l&&s.lastIndexOf(":")>-1&&(s=s.substring(0,s.lastIndexOf(":")));var d=r.path||"/";return r.url=n+"://"+s+d,r}function i(e){for(var t="",i=m.length,a=0;e>a;a++)t+=m.charAt(Math.floor(Math.random()*i));return t}function r(){return Math.floor((new Date).valueOf()/1e3)-2}function n(e,t,i){if(i&&"PLAINTEXT"!=i&&"HMAC-SHA1"!=i)throw new Error("dojox.io.OAuth: the only supported signature encodings are PLAINTEXT and HMAC-SHA1.");return"PLAINTEXT"==i?t:o._hmac(e,t)}function s(e){return c(e.consumer.secret)+"&"+(e.token&&e.token.secret?c(e.token.secret):"")}function l(t,a){var o={oauth_consumer_key:a.consumer.key,oauth_nonce:i(16),oauth_signature_method:a.sig_method||"HMAC-SHA1",oauth_timestamp:r(),oauth_version:"1.0"};a.token&&(o.oauth_token=a.token.key),t.content=e.mixin(t.content||{},o)}function d(i){var a,r=[{}];if(i.form){i.content||(i.content={});var o=e.byId(i.form),n=o.getAttributeNode("action");i.url=i.url||(n?n.value:null),a=e.formToObject(o),delete i.form}a&&r.push(a),i.content&&r.push(i.content);var s=t(i.url);if(s.query){var l=e.queryToObject(s.query);for(var d in l)l[d]=encodeURIComponent(l[d]);r.push(l)}i._url=s.url;for(var h=[],u=0,c=r.length;c>u;u++){var m=r[u];for(var d in m)if(e.isArray(m[d]))for(var f=0,g=m.length;g>f;f++)h.push([d,m[f]]);else h.push([d,m[d]])}return i._parameters=h,i}function h(t,i,a){l(i,a),d(i);var r=i._parameters;r.sort(function(e,t){return e[0]>t[0]?1:e[0]<t[0]?-1:e[1]>t[1]?1:e[1]<t[1]?-1:0});var o=e.map(r,function(e){return c(e[0])+"="+c((""+e[1]).length?e[1]:"")}).join("&"),n=t.toUpperCase()+"&"+c(i._url)+"&"+c(o);return n}function u(e,t,i){var a=s(i),r=h(e,t,i),o=n(r,a,i.sig_method||"HMAC-SHA1");return t.content.oauth_signature=o,t}var c=this.encode=function(e){return(""+e).length?encodeURIComponent(e).replace(/\!/g,"%21").replace(/\*/g,"%2A").replace(/\'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29"):""},m=(this.decode=function(e){for(var t=[],i=e.split("&"),a=0,r=i.length;r>a;a++){i[a];if(""!=i[a])if(i[a].indexOf("=")>-1){var o=i[a].split("=");t.push([decodeURIComponent(o[0]),decodeURIComponent(o[1])])}else t.push([decodeURIComponent(i[a]),null])}return t},"0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz");this.sign=function(e,t,i){return u(e,t,i)},this.xhr=function(e,t,i,r){return u(e,t,i),a(e,t,r)},this.xhrGet=function(e,t){return this.xhr("GET",e,t)},this.xhrPost=this.xhrRawPost=function(e,t){return this.xhr("POST",e,t,!0)},this.xhrPut=this.xhrRawPut=function(e,t){return this.xhr("PUT",e,t,!0)},this.xhrDelete=function(e,t){return this.xhr("DELETE",e,t)}},dojox.io.OAuth});//# sourceMappingURL=OAuth.js.map