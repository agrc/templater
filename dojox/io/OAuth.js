//>>built
define("dojox/io/OAuth",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","dojo/_base/xhr","dojo/dom","dojox/encoding/digests/SHA1"],function(e,t,i,a,o,r){return e.getObject("io.OAuth",!0,dojox),dojox.io.OAuth=new function(){function t(e){for(var t=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],i=/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,a=i.exec(e),o={},r=t.length;r--;)o[t[r]]=a[r]||"";var n=o.protocol.toLowerCase(),s=o.authority.toLowerCase(),l="http"==n&&80==o.port||"https"==n&&443==o.port;l&&s.lastIndexOf(":")>-1&&(s=s.substring(0,s.lastIndexOf(":")));var d=o.path||"/";return o.url=n+"://"+s+d,o}function i(e){for(var t="",i=m.length,a=0;e>a;a++)t+=m.charAt(Math.floor(Math.random()*i));return t}function o(){return Math.floor((new Date).valueOf()/1e3)-2}function n(e,t,i){if(i&&"PLAINTEXT"!=i&&"HMAC-SHA1"!=i)throw new Error("dojox.io.OAuth: the only supported signature encodings are PLAINTEXT and HMAC-SHA1.");return"PLAINTEXT"==i?t:r._hmac(e,t)}function s(e){return c(e.consumer.secret)+"&"+(e.token&&e.token.secret?c(e.token.secret):"")}function l(t,a){var r={oauth_consumer_key:a.consumer.key,oauth_nonce:i(16),oauth_signature_method:a.sig_method||"HMAC-SHA1",oauth_timestamp:o(),oauth_version:"1.0"};a.token&&(r.oauth_token=a.token.key),t.content=e.mixin(t.content||{},r)}function d(i){var a,o=[{}];if(i.form){i.content||(i.content={});var r=e.byId(i.form),n=r.getAttributeNode("action");i.url=i.url||(n?n.value:null),a=e.formToObject(r),delete i.form}a&&o.push(a),i.content&&o.push(i.content);var s=t(i.url);if(s.query){var l=e.queryToObject(s.query);for(var d in l)l[d]=encodeURIComponent(l[d]);o.push(l)}i._url=s.url;for(var u=[],h=0,c=o.length;c>h;h++){var m=o[h];for(var d in m)if(e.isArray(m[d]))for(var f=0,p=m.length;p>f;f++)u.push([d,m[f]]);else u.push([d,m[d]])}return i._parameters=u,i}function u(t,i,a){l(i,a),d(i);var o=i._parameters;o.sort(function(e,t){return e[0]>t[0]?1:e[0]<t[0]?-1:e[1]>t[1]?1:e[1]<t[1]?-1:0});var r=e.map(o,function(e){return c(e[0])+"="+c((""+e[1]).length?e[1]:"")}).join("&"),n=t.toUpperCase()+"&"+c(i._url)+"&"+c(r);return n}function h(e,t,i){var a=s(i),o=u(e,t,i),r=n(o,a,i.sig_method||"HMAC-SHA1");return t.content.oauth_signature=r,t}var c=this.encode=function(e){return(""+e).length?encodeURIComponent(e).replace(/\!/g,"%21").replace(/\*/g,"%2A").replace(/\'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29"):""},m=(this.decode=function(e){for(var t=[],i=e.split("&"),a=0,o=i.length;o>a;a++){i[a];if(""!=i[a])if(i[a].indexOf("=")>-1){var r=i[a].split("=");t.push([decodeURIComponent(r[0]),decodeURIComponent(r[1])])}else t.push([decodeURIComponent(i[a]),null])}return t},"0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz");this.sign=function(e,t,i){return h(e,t,i)},this.xhr=function(e,t,i,o){return h(e,t,i),a(e,t,o)},this.xhrGet=function(e,t){return this.xhr("GET",e,t)},this.xhrPost=this.xhrRawPost=function(e,t){return this.xhr("POST",e,t,!0)},this.xhrPut=this.xhrRawPut=function(e,t){return this.xhr("PUT",e,t,!0)},this.xhrDelete=function(e,t){return this.xhr("DELETE",e,t)}},dojox.io.OAuth});//# sourceMappingURL=OAuth.js.map