//>>built
define("dojox/data/PicasaStore",["dojo/_base/lang","dojo/_base/declare","dojo/_base/connect","dojo/io/script","dojo/data/util/simpleFetch","dojo/date/stamp"],function(e,t,i,r,a,n){var o=t("dojox.data.PicasaStore",null,{constructor:function(e){e&&e.label&&(this.label=e.label),e&&"urlPreventCache"in e&&(this.urlPreventCache=!!e.urlPreventCache),e&&"maxResults"in e&&(this.maxResults=parseInt(e.maxResults),this.maxResults||(this.maxResults=20))},_picasaUrl:"http://picasaweb.google.com/data/feed/api/all",_storeRef:"_S",label:"title",urlPreventCache:!1,maxResults:20,_assertIsItem:function(e){if(!this.isItem(e))throw new Error("dojox.data.PicasaStore: a function was passed an item argument that was not an item")},_assertIsAttribute:function(e){if("string"!=typeof e)throw new Error("dojox.data.PicasaStore: a function was passed an attribute argument that was not an attribute name string")},getFeatures:function(){return{"dojo.data.api.Read":!0}},getValue:function(e,t,i){var r=this.getValues(e,t);return r&&r.length>0?r[0]:i},getAttributes:function(e){return["id","published","updated","category","title$type","title","summary$type","summary","rights$type","rights","link","author","gphoto$id","gphoto$name","location","imageUrlSmall","imageUrlMedium","imageUrl","datePublished","dateTaken","description"]},hasAttribute:function(e,t){return!!this.getValue(e,t)},isItemLoaded:function(e){return this.isItem(e)},loadItem:function(e){},getLabel:function(e){return this.getValue(e,this.label)},getLabelAttributes:function(e){return[this.label]},containsValue:function(e,t,i){for(var r=this.getValues(e,t),a=0;a<r.length;a++)if(r[a]===i)return!0;return!1},getValues:function(e,t){return this._assertIsItem(e),this._assertIsAttribute(t),"title"===t?[this._unescapeHtml(e.title)]:"author"===t?[this._unescapeHtml(e.author[0].name)]:"datePublished"===t?[dateAtamp.fromISOString(e.published)]:"dateTaken"===t?[n.fromISOString(e.published)]:"updated"===t?[n.fromISOString(e.updated)]:"imageUrlSmall"===t?[e.media.thumbnail[1].url]:"imageUrl"===t?[e.content$src]:"imageUrlMedium"===t?[e.media.thumbnail[2].url]:"link"===t?[e.link[1]]:"tags"===t?e.tags.split(" "):"description"===t?[this._unescapeHtml(e.summary)]:[]},isItem:function(e){return!(!e||e[this._storeRef]!==this)},close:function(e){},_fetchItems:function(e,t,a){e.query||(e.query={});var n={alt:"jsonm",pp:"1",psc:"G"};n["start-index"]="1",e.query.start&&(n["start-index"]=e.query.start),e.query.tags&&(n.q=e.query.tags),e.query.userid&&(n.uname=e.query.userid),e.query.userids&&(n.ids=e.query.userids),e.query.lang&&(n.hl=e.query.lang),n["max-results"]=this.maxResults;var o=this,d=null,s=function(r){null!==d&&i.disconnect(d),t(o._processPicasaData(r),e)},l={url:this._picasaUrl,preventCache:this.urlPreventCache,content:n,callbackParamName:"callback",handle:s},u=r.get(l);u.addErrback(function(t){i.disconnect(d),a(t,e)})},_processPicasaData:function(e){var t=[];if(e.feed){t=e.feed.entry;for(var i=0;i<t.length;i++){var r=t[i];r[this._storeRef]=this}}return t},_unescapeHtml:function(e){return e&&(e=e.replace(/&amp;/gm,"&").replace(/&lt;/gm,"<").replace(/&gt;/gm,">").replace(/&quot;/gm,'"'),e=e.replace(/&#39;/gm,"'")),e}});return e.extend(o,a),o});//# sourceMappingURL=PicasaStore.js.map