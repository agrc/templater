//>>built
define("dojox/data/CouchDBRestStore",["dojo","dojox","dojox/data/JsonRestStore"],function(e,t){var a=e.declare("dojox.data.CouchDBRestStore",t.data.JsonRestStore,{save:function(e){for(var t=this.inherited(arguments),a=this.service.servicePath,r=0;r<t.length;r++)!function(e,t){t.addCallback(function(t){return t&&(e.__id=a+t.id,e._rev=t.rev),t})}(t[r].content,t[r].deferred)},fetch:function(e){return e.query=e.query||"_all_docs?",e.start&&(e.query=(e.query?e.query+"&":"")+"skip="+e.start,delete e.start),e.count&&(e.query=(e.query?e.query+"&":"")+"limit="+e.count,delete e.count),this.inherited(arguments)},_processResults:function(e){var a=e.rows;if(a){for(var r=this.service.servicePath,i=0;i<a.length;i++){var o=a[i].value;o.__id=r+a[i].id,o._id=a[i].id,o._loadObject=t.rpc.JsonRest._loader,a[i]=o}return{totalCount:e.total_rows,items:e.rows}}return{items:e}}});return a.getStores=function(a){var r=e.xhrGet({url:a+"_all_dbs",handleAs:"json",sync:!0}),i={};return r.addBoth(function(e){for(var r=0;r<e.length;r++)i[e[r]]=new t.data.CouchDBRestStore({target:a+e[r],idAttribute:"_id"});return i}),i},a});//# sourceMappingURL=CouchDBRestStore.js.map