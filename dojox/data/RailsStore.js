//>>built
define("dojox/data/RailsStore",["dojo","dojox","dojox/data/JsonRestStore"],function(e,t){return e.declare("dojox.data.RailsStore",t.data.JsonRestStore,{constructor:function(){},preamble:function(a){if("string"==typeof a.target&&!a.service){var i=a.target.replace(/\/$/g,""),r=function(a,r){r=r||{};var o,n,d=i;e.isObject(a)?(n="",o="?"+e.objectToQuery(a)):r.queryStr&&-1!=r.queryStr.indexOf("?")?(n=r.queryStr.replace(/\?.*/,""),o=r.queryStr.replace(/[^?]*\?/g,"?")):e.isString(r.query)&&-1!=r.query.indexOf("?")?(n=r.query.replace(/\?.*/,""),o=r.query.replace(/[^?]*\?/g,"?")):(n=a?a.toString():"",o=""),-1!=n.indexOf("=")&&(o=n,n=""),d=n?d+"/"+n+".json"+o:d+".json"+o;var s=t.rpc._sync;return t.rpc._sync=!1,{url:d,handleAs:"json",contentType:"application/json",sync:s,headers:{Accept:"application/json,application/javascript",Range:r&&(r.start>=0||r.count>=0)?"items="+(r.start||"0")+"-"+(r.count&&r.count+(r.start||0)-1||""):void 0}}};a.service=t.rpc.Rest(this.target,!0,null,r)}},fetch:function(t){function a(a){function i(){null==t.queryStr&&(t.queryStr=""),e.isObject(t.query)?t.queryStr="?"+e.objectToQuery(t.query):e.isString(t.query)&&(t.queryStr=t.query)}function r(){return-1==t.queryStr.indexOf("?")?"?":"&"}null==t.queryStr&&i(),t.queryStr=t.queryStr+r()+e.objectToQuery(a)}if(t=t||{},t.start||t.count){if((t.start||0)%t.count)throw new Error("The start parameter must be a multiple of the count parameter");a({page:(t.start||0)/t.count+1,per_page:t.count})}if(t.sort){var i={sortBy:[],sortDir:[]};e.forEach(t.sort,function(e){i.sortBy.push(e.attribute),i.sortDir.push(e.descending?"DESC":"ASC")}),a(i),delete t.sort}return this.inherited(arguments)},_processResults:function(t,a){var i;if("undefined"==typeof this.rootAttribute&&t[0])if(t[0][this.idAttribute])this.rootAttribute=!1;else for(var r in t[0])t[0][r][this.idAttribute]&&(this.rootAttribute=r);i=this.rootAttribute?e.map(t,function(e){return e[this.rootAttribute]},this):t;var o=t.length;return{totalCount:a.fullLength||(a.request.count==o?(a.request.start||0)+2*o:o),items:i}}})});//# sourceMappingURL=RailsStore.js.map