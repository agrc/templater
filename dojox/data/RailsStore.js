//>>built
define("dojox/data/RailsStore",["dojo","dojox","dojox/data/JsonRestStore"],function(e,t){return e.declare("dojox.data.RailsStore",t.data.JsonRestStore,{constructor:function(){},preamble:function(i){if("string"==typeof i.target&&!i.service){var a=i.target.replace(/\/$/g,""),r=function(i,r){r=r||{};var n,o,s=a;e.isObject(i)?(o="",n="?"+e.objectToQuery(i)):r.queryStr&&-1!=r.queryStr.indexOf("?")?(o=r.queryStr.replace(/\?.*/,""),n=r.queryStr.replace(/[^?]*\?/g,"?")):e.isString(r.query)&&-1!=r.query.indexOf("?")?(o=r.query.replace(/\?.*/,""),n=r.query.replace(/[^?]*\?/g,"?")):(o=i?i.toString():"",n=""),-1!=o.indexOf("=")&&(n=o,o=""),s=o?s+"/"+o+".json"+n:s+".json"+n;var d=t.rpc._sync;return t.rpc._sync=!1,{url:s,handleAs:"json",contentType:"application/json",sync:d,headers:{Accept:"application/json,application/javascript",Range:r&&(r.start>=0||r.count>=0)?"items="+(r.start||"0")+"-"+(r.count&&r.count+(r.start||0)-1||""):void 0}}};i.service=t.rpc.Rest(this.target,!0,null,r)}},fetch:function(t){function i(i){function a(){null==t.queryStr&&(t.queryStr=""),e.isObject(t.query)?t.queryStr="?"+e.objectToQuery(t.query):e.isString(t.query)&&(t.queryStr=t.query)}function r(){return-1==t.queryStr.indexOf("?")?"?":"&"}null==t.queryStr&&a(),t.queryStr=t.queryStr+r()+e.objectToQuery(i)}if(t=t||{},t.start||t.count){if((t.start||0)%t.count)throw new Error("The start parameter must be a multiple of the count parameter");i({page:(t.start||0)/t.count+1,per_page:t.count})}if(t.sort){var a={sortBy:[],sortDir:[]};e.forEach(t.sort,function(e){a.sortBy.push(e.attribute),a.sortDir.push(e.descending?"DESC":"ASC")}),i(a),delete t.sort}return this.inherited(arguments)},_processResults:function(t,i){var a;if("undefined"==typeof this.rootAttribute&&t[0])if(t[0][this.idAttribute])this.rootAttribute=!1;else for(var r in t[0])t[0][r][this.idAttribute]&&(this.rootAttribute=r);a=this.rootAttribute?e.map(t,function(e){return e[this.rootAttribute]},this):t;var n=t.length;return{totalCount:i.fullLength||(i.request.count==n?(i.request.start||0)+2*n:n),items:a}}})});//# sourceMappingURL=RailsStore.js.map