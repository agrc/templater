//>>built
define("dojox/html/format",["dojo/_base/kernel","./entities","dojo/_base/array","dojo/_base/window","dojo/_base/sniff"],function(e,t,i,a,o){var n=e.getObject("dojox.html.format",!0);return n.prettyPrint=function(n,r,s,l,d){var c,u=[],h=0,m=[],f="\t",g="",p=[],y=/[=]([^"']+?)(\s|>)/g,v=/style=("[^"]*"|'[^']*'|\S*)/gi,b=/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi;if(r&&r>0&&r<10)for(f="",c=0;c<r;c++)f+=" ";var M=a.doc.createElement("div");M.innerHTML=n;var k=t.encode,w=t.decode,_=function(e){switch(e){case"a":case"b":case"strong":case"s":case"strike":case"i":case"u":case"em":case"sup":case"sub":case"span":case"font":case"big":case"cite":case"q":case"small":return!0;default:return!1}},x=M.ownerDocument.createElement("div"),j=function(e){var t=e.cloneNode(!1);x.appendChild(t);var i=x.innerHTML;return x.innerHTML="",i},I=function(){var e,t="";for(e=0;e<h;e++)t+=f;return t.length},C=function(){var e;for(e=0;e<h;e++)u.push(f)},E=function(){u.push("\n")},F=function(e){g+=k(e.nodeValue,l)},S=function(t){var i,a,o=t.split("\n");for(i=0;i<o.length;i++)o[i]=e.trim(o[i]);if(t=o.join(" "),""!==(t=e.trim(t))){var n=[];if(s&&s>0){var r=I(),l=s;for(s>r&&(l-=r);t;)if(t.length>s){for(i=l;i>0&&" "!==t.charAt(i);i--);if(!i)for(i=l;i<t.length&&" "!==t.charAt(i);i++);var d=t.substring(0,i);if(d=e.trim(d),t=e.trim(t.substring(i==t.length?t.length:i+1,t.length)),d){for(a="",i=0;i<h;i++)a+=f;d=a+d+"\n"}n.push(d)}else{for(a="",i=0;i<h;i++)a+=f;t=a+t+"\n",n.push(t),t=null}return n.join("")}for(a="",i=0;i<h;i++)a+=f;return t=a+t+"\n"}return""},A=function(e){return e&&(e=e.replace(/&quot;/gi,'"'),e=e.replace(/&gt;/gi,">"),e=e.replace(/&lt;/gi,"<"),e=e.replace(/&amp;/gi,"&")),e},T=function(t){if(t){t=A(t);var i,a,o,n,r=0,s=t.split("\n"),l=[];for(i=0;i<s.length;i++){var d=s[i],c=d.indexOf("\n")>-1;if(d=e.trim(d)){var u=r;for(o=0;o<d.length;o++){var m=d.charAt(o);"{"===m?r++:"}"===m&&(r--,u=r)}for(n="",a=0;a<h+u;a++)n+=f;l.push(n+d+"\n")}else c&&0===i&&l.push("\n")}t=l.join("")}return t},N=function(t){var a=t.nodeName.toLowerCase(),o=e.trim(j(t)),n=o.substring(0,o.indexOf(">")+1);n=n.replace(y,'="$1"$2'),n=n.replace(v,function(t){var a=t.substring(0,6),o=t.substring(6,t.length),n=o.charAt(0);o=e.trim(o.substring(1,o.length-1)),o=o.split(";");var r=[];i.forEach(o,function(t){(t=e.trim(t))&&(t=t.substring(0,t.indexOf(":")).toLowerCase()+t.substring(t.indexOf(":"),t.length),r.push(t))}),r=r.sort(),o=r.join("; ");var s=e.trim(o);return s&&";"!==s?(o+=";",a+n+o+n):""});var r=[];n=n.replace(b,function(t){return r.push(e.trim(t)),""}),r=r.sort(),n="<"+a,r.length&&(n+=" "+r.join(" ")),-1!=o.indexOf("</")?(m.push(a),n+=">"):(n+=d?" />":">",m.push(!1));var s=_(a);p.push(s),g&&!s&&(u.push(S(g)),g=""),s?g+=n:(C(),u.push(n),E(),h++)},z=function(){var e=p.pop();g&&!e&&(u.push(S(g)),g="");var t=m.pop();t?(t="</"+t+">",e?g+=t:(h--,C(),u.push(t),E())):h--},P=function(e){var t=w(e.nodeValue,l);C(),u.push("\x3c!--"),E(),h++,u.push(S(t)),h--,C(),u.push("--\x3e"),E()},L=function(t){var i=t.childNodes;if(i){var a;for(a=0;a<i.length;a++){var n=i[a];if(1===n.nodeType){var r=e.trim(n.tagName.toLowerCase());if(o("ie")&&n.parentNode!=t)continue;if(r&&"/"===r.charAt(0))continue;if(N(n),"script"===r)u.push(T(n.innerHTML));else if("pre"===r){var s=n.innerHTML;o("mozilla")&&(s=s.replace("<br>","\n"),s=s.replace("<pre>",""),s=s.replace("</pre>","")),"\n"!==s.charAt(s.length-1)&&(s+="\n"),u.push(s)}else L(n);z()}else 3===n.nodeType||4===n.nodeType?F(n):8===n.nodeType&&P(n)}}};return L(M),g&&(u.push(S(g)),g=""),u.join("")},n});//# sourceMappingURL=format.js.map