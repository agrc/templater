//>>built
define("dojox/charting/scaler/linear",["dojo/_base/lang","./common"],function(e,t){function a(e,t){e=e.toLowerCase();for(var a=t.length-1;a>=0;--a)if(e===t[a])return!0;return!1}var i=e.getObject("dojox.charting.scaler.linear",!0),r=3,o=t.getNumericLabel,n=function(t,r,o,n,d,s,l){o=e.delegate(o),n||("major"==o.fixUpper&&(o.fixUpper="minor"),"major"==o.fixLower&&(o.fixLower="minor")),d||("minor"==o.fixUpper&&(o.fixUpper="micro"),"minor"==o.fixLower&&(o.fixLower="micro")),s||("micro"==o.fixUpper&&(o.fixUpper="none"),"micro"==o.fixLower&&(o.fixLower="none"));var m=a(o.fixLower,["major"])?Math.floor(o.min/n)*n:a(o.fixLower,["minor"])?Math.floor(o.min/d)*d:a(o.fixLower,["micro"])?Math.floor(o.min/s)*s:o.min,u=a(o.fixUpper,["major"])?Math.ceil(o.max/n)*n:a(o.fixUpper,["minor"])?Math.ceil(o.max/d)*d:a(o.fixUpper,["micro"])?Math.ceil(o.max/s)*s:o.max;o.useMin&&(t=m),o.useMax&&(r=u);var h=!n||o.useMin&&a(o.fixLower,["major"])?t:Math.ceil(t/n)*n,f=!d||o.useMin&&a(o.fixLower,["major","minor"])?t:Math.ceil(t/d)*d,c=!s||o.useMin&&a(o.fixLower,["major","minor","micro"])?t:Math.ceil(t/s)*s,y=n?(o.useMax&&a(o.fixUpper,["major"])?Math.round((r-h)/n):Math.floor((r-h)/n))+1:0,v=d?(o.useMax&&a(o.fixUpper,["major","minor"])?Math.round((r-f)/d):Math.floor((r-f)/d))+1:0,p=s?(o.useMax&&a(o.fixUpper,["major","minor","micro"])?Math.round((r-c)/s):Math.floor((r-c)/s))+1:0,g=d?Math.round(n/d):0,M=s?Math.round(d/s):0,b=n?Math.floor(Math.log(n)/Math.LN10):0,w=d?Math.floor(Math.log(d)/Math.LN10):0,F=l/(r-t);return isFinite(F)||(F=1),{bounds:{lower:m,upper:u,from:t,to:r,scale:F,span:l},major:{tick:n,start:h,count:y,prec:b},minor:{tick:d,start:f,count:v,prec:w},micro:{tick:s,start:c,count:p,prec:0},minorPerMajor:g,microPerMinor:M,scaler:i}};return e.mixin(i,{buildScaler:function(e,t,a,i,o,d){var s={fixUpper:"none",fixLower:"none",natural:!1};if(i&&("fixUpper"in i&&(s.fixUpper=String(i.fixUpper)),"fixLower"in i&&(s.fixLower=String(i.fixLower)),"natural"in i&&(s.natural=Boolean(i.natural))),d=!d||r>d?r:d,"min"in i&&(e=i.min),"max"in i&&(t=i.max),i.includeZero&&(e>0&&(e=0),0>t&&(t=0)),s.min=e,s.useMin=!0,s.max=t,s.useMax=!0,"from"in i&&(e=i.from,s.useMin=!1),"to"in i&&(t=i.to,s.useMax=!1),e>=t)return n(e,t,s,0,0,0,a);o||(o=t-e);var l,m=Math.floor(Math.log(o)/Math.LN10),u=i&&"majorTickStep"in i?i.majorTickStep:Math.pow(10,m),h=0,f=0;if(i&&"minorTickStep"in i)h=i.minorTickStep;else do{if(h=u/10,(!s.natural||h>.9)&&(l=n(e,t,s,u,h,0,a),l.bounds.scale*l.minor.tick>d))break;if(h=u/5,(!s.natural||h>.9)&&(l=n(e,t,s,u,h,0,a),l.bounds.scale*l.minor.tick>d))break;if(h=u/2,(!s.natural||h>.9)&&(l=n(e,t,s,u,h,0,a),l.bounds.scale*l.minor.tick>d))break;return n(e,t,s,u,0,0,a)}while(!1);if(i&&"microTickStep"in i)f=i.microTickStep,l=n(e,t,s,u,h,f,a);else do{if(f=h/10,(!s.natural||f>.9)&&(l=n(e,t,s,u,h,f,a),l.bounds.scale*l.micro.tick>r))break;if(f=h/5,(!s.natural||f>.9)&&(l=n(e,t,s,u,h,f,a),l.bounds.scale*l.micro.tick>r))break;if(f=h/2,(!s.natural||f>.9)&&(l=n(e,t,s,u,h,f,a),l.bounds.scale*l.micro.tick>r))break;f=0}while(!1);return f?l:n(e,t,s,u,h,0,a)},buildTicks:function(e,t){var a,i,r,n=e.major.start,d=e.minor.start,s=e.micro.start;if(t.microTicks&&e.micro.tick)a=e.micro.tick,i=s;else if(t.minorTicks&&e.minor.tick)a=e.minor.tick,i=d;else{if(!e.major.tick)return null;a=e.major.tick,i=n}var l=1/e.bounds.scale;if(e.bounds.to<=e.bounds.from||isNaN(l)||!isFinite(l)||0>=a||isNaN(a)||!isFinite(a))return null;for(var m=[],u=[],h=[];i<=e.bounds.to+l;)Math.abs(n-i)<a/2?(r={value:n},t.majorLabels&&(r.label=o(n,e.major.prec,t)),m.push(r),n+=e.major.tick,d+=e.minor.tick,s+=e.micro.tick):Math.abs(d-i)<a/2?(t.minorTicks&&(r={value:d},t.minorLabels&&e.minMinorStep<=e.minor.tick*e.bounds.scale&&(r.label=o(d,e.minor.prec,t)),u.push(r)),d+=e.minor.tick,s+=e.micro.tick):(t.microTicks&&h.push({value:s}),s+=e.micro.tick),i+=a;return{major:m,minor:u,micro:h}},getTransformerFromModel:function(e){var t=e.bounds.from,a=e.bounds.scale;return function(e){return(e-t)*a}},getTransformerFromPlot:function(e){var t=e.bounds.from,a=e.bounds.scale;return function(e){return e/a+t}}})});//# sourceMappingURL=linear.js.map