//>>built
define("dojox/charting/scaler/linear",["dojo/_base/lang","./common"],function(e,t){function a(e,t){e=e.toLowerCase();for(var a=t.length-1;a>=0;--a)if(e===t[a])return!0;return!1}var i=e.getObject("dojox.charting.scaler.linear",!0),r=3,o=t.getNumericLabel,d=function(t,r,o,d,n,l,s){o=e.delegate(o),d||("major"==o.fixUpper&&(o.fixUpper="minor"),"major"==o.fixLower&&(o.fixLower="minor")),n||("minor"==o.fixUpper&&(o.fixUpper="micro"),"minor"==o.fixLower&&(o.fixLower="micro")),l||("micro"==o.fixUpper&&(o.fixUpper="none"),"micro"==o.fixLower&&(o.fixLower="none"));var m=a(o.fixLower,["major"])?Math.floor(o.min/d)*d:a(o.fixLower,["minor"])?Math.floor(o.min/n)*n:a(o.fixLower,["micro"])?Math.floor(o.min/l)*l:o.min,u=a(o.fixUpper,["major"])?Math.ceil(o.max/d)*d:a(o.fixUpper,["minor"])?Math.ceil(o.max/n)*n:a(o.fixUpper,["micro"])?Math.ceil(o.max/l)*l:o.max;o.useMin&&(t=m),o.useMax&&(r=u);var h=!d||o.useMin&&a(o.fixLower,["major"])?t:Math.ceil(t/d)*d,f=!n||o.useMin&&a(o.fixLower,["major","minor"])?t:Math.ceil(t/n)*n,c=!l||o.useMin&&a(o.fixLower,["major","minor","micro"])?t:Math.ceil(t/l)*l,y=d?(o.useMax&&a(o.fixUpper,["major"])?Math.round((r-h)/d):Math.floor((r-h)/d))+1:0,v=n?(o.useMax&&a(o.fixUpper,["major","minor"])?Math.round((r-f)/n):Math.floor((r-f)/n))+1:0,M=l?(o.useMax&&a(o.fixUpper,["major","minor","micro"])?Math.round((r-c)/l):Math.floor((r-c)/l))+1:0,p=n?Math.round(d/n):0,g=l?Math.round(n/l):0,b=d?Math.floor(Math.log(d)/Math.LN10):0,w=n?Math.floor(Math.log(n)/Math.LN10):0,k=s/(r-t);return isFinite(k)||(k=1),{bounds:{lower:m,upper:u,from:t,to:r,scale:k,span:s},major:{tick:d,start:h,count:y,prec:b},minor:{tick:n,start:f,count:v,prec:w},micro:{tick:l,start:c,count:M,prec:0},minorPerMajor:p,microPerMinor:g,scaler:i}};return e.mixin(i,{buildScaler:function(e,t,a,i,o,n){var l={fixUpper:"none",fixLower:"none",natural:!1};if(i&&("fixUpper"in i&&(l.fixUpper=String(i.fixUpper)),"fixLower"in i&&(l.fixLower=String(i.fixLower)),"natural"in i&&(l.natural=Boolean(i.natural))),n=!n||r>n?r:n,"min"in i&&(e=i.min),"max"in i&&(t=i.max),i.includeZero&&(e>0&&(e=0),0>t&&(t=0)),l.min=e,l.useMin=!0,l.max=t,l.useMax=!0,"from"in i&&(e=i.from,l.useMin=!1),"to"in i&&(t=i.to,l.useMax=!1),e>=t)return d(e,t,l,0,0,0,a);o||(o=t-e);var s,m=Math.floor(Math.log(o)/Math.LN10),u=i&&"majorTickStep"in i?i.majorTickStep:Math.pow(10,m),h=0,f=0;if(i&&"minorTickStep"in i)h=i.minorTickStep;else do{if(h=u/10,(!l.natural||h>.9)&&(s=d(e,t,l,u,h,0,a),s.bounds.scale*s.minor.tick>n))break;if(h=u/5,(!l.natural||h>.9)&&(s=d(e,t,l,u,h,0,a),s.bounds.scale*s.minor.tick>n))break;if(h=u/2,(!l.natural||h>.9)&&(s=d(e,t,l,u,h,0,a),s.bounds.scale*s.minor.tick>n))break;return d(e,t,l,u,0,0,a)}while(!1);if(i&&"microTickStep"in i)f=i.microTickStep,s=d(e,t,l,u,h,f,a);else do{if(f=h/10,(!l.natural||f>.9)&&(s=d(e,t,l,u,h,f,a),s.bounds.scale*s.micro.tick>r))break;if(f=h/5,(!l.natural||f>.9)&&(s=d(e,t,l,u,h,f,a),s.bounds.scale*s.micro.tick>r))break;if(f=h/2,(!l.natural||f>.9)&&(s=d(e,t,l,u,h,f,a),s.bounds.scale*s.micro.tick>r))break;f=0}while(!1);return f?s:d(e,t,l,u,h,0,a)},buildTicks:function(e,t){var a,i,r,d=e.major.start,n=e.minor.start,l=e.micro.start;if(t.microTicks&&e.micro.tick)a=e.micro.tick,i=l;else if(t.minorTicks&&e.minor.tick)a=e.minor.tick,i=n;else{if(!e.major.tick)return null;a=e.major.tick,i=d}var s=1/e.bounds.scale;if(e.bounds.to<=e.bounds.from||isNaN(s)||!isFinite(s)||0>=a||isNaN(a)||!isFinite(a))return null;for(var m=[],u=[],h=[];i<=e.bounds.to+s;)Math.abs(d-i)<a/2?(r={value:d},t.majorLabels&&(r.label=o(d,e.major.prec,t)),m.push(r),d+=e.major.tick,n+=e.minor.tick,l+=e.micro.tick):Math.abs(n-i)<a/2?(t.minorTicks&&(r={value:n},t.minorLabels&&e.minMinorStep<=e.minor.tick*e.bounds.scale&&(r.label=o(n,e.minor.prec,t)),u.push(r)),n+=e.minor.tick,l+=e.micro.tick):(t.microTicks&&h.push({value:l}),l+=e.micro.tick),i+=a;return{major:m,minor:u,micro:h}},getTransformerFromModel:function(e){var t=e.bounds.from,a=e.bounds.scale;return function(e){return(e-t)*a}},getTransformerFromPlot:function(e){var t=e.bounds.from,a=e.bounds.scale;return function(e){return e/a+t}}})});//# sourceMappingURL=linear.js.map