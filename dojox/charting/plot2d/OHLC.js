//>>built
define("dojox/charting/plot2d/OHLC",["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/has","./CartesianBase","./_PlotEvents","./common","dojox/lang/functional","dojox/lang/functional/reversed","dojox/lang/utils","dojox/gfx/fx"],function(e,t,a,i,r,d,o,n,l,s,m){var f=l.lambda("item.purgeGroup()");return a("dojox.charting.plot2d.OHLC",[r,d],{defaultParams:{gap:2,animate:null},optionalParams:{minBarSize:1,maxBarSize:1,stroke:{},outline:{},shadow:{},fill:{},font:"",fontColor:""},constructor:function(t,a){this.opt=e.clone(this.defaultParams),s.updateWithObject(this.opt,a),s.updateWithPattern(this.opt,a,this.optionalParams),this.animate=this.opt.animate},collectStats:function(a){for(var i=e.delegate(o.defaultStats),r=0;r<a.length;r++){var d=a[r];if(d.data.length){var n=i.vmin,l=i.vmax;"ymin"in d&&"ymax"in d||t.forEach(d.data,function(e,t){if(!this.isNullValue(e)){var a=e.x||t+1;i.hmin=Math.min(i.hmin,a),i.hmax=Math.max(i.hmax,a),i.vmin=Math.min(i.vmin,e.open,e.close,e.high,e.low),i.vmax=Math.max(i.vmax,e.open,e.close,e.high,e.low)}},this),"ymin"in d&&(i.vmin=Math.min(n,d.ymin)),"ymax"in d&&(i.vmax=Math.max(l,d.ymax))}}return i},getSeriesStats:function(){var e=this.collectStats(this.series);return e.hmin-=.5,e.hmax+=.5,e},render:function(e,a){if(this.zoom&&!this.isDataDirty())return this.performZoom(e,a);if(this.resetEvents(),this.dirty=this.isDirty(),this.dirty){t.forEach(this.series,f),this._eventSeries={},this.cleanGroup();var r=this.getGroup();n.forEachRev(this.series,function(e){e.cleanGroup(r)})}var d,l,s,m=this.chart.theme,u=this._hScaler.scaler.getTransformerFromModel(this._hScaler),h=this._vScaler.scaler.getTransformerFromModel(this._vScaler),c=this.events();d=o.calculateBarSize(this._hScaler.bounds.scale,this.opt),l=d.gap,s=d.size;for(var y=0;y<this.series.length;y++){var v=this.series[y];if(this.dirty||v.dirty){v.cleanGroup();for(var M=m.next("candlestick",[this.opt,v]),r=v.group,g=new Array(v.data.length),p=0;p<v.data.length;++p){var b=v.data[p];if(!this.isNullValue(b)){var w=m.addMixin(M,"candlestick",b,!0),F=u(b.x||p+.5)+a.l+l,k=e.height-a.b,I=h(b.open),j=h(b.close),_=h(b.high),E=h(b.low);if(E>_){var x=_;_=E,E=x}if(s>=1){var G={x1:s/2,x2:s/2,y1:k-_,y2:k-E},T={x1:0,x2:s/2+(w.series.stroke?w.series.stroke.width||1:1)/2,y1:k-I,y2:k-I},S={x1:s/2-(w.series.stroke?w.series.stroke.width||1:1)/2,x2:s,y1:k-j,y2:k-j},A=r.createGroup();A.setTransform({dx:F,dy:0});var C=A.createGroup();if(C.createLine(G).setStroke(w.series.stroke),C.createLine(T).setStroke(w.series.stroke),C.createLine(S).setStroke(w.series.stroke),v.dyn.stroke=w.series.stroke,c){var z={element:"candlestick",index:p,run:v,shape:C,x:F,y:k-Math.max(I,j),cx:s/2,cy:k-Math.max(I,j)+Math.max(I>j?I-j:j-I,1)/2,width:s,height:Math.max(I>j?I-j:j-I,1),data:b};this._connectEvents(z),g[p]=z}}this.animate&&this._animateOHLC(A,k-E,_-E)}}this._eventSeries[v.name]=g,v.dirty=!1}else m.skip(),this._reconnectEvents(v.name)}return this.dirty=!1,i("dojo-bidi")&&this._checkOrientation(this.group,e,a),this},_animateOHLC:function(t,a,i){m.animateTransform(e.delegate({shape:t,duration:1200,transform:[{name:"translate",start:[0,a-a/i],end:[0,0]},{name:"scale",start:[1,1/i],end:[1,1]},{name:"original"}]},this.animate)).play()}})});//# sourceMappingURL=OHLC.js.map