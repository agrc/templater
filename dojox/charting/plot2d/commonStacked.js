//>>built
define("dojox/charting/plot2d/commonStacked",["dojo/_base/lang","dojox/lang/functional","./common"],function(e,t,a){var i=e.getObject("dojox.charting.plot2d.commonStacked",!0);return e.mixin(i,{collectStats:function(t,r){for(var o=e.delegate(a.defaultStats),d=0;d<t.length;++d)for(var n=t[d],l=0;l<n.data.length;l++){var s,m;null!==n.data[l]&&("number"!=typeof n.data[l]&&n.data[l].hasOwnProperty("x")?null!==(s=n.data[l].x)&&(m=i.getValue(t,d,s,r)[0],m=null!=m&&m.y?m.y:null):(m=i.getIndexValue(t,d,l,r)[0],s=l+1),o.hmin=Math.min(o.hmin,s),o.hmax=Math.max(o.hmax,s),o.vmin=Math.min(o.vmin,m),o.vmax=Math.max(o.vmax,m))}return o},rearrangeValues:function(e,a,i){var r=t.filter(e,"x"),o=r.length;if(!o)return e;for(var d={},n=0;n<o;++n){for(var l=r[n],s=l.min,m=l.max;s<m;++s)l[s]=(l[s]||0)+(d[s]||0);d=l}for(n=0;n<o;++n)for(l=r[n],s=l.min,m=l.max;s<m;++s)l[s]=this.isNullValue(l[s])?0:a(l[s])-i;if(this.opt.minWidth){var u=this.opt.minWidth;for(n=o-1;n;--n)for(l=r[n],d=r[n-1],s=l.min,m=l.max;s<m;++s)l[s]=l[s]-d[s];for(var f=l.min,h=l.max,s=f;s<h;++s){var c=0,y=0;for(n=0;n<o;++n){var v=r[n][s];v>0&&(c+=v,++y)}if(c<=y*u)for(n=0;n<o;++n)(v=r[n][s])>0&&(r[n][s]=u);else{var M=0;for(n=0;n<o;++n)if(l=r[n],(v=l[s])>0)if(v<u)M+=u-v,l[s]=u;else if(M>0){var g=l[s]-u;g>=M?(l[s]-=M,M=0):g>0&&(l[s]=u,M-=g)}if(M>0)for(n=o-1;n>=0;--n)if(l=r[n],(v=l[s])>0){if((g=l[s]-u)>=M){l[s]-=M;break}g>0&&(l[s]=u,M-=g)}}}for(n=1;n<o;++n)for(l=r[n],d=r[n-1],s=l.min,m=l.max;s<m;++s)l[s]=l[s]+d[s]}return e},getIndexValue:function(e,t,a,i){var r,o,d,n=0;for(o=0;o<=t;++o)e[o].hidden||(d=n,r=e[o].data[a],i(r)||(isNaN(r)&&(r=r.y||0),n+=r));return[n,d]},getValue:function(e,t,a,i){var r,o,d,n,l=null;for(r=0;r<=t;++r)if(!e[r].hidden)for(o=0;o<e[r].data.length;o++)if(n=l,d=e[r].data[o],!i(d)){if(d.x==a){l||(l={x:a}),null!=d.y&&(null==l.y&&(l.y=0),l.y+=d.y);break}if(d.x>a)break}return[l,n]}})});//# sourceMappingURL=commonStacked.js.map