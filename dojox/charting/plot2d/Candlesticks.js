//>>built
define("dojox/charting/plot2d/Candlesticks",["dojo/_base/lang","dojo/_base/declare","dojo/_base/array","dojo/has","./CartesianBase","./_PlotEvents","./common","dojox/lang/functional","dojox/lang/functional/reversed","dojox/lang/utils","dojox/gfx/fx"],function(e,t,i,a,r,n,o,s,d,l,u){var c=d.lambda("item.purgeGroup()");return t("dojox.charting.plot2d.Candlesticks",[r,n],{defaultParams:{gap:2,animate:null},optionalParams:{minBarSize:1,maxBarSize:1,stroke:{},outline:{},shadow:{},fill:{},font:"",fontColor:""},constructor:function(t,i){this.opt=e.clone(this.defaultParams),l.updateWithObject(this.opt,i),l.updateWithPattern(this.opt,i,this.optionalParams),this.animate=this.opt.animate},collectStats:function(t){for(var a=e.delegate(o.defaultStats),r=0;r<t.length;r++){var n=t[r];if(n.data.length){var s=a.vmin,d=a.vmax;"ymin"in n&&"ymax"in n||i.forEach(n.data,function(e,t){if(!this.isNullValue(e)){var i=e.x||t+1;a.hmin=Math.min(a.hmin,i),a.hmax=Math.max(a.hmax,i),a.vmin=Math.min(a.vmin,e.open,e.close,e.high,e.low),a.vmax=Math.max(a.vmax,e.open,e.close,e.high,e.low)}},this),"ymin"in n&&(a.vmin=Math.min(s,n.ymin)),"ymax"in n&&(a.vmax=Math.max(d,n.ymax))}}return a},getSeriesStats:function(){var e=this.collectStats(this.series);return e.hmin-=.5,e.hmax+=.5,e},render:function(e,t){if(this.zoom&&!this.isDataDirty())return this.performZoom(e,t);this.resetEvents(),this.dirty=this.isDirty();var r;this.dirty&&(i.forEach(this.series,c),this._eventSeries={},this.cleanGroup(),r=this.getGroup(),s.forEachRev(this.series,function(e){e.cleanGroup(r)}));var n,d,l,u=this.chart.theme,h=this._hScaler.scaler.getTransformerFromModel(this._hScaler),f=this._vScaler.scaler.getTransformerFromModel(this._vScaler),m=this.events();n=o.calculateBarSize(this._hScaler.bounds.scale,this.opt),d=n.gap,l=n.size;for(var p=this.series.length-1;p>=0;--p){var y=this.series[p];if(this.dirty||y.dirty){y.cleanGroup();var v=u.next("candlestick",[this.opt,y]),g=new Array(y.data.length);if(y.hidden)y.dyn.fill=v.series.fill,y.dyn.stroke=v.series.stroke;else{r=y.group;for(var b=0;b<y.data.length;++b){var M=y.data[b];if(!this.isNullValue(M)){var w=u.addMixin(v,"candlestick",M,!0),k=h(M.x||b+.5)+t.l+d,_=e.height-t.b,j=f(M.open),E=f(M.close),x=f(M.high),F=f(M.low);if("mid"in M)var I=f(M.mid);if(F>x){var S=x;x=F,F=S}if(l>=1){var C=j>E,A={x1:l/2,x2:l/2,y1:_-x,y2:_-F},T={x:0,y:_-Math.max(j,E),width:l,height:Math.max(C?j-E:E-j,1)},N=r.createGroup();N.setTransform({dx:k,dy:0});var P=N.createGroup();if(P.createLine(A).setStroke(w.series.stroke),P.createRect(T).setStroke(w.series.stroke).setFill(C?w.series.fill:"white"),"mid"in M&&P.createLine({x1:w.series.stroke?w.series.stroke.width||1:1,x2:l-(w.series.stroke?w.series.stroke.width||1:1),y1:_-I,y2:_-I}).setStroke(C?"white":w.series.stroke),y.dyn.fill=w.series.fill,y.dyn.stroke=w.series.stroke,m){var D={element:"candlestick",index:b,run:y,shape:P,x:k,y:_-Math.max(j,E),cx:l/2,cy:_-Math.max(j,E)+Math.max(C?j-E:E-j,1)/2,width:l,height:Math.max(C?j-E:E-j,1),data:M};this._connectEvents(D),g[b]=D}}this.animate&&this._animateCandlesticks(N,_-F,x-F)}}this._eventSeries[y.name]=g,y.dirty=!1}}else u.skip(),this._reconnectEvents(y.name)}return this.dirty=!1,a("dojo-bidi")&&this._checkOrientation(this.group,e,t),this},tooltipFunc:function(e){return'<table cellpadding="1" cellspacing="0" border="0" style="font-size:0.9em;"><tr><td>Open:</td><td align="right"><strong>'+e.data.open+'</strong></td></tr><tr><td>High:</td><td align="right"><strong>'+e.data.high+'</strong></td></tr><tr><td>Low:</td><td align="right"><strong>'+e.data.low+'</strong></td></tr><tr><td>Close:</td><td align="right"><strong>'+e.data.close+"</strong></td></tr>"+(void 0!==e.data.mid?'<tr><td>Mid:</td><td align="right"><strong>'+e.data.mid+"</strong></td></tr>":"")+"</table>"},_animateCandlesticks:function(t,i,a){u.animateTransform(e.delegate({shape:t,duration:1200,transform:[{name:"translate",start:[0,i-i/a],end:[0,0]},{name:"scale",start:[1,1/a],end:[1,1]},{name:"original"}]},this.animate)).play()}})});//# sourceMappingURL=Candlesticks.js.map