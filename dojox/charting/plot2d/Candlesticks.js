//>>built
define("dojox/charting/plot2d/Candlesticks",["dojo/_base/lang","dojo/_base/declare","dojo/_base/array","dojo/has","./CartesianBase","./_PlotEvents","./common","dojox/lang/functional","dojox/lang/functional/reversed","dojox/lang/utils","dojox/gfx/fx"],function(e,t,a,i,r,o,d,n,l,s,m){var u=l.lambda("item.purgeGroup()");return t("dojox.charting.plot2d.Candlesticks",[r,o],{defaultParams:{gap:2,animate:null},optionalParams:{minBarSize:1,maxBarSize:1,stroke:{},outline:{},shadow:{},fill:{},font:"",fontColor:""},constructor:function(t,a){this.opt=e.clone(this.defaultParams),s.updateWithObject(this.opt,a),s.updateWithPattern(this.opt,a,this.optionalParams),this.animate=this.opt.animate},collectStats:function(t){for(var i=e.delegate(d.defaultStats),r=0;r<t.length;r++){var o=t[r];if(o.data.length){var n=i.vmin,l=i.vmax;"ymin"in o&&"ymax"in o||a.forEach(o.data,function(e,t){if(null!==e){var a=e.x||t+1;i.hmin=Math.min(i.hmin,a),i.hmax=Math.max(i.hmax,a),i.vmin=Math.min(i.vmin,e.open,e.close,e.high,e.low),i.vmax=Math.max(i.vmax,e.open,e.close,e.high,e.low)}}),"ymin"in o&&(i.vmin=Math.min(n,o.ymin)),"ymax"in o&&(i.vmax=Math.max(l,o.ymax))}}return i},getSeriesStats:function(){var e=this.collectStats(this.series);return e.hmin-=.5,e.hmax+=.5,e},render:function(e,t){if(this.zoom&&!this.isDataDirty())return this.performZoom(e,t);this.resetEvents(),this.dirty=this.isDirty();var r;this.dirty&&(a.forEach(this.series,u),this._eventSeries={},this.cleanGroup(),r=this.getGroup(),n.forEachRev(this.series,function(e){e.cleanGroup(r)}));var o,l,s,m=this.chart.theme,h=this._hScaler.scaler.getTransformerFromModel(this._hScaler),f=this._vScaler.scaler.getTransformerFromModel(this._vScaler),y=this.events();o=d.calculateBarSize(this._hScaler.bounds.scale,this.opt),l=o.gap,s=o.size;for(var c=this.series.length-1;c>=0;--c){var v=this.series[c];if(this.dirty||v.dirty){v.cleanGroup();var M=m.next("candlestick",[this.opt,v]),g=new Array(v.data.length);if(v.hidden)v.dyn.fill=M.series.fill,v.dyn.stroke=M.series.stroke;else{r=v.group;for(var p=0;p<v.data.length;++p){var b=v.data[p];if(null!==b){var w=m.addMixin(M,"candlestick",b,!0),k=h(b.x||p+.5)+t.l+l,F=e.height-t.b,I=f(b.open),j=f(b.close),E=f(b.high),_=f(b.low);if("mid"in b)var G=f(b.mid);if(_>E){var x=E;E=_,_=x}if(s>=1){var T=I>j,S={x1:s/2,x2:s/2,y1:F-E,y2:F-_},A={x:0,y:F-Math.max(I,j),width:s,height:Math.max(T?I-j:j-I,1)},C=r.createGroup();C.setTransform({dx:k,dy:0});var z=C.createGroup();if(z.createLine(S).setStroke(w.series.stroke),z.createRect(A).setStroke(w.series.stroke).setFill(T?w.series.fill:"white"),"mid"in b&&z.createLine({x1:w.series.stroke.width||1,x2:s-(w.series.stroke.width||1),y1:F-G,y2:F-G}).setStroke(T?"white":w.series.stroke),v.dyn.fill=w.series.fill,v.dyn.stroke=w.series.stroke,y){var N={element:"candlestick",index:p,run:v,shape:z,x:k,y:F-Math.max(I,j),cx:s/2,cy:F-Math.max(I,j)+Math.max(T?I-j:j-I,1)/2,width:s,height:Math.max(T?I-j:j-I,1),data:b};this._connectEvents(N),g[p]=N}}this.animate&&this._animateCandlesticks(C,F-_,E-_)}}this._eventSeries[v.name]=g,v.dirty=!1}}else m.skip(),this._reconnectEvents(v.name)}return this.dirty=!1,i("dojo-bidi")&&this._checkOrientation(this.group,e,t),this},tooltipFunc:function(e){return'<table cellpadding="1" cellspacing="0" border="0" style="font-size:0.9em;"><tr><td>Open:</td><td align="right"><strong>'+e.data.open+'</strong></td></tr><tr><td>High:</td><td align="right"><strong>'+e.data.high+'</strong></td></tr><tr><td>Low:</td><td align="right"><strong>'+e.data.low+'</strong></td></tr><tr><td>Close:</td><td align="right"><strong>'+e.data.close+"</strong></td></tr>"+(void 0!==e.data.mid?'<tr><td>Mid:</td><td align="right"><strong>'+e.data.mid+"</strong></td></tr>":"")+"</table>"},_animateCandlesticks:function(t,a,i){m.animateTransform(e.delegate({shape:t,duration:1200,transform:[{name:"translate",start:[0,a-a/i],end:[0,0]},{name:"scale",start:[1,1/i],end:[1,1]},{name:"original"}]},this.animate)).play()}})});//# sourceMappingURL=Candlesticks.js.map