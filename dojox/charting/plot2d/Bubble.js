//>>built
define("dojox/charting/plot2d/Bubble",["dojo/_base/lang","dojo/_base/declare","dojo/_base/array","dojo/has","./CartesianBase","./_PlotEvents","./common","dojox/lang/functional","dojox/lang/functional/reversed","dojox/lang/utils","dojox/gfx/fx"],function(e,t,i,a,r,n,o,d,s,l,u){var f=s.lambda("item.purgeGroup()");return t("dojox.charting.plot2d.Bubble",[r,n],{defaultParams:{animate:null},optionalParams:{stroke:{},outline:{},shadow:{},fill:{},filter:{},styleFunc:null,font:"",fontColor:"",labelFunc:null},constructor:function(t,i){this.opt=e.clone(e.mixin(this.opt,this.defaultParams)),l.updateWithObject(this.opt,i),l.updateWithPattern(this.opt,i,this.optionalParams),this.opt.labelFunc||(this.opt.labelFunc=function(e,t,i){return this._getLabel(e.size,t,i)}),this.animate=this.opt.animate},render:function(e,t){var r;if(this.zoom&&!this.isDataDirty())return this.performZoom(e,t);this.resetEvents(),this.dirty=this.isDirty(),this.dirty&&(i.forEach(this.series,f),this._eventSeries={},this.cleanGroup(),r=this.getGroup(),d.forEachRev(this.series,function(e){e.cleanGroup(r)}));for(var n=this.chart.theme,s=this._hScaler.scaler.getTransformerFromModel(this._hScaler),l=this._vScaler.scaler.getTransformerFromModel(this._vScaler),u=this.events(),c=this.series.length-1;c>=0;--c){var m=this.series[c];if(this.dirty||m.dirty)if(m.cleanGroup(),m.data.length){if("number"!=typeof m.data[0]){var h=n.next("circle",[this.opt,m]),y=i.map(m.data,function(i){return i?{x:s(i.x)+t.l,y:e.height-t.b-l(i.y),radius:this._vScaler.bounds.scale*(i.size/2)}:null},this);if(m.hidden)m.dyn.fill=h.series.fill,m.dyn.stroke=h.series.stroke;else{r=m.group;var p=null,v=null,g=null,b=this.opt.styleFunc,M=function(e){return b?n.addMixin(h,"circle",[e,b(e)],!0):n.addMixin(h,"circle",e,!0)};if(h.series.shadow&&(g=i.map(y,function(i,a){if(null!==i){var n=M(m.data[a]),o=n.series.shadow,d=r.createCircle({cx:i.x+o.dx,cy:i.y+o.dy,r:i.radius}).setStroke(o).setFill(o.color);return this.animate&&this._animateBubble(d,e.height-t.b,i.radius),d}return null},this),g.length&&(m.dyn.shadow=g[g.length-1].getStroke())),h.series.outline&&(v=i.map(y,function(i,a){if(null!==i){var n=M(m.data[a]),d=o.makeStroke(n.series.outline);d.width=2*d.width+h.series.stroke.width;var s=r.createCircle({cx:i.x,cy:i.y,r:i.radius}).setStroke(d);return this.animate&&this._animateBubble(s,e.height-t.b,i.radius),s}return null},this),v.length&&(m.dyn.outline=v[v.length-1].getStroke())),p=i.map(y,function(i,a){if(null!==i){var n=M(m.data[a]),o={x:i.x-i.radius,y:i.y-i.radius,width:2*i.radius,height:2*i.radius},d=this._plotFill(n.series.fill,e,t);d=this._shapeFill(d,o);var s=r.createCircle({cx:i.x,cy:i.y,r:i.radius}).setFill(d).setStroke(n.series.stroke);return s.setFilter&&n.series.filter&&s.setFilter(n.series.filter),this.animate&&this._animateBubble(s,e.height-t.b,i.radius),this.createLabel(r,m.data[a],o,n),s}return null},this),p.length&&(m.dyn.fill=p[p.length-1].getFill(),m.dyn.stroke=p[p.length-1].getStroke()),u){var w=new Array(p.length);i.forEach(p,function(e,t){if(null!==e){var i={element:"circle",index:t,run:m,shape:e,outline:v&&v[t]||null,shadow:g&&g[t]||null,x:m.data[t].x,y:m.data[t].y,r:m.data[t].size/2,cx:y[t].x,cy:y[t].y,cr:y[t].radius};this._connectEvents(i),w[t]=i}},this),this._eventSeries[m.name]=w}else delete this._eventSeries[m.name];m.dirty=!1}}}else m.dirty=!1,n.skip();else n.skip(),this._reconnectEvents(m.name)}return this.dirty=!1,a("dojo-bidi")&&this._checkOrientation(this.group,e,t),this},_animateBubble:function(t,i,a){u.animateTransform(e.delegate({shape:t,duration:1200,transform:[{name:"translate",start:[0,i],end:[0,0]},{name:"scale",start:[0,1/a],end:[1,1]},{name:"original"}]},this.animate)).play()}})});//# sourceMappingURL=Bubble.js.map