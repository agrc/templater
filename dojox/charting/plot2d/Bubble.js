//>>built
define("dojox/charting/plot2d/Bubble",["dojo/_base/lang","dojo/_base/declare","dojo/_base/array","dojo/has","./CartesianBase","./_PlotEvents","./common","dojox/lang/functional","dojox/lang/functional/reversed","dojox/lang/utils","dojox/gfx/fx"],function(e,t,r,i,a,n,o,s,d,l,u){var c=d.lambda("item.purgeGroup()");return t("dojox.charting.plot2d.Bubble",[a,n],{defaultParams:{animate:null},optionalParams:{stroke:{},outline:{},shadow:{},fill:{},filter:{},styleFunc:null,font:"",fontColor:"",labelFunc:null},constructor:function(t,r){this.opt=e.clone(e.mixin(this.opt,this.defaultParams)),l.updateWithObject(this.opt,r),l.updateWithPattern(this.opt,r,this.optionalParams),this.opt.labelFunc||(this.opt.labelFunc=function(e,t,r){return this._getLabel(e.size,t,r)}),this.animate=this.opt.animate},render:function(e,t){var a;if(this.zoom&&!this.isDataDirty())return this.performZoom(e,t);this.resetEvents(),this.dirty=this.isDirty(),this.dirty&&(r.forEach(this.series,c),this._eventSeries={},this.cleanGroup(),a=this.getGroup(),s.forEachRev(this.series,function(e){e.cleanGroup(a)}));for(var n=this.chart.theme,d=this._hScaler.scaler.getTransformerFromModel(this._hScaler),l=this._vScaler.scaler.getTransformerFromModel(this._vScaler),u=this.events(),f=0;f<this.series.length;f++){var m=this.series[f];if(this.dirty||m.dirty)if(m.cleanGroup(),m.data.length){if("number"!=typeof m.data[0]){var h=n.next("circle",[this.opt,m]),p=r.map(m.data,function(r){return r?{x:d(r.x)+t.l,y:e.height-t.b-l(r.y),radius:this._vScaler.bounds.scale*(r.size/2)}:null},this);if(m.hidden)m.dyn.fill=h.series.fill,m.dyn.stroke=h.series.stroke;else{a=m.group;var y=null,v=null,g=null,b=this.opt.styleFunc,M=function(e){return b?n.addMixin(h,"circle",[e,b(e)],!0):n.addMixin(h,"circle",e,!0)};if(h.series.shadow&&(g=r.map(p,function(r,i){if(!this.isNullValue(r)){var n=M(m.data[i]),o=n.series.shadow,s=a.createCircle({cx:r.x+o.dx,cy:r.y+o.dy,r:r.radius}).setStroke(o).setFill(o.color);return this.animate&&this._animateBubble(s,e.height-t.b,r.radius),s}return null},this),g.length&&(m.dyn.shadow=g[g.length-1].getStroke())),h.series.outline&&(v=r.map(p,function(r,i){if(!this.isNullValue(r)){var n=M(m.data[i]),s=o.makeStroke(n.series.outline);s.width=2*s.width+(h.series.stroke&&h.series.stroke.width||0);var d=a.createCircle({cx:r.x,cy:r.y,r:r.radius}).setStroke(s);return this.animate&&this._animateBubble(d,e.height-t.b,r.radius),d}return null},this),v.length&&(m.dyn.outline=v[v.length-1].getStroke())),y=r.map(p,function(r,i){if(!this.isNullValue(r)){var n=M(m.data[i]),o={x:r.x-r.radius,y:r.y-r.radius,width:2*r.radius,height:2*r.radius},s=this._plotFill(n.series.fill,e,t);s=this._shapeFill(s,o);var d=a.createCircle({cx:r.x,cy:r.y,r:r.radius}).setFill(s).setStroke(n.series.stroke);return d.setFilter&&n.series.filter&&d.setFilter(n.series.filter),this.animate&&this._animateBubble(d,e.height-t.b,r.radius),this.createLabel(a,m.data[i],o,n),d}return null},this),y.length&&(m.dyn.fill=y[y.length-1].getFill(),m.dyn.stroke=y[y.length-1].getStroke()),u){var w=new Array(y.length);r.forEach(y,function(e,t){if(null!==e){var r={element:"circle",index:t,run:m,shape:e,outline:v&&v[t]||null,shadow:g&&g[t]||null,x:m.data[t].x,y:m.data[t].y,r:m.data[t].size/2,cx:p[t].x,cy:p[t].y,cr:p[t].radius};this._connectEvents(r),w[t]=r}},this),this._eventSeries[m.name]=w}else delete this._eventSeries[m.name];m.dirty=!1}}}else m.dirty=!1,n.skip();else n.skip(),this._reconnectEvents(m.name)}return this.dirty=!1,i("dojo-bidi")&&this._checkOrientation(this.group,e,t),this},_animateBubble:function(t,r,i){u.animateTransform(e.delegate({shape:t,duration:1200,transform:[{name:"translate",start:[0,r],end:[0,0]},{name:"scale",start:[0,1/i],end:[1,1]},{name:"original"}]},this.animate)).play()}})});//# sourceMappingURL=Bubble.js.map