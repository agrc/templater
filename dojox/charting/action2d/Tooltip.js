//>>built
define("dojox/charting/action2d/Tooltip",["dijit/Tooltip","dojo/_base/lang","dojo/_base/declare","dojo/_base/window","dojo/_base/connect","dojo/dom-style","./PlotAction","dojox/gfx/matrix","dojo/has","dojo/has!dojo-bidi?../bidi/action2d/Tooltip","dojox/lang/functional","dojox/lang/functional/scan","dojox/lang/functional/fold"],function(e,t,a,i,r,o,d,n,l,s,m){var u=function(e,t){var a=e.run&&e.run.data&&e.run.data[e.index];return a&&"number"!=typeof a&&(a.tooltip||a.text)?a.tooltip||a.text:t.tooltipFunc?t.tooltipFunc(e):e.y},h=Math.PI/4,f=Math.PI/2,c=a(l("dojo-bidi")?"dojox.charting.action2d.NonBidiTooltip":"dojox.charting.action2d.Tooltip",d,{defaultParams:{text:u,mouseOver:!0},optionalParams:{},constructor:function(e,t,a){this.text=a&&a.text?a.text:u,this.mouseOver=a&&void 0!=a.mouseOver?a.mouseOver:!0,this.connect()},process:function(a){if("onplotreset"===a.type||"onmouseout"===a.type)return e.hide(this.aroundRect),this.aroundRect=null,void("onplotreset"===a.type&&delete this.angles);if(!(!a.shape||this.mouseOver&&"onmouseover"!==a.type||!this.mouseOver&&"onclick"!==a.type)){var o={type:"rect"},d=["after-centered","before-centered"];switch(a.element){case"marker":o.x=a.cx,o.y=a.cy,o.w=o.h=1;break;case"circle":o.x=a.cx-a.cr,o.y=a.cy-a.cr,o.w=o.h=2*a.cr;break;case"spider_circle":o.x=a.cx,o.y=a.cy,o.w=o.h=1;break;case"spider_plot":return;case"column":d=["above-centered","below-centered"];case"bar":o=t.clone(a.shape.getShape()),o.w=o.width,o.h=o.height;break;case"candlestick":o.x=a.x,o.y=a.y,o.w=a.width,o.h=a.height;break;default:if(!this.angles){var s="number"==typeof a.run.data[0]?m.map(a.run.data,"x ? Math.max(x, 0) : 0"):m.map(a.run.data,"x ? Math.max(x.y, 0) : 0");this.angles=m.map(m.scanl(s,"+",0),"* 2 * Math.PI / this",m.foldl(s,"+",0))}var u=n._degToRad(a.plot.opt.startAngle),c=(this.angles[a.index]+this.angles[a.index+1])/2+u;o.x=a.cx+a.cr*Math.cos(c),o.y=a.cy+a.cr*Math.sin(c),o.w=o.h=1,u&&(0>c||c>2*Math.PI)&&(c=Math.abs(2*Math.PI-Math.abs(c))),h>c||(f+h>c?d=["below-centered","above-centered"]:c<Math.PI+h?d=["before-centered","after-centered"]:c<2*Math.PI-h&&(d=["above-centered","below-centered"]))}l("dojo-bidi")&&this._recheckPosition(a,o,d);var y=this.chart.getCoords();o.x+=y.x,o.y+=y.y,o.x=Math.round(o.x),o.y=Math.round(o.y),o.w=Math.ceil(o.w),o.h=Math.ceil(o.h),this.aroundRect=o;var v=this.text(a,this.plot);v&&e.show(this._format(v),this.aroundRect,d),this.mouseOver||(this._handle=r.connect(i.doc,"onclick",this,"onClick"))}},onClick:function(){this.process({type:"onmouseout"})},_recheckPosition:function(e,t,a){},_format:function(e){return e}});return l("dojo-bidi")?a("dojox.charting.action2d.Tooltip",[c,s]):c});//# sourceMappingURL=Tooltip.js.map