//>>built
define("dojox/charting/action2d/MouseZoomAndPan",["dojo/_base/declare","dojo/_base/window","dojo/_base/array","dojo/_base/event","dojo/_base/connect","dojo/mouse","./ChartAction","dojo/sniff","dojo/dom-prop","dojo/keys","dojo/has!dojo-bidi?../bidi/action2d/ZoomAndPan"],function(e,t,r,i,a,n,o,s,d,l,u){var c=s("mozilla")?3:120,f={none:function(e){return!e.ctrlKey&&!e.altKey&&!e.shiftKey},ctrl:function(e){return e.ctrlKey&&!e.altKey&&!e.shiftKey},alt:function(e){return!e.ctrlKey&&e.altKey&&!e.shiftKey},shift:function(e){return!e.ctrlKey&&!e.altKey&&e.shiftKey}},m=e(s("dojo-bidi")?"dojox.charting.action2d.NonBidiMouseZoomAndPan":"dojox.charting.action2d.MouseZoomAndPan",o,{defaultParams:{axis:"x",scaleFactor:1.2,maxScale:100,enableScroll:!0,enableDoubleClickZoom:!0,enableKeyZoom:!0,keyZoomModifier:"ctrl"},optionalParams:{},constructor:function(e,t,r){this._listeners=[{eventName:n.wheel,methodName:"onMouseWheel"}],r||(r={}),this.axis=r.axis?r.axis:"x",this.scaleFactor=r.scaleFactor?r.scaleFactor:1.2,this.maxScale=r.maxScale?r.maxScale:100,this.enableScroll=void 0==r.enableScroll||r.enableScroll,this.enableDoubleClickZoom=void 0==r.enableDoubleClickZoom||r.enableDoubleClickZoom,this.enableKeyZoom=void 0==r.enableKeyZoom||r.enableKeyZoom,this.keyZoomModifier=r.keyZoomModifier?r.keyZoomModifier:"ctrl",this.enableScroll&&this._listeners.push({eventName:"onmousedown",methodName:"onMouseDown"}),this.enableDoubleClickZoom&&this._listeners.push({eventName:"ondblclick",methodName:"onDoubleClick"}),this.enableKeyZoom&&this._listeners.push({eventName:"keypress",methodName:"onKeyPress"}),this._handles=[],this.connect()},_disconnectHandles:function(){s("ie")&&this.chart.node.releaseCapture(),r.forEach(this._handles,a.disconnect),this._handles=[]},connect:function(){this.inherited(arguments),this.enableKeyZoom&&d.set(this.chart.node,"tabindex","0")},disconnect:function(){this.inherited(arguments),this.enableKeyZoom&&d.set(this.chart.node,"tabindex","-1"),this._disconnectHandles()},onMouseDown:function(e){var r=this.chart,n=r.getAxis(this.axis);n.vertical?this._startCoord=e.pageY:this._startCoord=e.pageX,this._startOffset=n.getWindowOffset(),this._isPanning=!0,s("ie")?(this._handles.push(a.connect(this.chart.node,"onmousemove",this,"onMouseMove")),this._handles.push(a.connect(this.chart.node,"onmouseup",this,"onMouseUp")),this.chart.node.setCapture()):(this._handles.push(a.connect(t.doc,"onmousemove",this,"onMouseMove")),this._handles.push(a.connect(t.doc,"onmouseup",this,"onMouseUp"))),r.node.focus(),i.stop(e)},onMouseMove:function(e){if(this._isPanning){var t=this.chart,r=t.getAxis(this.axis),i=this._getDelta(e),a=r.getScaler().bounds,n=a.span/(a.upper-a.lower),o=r.getWindowScale();t.setAxisWindow(this.axis,o,this._startOffset-i/n/o),t.render()}},onMouseUp:function(e){this._isPanning=!1,this._disconnectHandles()},onMouseWheel:function(e){var t=e.wheelDelta/c;t>-1&&t<0?t=-1:t>0&&t<1&&(t=1),this._onZoom(t,e)},onKeyPress:function(e){f[this.keyZoomModifier](e)&&("+"==e.keyChar||e.keyCode==l.NUMPAD_PLUS?this._onZoom(1,e):"-"!=e.keyChar&&e.keyCode!=l.NUMPAD_MINUS||this._onZoom(-1,e))},onDoubleClick:function(e){var t=this.chart,r=t.getAxis(this.axis),a=1/this.scaleFactor;if(1==r.getWindowScale()){var n=r.getScaler(),o=n.bounds.from,s=n.bounds.to,d=(o+s)/2,l=this.plot.toData({x:e.pageX,y:e.pageY})[this.axis],u=a*(o-d)+l,c=a*(s-d)+l;t.zoomIn(this.axis,[u,c])}else t.setAxisWindow(this.axis,1,0),t.render();i.stop(e)},_onZoom:function(e,t){var r=e<0?Math.abs(e)*this.scaleFactor:1/(Math.abs(e)*this.scaleFactor),a=this.chart,n=a.getAxis(this.axis);if(!(n.getWindowScale()/r>this.maxScale)){var o=n.getScaler(),s=o.bounds.from,d=o.bounds.to,l="keypress"==t.type?(s+d)/2:this.plot.toData({x:t.pageX,y:t.pageY})[this.axis],u=r*(s-l)+l,c=r*(d-l)+l;a.zoomIn(this.axis,[u,c]),i.stop(t)}},_getDelta:function(e){return this.chart.getAxis(this.axis).vertical?this._startCoord-e.pageY:e.pageX-this._startCoord}});return s("dojo-bidi")?e("dojox.charting.action2d.MouseZoomAndPan",[m,u]):m});//# sourceMappingURL=MouseZoomAndPan.js.map