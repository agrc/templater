//>>built
define("dojox/grid/cells/dijit",["dojo/_base/kernel","../../main","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/_base/json","dojo/_base/connect","dojo/_base/sniff","dojo/dom","dojo/dom-attr","dojo/dom-construct","dojo/dom-style","dojo/dom-geometry","dojo/data/ItemFileReadStore","dijit/form/DateTextBox","dijit/form/TimeTextBox","dijit/form/ComboBox","dijit/form/CheckBox","dijit/form/TextBox","dijit/form/NumberSpinner","dijit/form/NumberTextBox","dijit/form/CurrencyTextBox","dijit/form/HorizontalSlider","dijit/form/_TextBoxMixin","dijit/Editor","../util","./_base"],function(e,t,i,r,a,n,o,s,l,d,u,c,h,m,f,p,g,y,v,b,x,M,w,_,k,j,C){var I={},F=I._Widget=i("dojox.grid.cells._Widget",C,{widgetClass:v,constructor:function(t){this.widget=null,"string"==typeof this.widgetClass&&(e.deprecated("Passing a string to widgetClass is deprecated","pass the widget class object instead","2.0"),this.widgetClass=a.getObject(this.widgetClass))},formatEditing:function(e,t){return this.needFormatNode(e,t),"<div></div>"},getValue:function(e){return this.widget.get("value")},_unescapeHTML:function(e){return e&&e.replace&&this.grid.escapeHTMLInData?e.replace(/&lt;/g,"<").replace(/&amp;/g,"&"):e},setValue:function(e,t){if(this.widget&&this.widget.set)if(t=this._unescapeHTML(t),this.widget.onLoadDeferred){var i=this;this.widget.onLoadDeferred.addCallback(function(){i.widget.set("value",null===t?"":t)})}else this.widget.set("value",t);else this.inherited(arguments)},getWidgetProps:function(e){return a.mixin({dir:this.dir,lang:this.lang},this.widgetProps||{},{constraints:a.mixin({},this.constraint)||{},required:(this.constraint||{}).required,value:this._unescapeHTML(e)})},createWidget:function(e,t,i){return new this.widgetClass(this.getWidgetProps(t),e)},attachWidget:function(e,t,i){e.appendChild(this.widget.domNode),this.setValue(i,t)},formatNode:function(e,t,i){return this.widgetClass?(this.widget?this.attachWidget.apply(this,arguments):this.widget=this.createWidget.apply(this,arguments),this.sizeWidget.apply(this,arguments),this.grid.views.renormalizeRow(i),this.grid.scroller.rowHeightChanged(i,!0),void this.focus()):t},sizeWidget:function(t,i,r){var a=this.getNode(r);e.marginBox(this.widget.domNode,{w:c.get(a,"width")})},focus:function(e,t){this.widget&&setTimeout(a.hitch(this.widget,function(){j.fire(this,"focus"),this.focusNode&&"INPUT"===this.focusNode.tagName&&_.selectInputText(this.focusNode)}),0)},_finish:function(e){this.inherited(arguments),j.removeNode(this.widget.domNode),s("ie")&&l.setSelectable(this.widget.domNode,!0)}});F.markupFactory=function(e,t){C.markupFactory(e,t);var i=a.trim(d.get(e,"widgetProps")||""),r=a.trim(d.get(e,"constraint")||""),o=a.trim(d.get(e,"widgetClass")||"");i&&(t.widgetProps=n.fromJson(i)),r&&(t.constraint=n.fromJson(r)),o&&(t.widgetClass=a.getObject(o))};var g=I.ComboBox=i("dojox.grid.cells.ComboBox",F,{widgetClass:g,getWidgetProps:function(e){var t=[];r.forEach(this.options,function(e){t.push({name:e,value:e})});var i=new m({data:{identifier:"name",items:t}});return a.mixin({},this.widgetProps||{},{value:e,store:i})},getValue:function(){var e=this.widget;return e.set("displayedValue",e.get("displayedValue")),e.get("value")}});g.markupFactory=function(e,t){F.markupFactory(e,t);var i=a.trim(d.get(e,"options")||"");if(i){var r=i.split(",");r[0]!=i&&(t.options=r)}};var f=I.DateTextBox=i("dojox.grid.cells.DateTextBox",F,{widgetClass:f,setValue:function(e,t){this.widget?this.widget.set("value",new Date(t)):this.inherited(arguments)},getWidgetProps:function(e){return a.mixin(this.inherited(arguments),{value:new Date(e)})}});f.markupFactory=function(e,t){F.markupFactory(e,t)};var y=I.CheckBox=i("dojox.grid.cells.CheckBox",F,{widgetClass:y,getValue:function(){return this.widget.checked},setValue:function(e,t){this.widget&&this.widget.attributeMap.checked?this.widget.set("checked",t):this.inherited(arguments)},sizeWidget:function(e,t,i){}});y.markupFactory=function(e,t){F.markupFactory(e,t)};var k=I.Editor=i("dojox.grid.cells.Editor",F,{widgetClass:k,getWidgetProps:function(e){return a.mixin({},this.widgetProps||{},{height:this.widgetHeight||"100px"})},createWidget:function(e,t,i){var r=new this.widgetClass(this.getWidgetProps(t),e);return r.onLoadDeferred.then(a.hitch(this,"populateEditor")),r},formatNode:function(e,t,i){if(this.content=t,this.inherited(arguments),s("mozilla")){var r=this.widget;r.open(),this.widgetToolbar&&u.place(r.toolbar.domNode,r.editingArea,"before")}},populateEditor:function(){this.widget.set("value",this.content),this.widget.placeCursorAtEnd()}});return k.markupFactory=function(e,t){F.markupFactory(e,t);var i=a.trim(d.get(e,"widgetHeight")||"");i&&("auto"!=i&&"em"!=i.substr(-2)&&(i=parseInt(i,10)+"px"),t.widgetHeight=i)},I});//# sourceMappingURL=dijit.js.map