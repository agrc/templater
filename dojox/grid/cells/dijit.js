//>>built
define("dojox/grid/cells/dijit",["dojo/_base/kernel","../../main","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/_base/json","dojo/_base/connect","dojo/_base/sniff","dojo/dom","dojo/dom-attr","dojo/dom-construct","dojo/dom-style","dojo/dom-geometry","dojo/data/ItemFileReadStore","dijit/form/DateTextBox","dijit/form/TimeTextBox","dijit/form/ComboBox","dijit/form/CheckBox","dijit/form/TextBox","dijit/form/NumberSpinner","dijit/form/NumberTextBox","dijit/form/CurrencyTextBox","dijit/form/HorizontalSlider","dijit/form/_TextBoxMixin","dijit/Editor","../util","./_base"],function(e,t,i,a,o,r,n,s,d,l,h,u,c,m,f,p,y,g,v,b,M,k,x,w,_,I,T){var j={},C=j._Widget=i("dojox.grid.cells._Widget",T,{widgetClass:v,constructor:function(t){this.widget=null,"string"==typeof this.widgetClass&&(e.deprecated("Passing a string to widgetClass is deprecated","pass the widget class object instead","2.0"),this.widgetClass=o.getObject(this.widgetClass))},formatEditing:function(e,t){return this.needFormatNode(e,t),"<div></div>"},getValue:function(e){return this.widget.get("value")},_unescapeHTML:function(e){return e&&e.replace&&this.grid.escapeHTMLInData?e.replace(/&lt;/g,"<").replace(/&amp;/g,"&"):e},setValue:function(e,t){if(this.widget&&this.widget.set)if(t=this._unescapeHTML(t),this.widget.onLoadDeferred){var i=this;this.widget.onLoadDeferred.addCallback(function(){i.widget.set("value",null===t?"":t)})}else this.widget.set("value",t);else this.inherited(arguments)},getWidgetProps:function(e){return o.mixin({dir:this.dir,lang:this.lang},this.widgetProps||{},{constraints:o.mixin({},this.constraint)||{},required:(this.constraint||{}).required,value:this._unescapeHTML(e)})},createWidget:function(e,t,i){return new this.widgetClass(this.getWidgetProps(t),e)},attachWidget:function(e,t,i){e.appendChild(this.widget.domNode),this.setValue(i,t)},formatNode:function(e,t,i){return this.widgetClass?(this.widget?this.attachWidget.apply(this,arguments):this.widget=this.createWidget.apply(this,arguments),this.sizeWidget.apply(this,arguments),this.grid.views.renormalizeRow(i),this.grid.scroller.rowHeightChanged(i,!0),void this.focus()):t},sizeWidget:function(t,i,a){var o=this.getNode(a);e.marginBox(this.widget.domNode,{w:u.get(o,"width")})},focus:function(e,t){this.widget&&setTimeout(o.hitch(this.widget,function(){I.fire(this,"focus"),this.focusNode&&"INPUT"===this.focusNode.tagName&&w.selectInputText(this.focusNode)}),0)},_finish:function(e){this.inherited(arguments),I.removeNode(this.widget.domNode),s("ie")&&d.setSelectable(this.widget.domNode,!0)}});C.markupFactory=function(e,t){T.markupFactory(e,t);var i=o.trim(l.get(e,"widgetProps")||""),a=o.trim(l.get(e,"constraint")||""),n=o.trim(l.get(e,"widgetClass")||"");i&&(t.widgetProps=r.fromJson(i)),a&&(t.constraint=r.fromJson(a)),n&&(t.widgetClass=o.getObject(n))};var y=j.ComboBox=i("dojox.grid.cells.ComboBox",C,{widgetClass:y,getWidgetProps:function(e){var t=[];a.forEach(this.options,function(e){t.push({name:e,value:e})});var i=new m({data:{identifier:"name",items:t}});return o.mixin({},this.widgetProps||{},{value:e,store:i})},getValue:function(){var e=this.widget;return e.set("displayedValue",e.get("displayedValue")),e.get("value")}});y.markupFactory=function(e,t){C.markupFactory(e,t);var i=o.trim(l.get(e,"options")||"");if(i){var a=i.split(",");a[0]!=i&&(t.options=a)}};var f=j.DateTextBox=i("dojox.grid.cells.DateTextBox",C,{widgetClass:f,setValue:function(e,t){this.widget?this.widget.set("value",new Date(t)):this.inherited(arguments)},getWidgetProps:function(e){return o.mixin(this.inherited(arguments),{value:new Date(e)})}});f.markupFactory=function(e,t){C.markupFactory(e,t)};var g=j.CheckBox=i("dojox.grid.cells.CheckBox",C,{widgetClass:g,getValue:function(){return this.widget.checked},setValue:function(e,t){this.widget&&this.widget.attributeMap.checked?this.widget.set("checked",t):this.inherited(arguments)},sizeWidget:function(e,t,i){}});g.markupFactory=function(e,t){C.markupFactory(e,t)};var _=j.Editor=i("dojox.grid.cells.Editor",C,{widgetClass:_,getWidgetProps:function(e){return o.mixin({},this.widgetProps||{},{height:this.widgetHeight||"100px"})},createWidget:function(e,t,i){var a=new this.widgetClass(this.getWidgetProps(t),e);return a.onLoadDeferred.then(o.hitch(this,"populateEditor")),a},formatNode:function(e,t,i){if(this.content=t,this.inherited(arguments),s("mozilla")){var a=this.widget;a.open(),this.widgetToolbar&&h.place(a.toolbar.domNode,a.editingArea,"before")}},populateEditor:function(){this.widget.set("value",this.content),this.widget.placeCursorAtEnd()}});return _.markupFactory=function(e,t){C.markupFactory(e,t);var i=o.trim(l.get(e,"widgetHeight")||"");i&&("auto"!=i&&"em"!=i.substr(-2)&&(i=parseInt(i,10)+"px"),t.widgetHeight=i)},j});//# sourceMappingURL=dijit.js.map