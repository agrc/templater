//>>built
define("dojox/grid/cells/dijit",["dojo/_base/kernel","../../main","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/_base/json","dojo/_base/connect","dojo/_base/sniff","dojo/dom","dojo/dom-attr","dojo/dom-construct","dojo/dom-style","dojo/dom-geometry","dojo/data/ItemFileReadStore","dijit/form/DateTextBox","dijit/form/TimeTextBox","dijit/form/ComboBox","dijit/form/CheckBox","dijit/form/TextBox","dijit/form/NumberSpinner","dijit/form/NumberTextBox","dijit/form/CurrencyTextBox","dijit/form/HorizontalSlider","dijit/form/_TextBoxMixin","dijit/Editor","../util","./_base"],function(e,t,a,i,r,n,o,s,l,d,m,u,h,c,f,g,p,y,v,k,b,M,w,x,_,j,I){var F={},S=F._Widget=a("dojox.grid.cells._Widget",I,{widgetClass:v,constructor:function(t){this.widget=null,"string"==typeof this.widgetClass&&(e.deprecated("Passing a string to widgetClass is deprecated","pass the widget class object instead","2.0"),this.widgetClass=r.getObject(this.widgetClass))},formatEditing:function(e,t){return this.needFormatNode(e,t),"<div></div>"},getValue:function(e){return this.widget.get("value")},_unescapeHTML:function(e){return e&&e.replace&&this.grid.escapeHTMLInData?e.replace(/&lt;/g,"<").replace(/&amp;/g,"&"):e},setValue:function(e,t){if(this.widget&&this.widget.set)if(t=this._unescapeHTML(t),this.widget.onLoadDeferred){var a=this;this.widget.onLoadDeferred.addCallback(function(){a.widget.set("value",null===t?"":t)})}else this.widget.set("value",t);else this.inherited(arguments)},getWidgetProps:function(e){return r.mixin({dir:this.dir,lang:this.lang},this.widgetProps||{},{constraints:r.mixin({},this.constraint)||{},required:(this.constraint||{}).required,value:this._unescapeHTML(e)})},createWidget:function(e,t,a){return new this.widgetClass(this.getWidgetProps(t),e)},attachWidget:function(e,t,a){e.appendChild(this.widget.domNode),this.setValue(a,t)},formatNode:function(e,t,a){if(!this.widgetClass)return t;this.widget?this.attachWidget.apply(this,arguments):this.widget=this.createWidget.apply(this,arguments),this.sizeWidget.apply(this,arguments),this.grid.views.renormalizeRow(a),this.grid.scroller.rowHeightChanged(a,!0),this.focus()},sizeWidget:function(t,a,i){var r=this.getNode(i);e.marginBox(this.widget.domNode,{w:u.get(r,"width")})},focus:function(e,t){this.widget&&setTimeout(r.hitch(this.widget,function(){j.fire(this,"focus"),this.focusNode&&"INPUT"===this.focusNode.tagName&&x.selectInputText(this.focusNode)}),0)},_finish:function(e){this.inherited(arguments),j.removeNode(this.widget.domNode),s("ie")&&l.setSelectable(this.widget.domNode,!0)}});S.markupFactory=function(e,t){I.markupFactory(e,t);var a=r.trim(d.get(e,"widgetProps")||""),i=r.trim(d.get(e,"constraint")||""),o=r.trim(d.get(e,"widgetClass")||"");a&&(t.widgetProps=n.fromJson(a)),i&&(t.constraint=n.fromJson(i)),o&&(t.widgetClass=r.getObject(o))};var p=F.ComboBox=a("dojox.grid.cells.ComboBox",S,{widgetClass:p,getWidgetProps:function(e){var t=[];i.forEach(this.options,function(e){t.push({name:e,value:e})});var a=new c({data:{identifier:"name",items:t}});return r.mixin({},this.widgetProps||{},{value:e,store:a})},getValue:function(){var e=this.widget;return e.set("displayedValue",e.get("displayedValue")),e.get("value")}});p.markupFactory=function(e,t){S.markupFactory(e,t);var a=r.trim(d.get(e,"options")||"");if(a){var i=a.split(",");i[0]!=a&&(t.options=i)}};var f=F.DateTextBox=a("dojox.grid.cells.DateTextBox",S,{widgetClass:f,setValue:function(e,t){this.widget?this.widget.set("value",new Date(t)):this.inherited(arguments)},getWidgetProps:function(e){return r.mixin(this.inherited(arguments),{value:new Date(e)})}});f.markupFactory=function(e,t){S.markupFactory(e,t)};var y=F.CheckBox=a("dojox.grid.cells.CheckBox",S,{widgetClass:y,getValue:function(){return this.widget.checked},setValue:function(e,t){this.widget&&this.widget.attributeMap.checked?this.widget.set("checked",t):this.inherited(arguments)},sizeWidget:function(e,t,a){}});y.markupFactory=function(e,t){S.markupFactory(e,t)};var _=F.Editor=a("dojox.grid.cells.Editor",S,{widgetClass:_,getWidgetProps:function(e){return r.mixin({},this.widgetProps||{},{height:this.widgetHeight||"100px"})},createWidget:function(e,t,a){var i=new this.widgetClass(this.getWidgetProps(t),e);return i.onLoadDeferred.then(r.hitch(this,"populateEditor")),i},formatNode:function(e,t,a){if(this.content=t,this.inherited(arguments),s("mozilla")){var i=this.widget;i.open(),this.widgetToolbar&&m.place(i.toolbar.domNode,i.editingArea,"before")}},populateEditor:function(){this.widget.set("value",this.content),this.widget.placeCursorAtEnd()}});return _.markupFactory=function(e,t){S.markupFactory(e,t);var a=r.trim(d.get(e,"widgetHeight")||"");a&&("auto"!=a&&"em"!=a.substr(-2)&&(a=parseInt(a,10)+"px"),t.widgetHeight=a)},F});//# sourceMappingURL=dijit.js.map