//>>built
define("dojox/grid/cells/_base",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/lang","dojo/_base/event","dojo/_base/connect","dojo/_base/array","dojo/_base/sniff","dojo/dom","dojo/dom-attr","dojo/dom-construct","dijit/_Widget","../util"],function(e,t,i,r,a,o,n,s,d,l,u,c){var h=t("dojox.grid._DeferredTextWidget",u,{deferred:null,_destroyOnRemove:!0,postCreate:function(){this.deferred&&this.deferred.addBoth(i.hitch(this,function(e){this.domNode&&(this.domNode.innerHTML=e)}))}}),f=function(e){try{c.fire(e,"focus"),c.fire(e,"select")}catch(t){}},m=function(){setTimeout(i.hitch.apply(e,arguments),0)},p=t("dojox.grid.cells._Base",null,{styles:"",classes:"",editable:!1,alwaysEditing:!1,formatter:null,defaultValue:"...",value:null,hidden:!1,noresize:!1,draggable:!0,_valueProp:"value",_formatPending:!1,constructor:function(e){this._props=e||{},i.mixin(this,e),void 0===this.draggable&&(this.draggable=!0)},_defaultFormat:function(e,t){var i=this.grid.formatterScope||this,r=this.formatter;r&&i&&"string"==typeof r&&(r=this.formatter=i[r]);var a=e!=this.defaultValue&&r?r.apply(i,t):e;return"undefined"==typeof a?this.defaultValue:(a&&a.addBoth&&(a=new h({deferred:a},l.create("span",{innerHTML:this.defaultValue}))),a&&a.declaredClass&&a.startup?"<div class='dojoxGridStubNode' linkWidget='"+a.id+"' cellIdx='"+this.index+"'>"+this.defaultValue+"</div>":a)},format:function(e,t){var i=this.grid.edit.info,r=this.get?this.get(e,t):this.value||this.defaultValue;return r=r&&r.replace&&this.grid.escapeHTMLInData?r.replace(/&/g,"&amp;").replace(/</g,"&lt;"):r,this.editable&&(this.alwaysEditing||i.rowIndex==e&&i.cell==this)?this.formatEditing(i.value?i.value:r,e):this._defaultFormat(r,[r,e,this])},formatEditing:function(e,t){},getNode:function(e){return this.view.getCellNode(e,this.index)},getHeaderNode:function(){return this.view.getHeaderCellNode(this.index)},getEditNode:function(e){return(this.getNode(e)||0).firstChild||0},canResize:function(){var e=this.unitWidth;return e&&"auto"!==e},isFlex:function(){var e=this.unitWidth;return e&&i.isString(e)&&("auto"==e||"%"==e.slice(-1))},applyEdit:function(e,t){this.getNode(t)&&this.grid.edit.applyCellEdit(e,this,t)},cancelEdit:function(e){this.grid.doCancelEdit(e)},_onEditBlur:function(e){this.grid.edit.isEditCell(e,this.index)&&this.grid.edit.apply()},registerOnBlur:function(e,t){this.commitOnBlur&&a.connect(e,"onblur",function(e){setTimeout(i.hitch(this,"_onEditBlur",t),250)})},needFormatNode:function(e,t){this._formatPending=!0,m(this,"_formatNode",e,t)},cancelFormatNode:function(){this._formatPending=!1},_formatNode:function(e,t){this._formatPending&&(this._formatPending=!1,n("ie")||s.setSelectable(this.grid.domNode,!0),this.formatNode(this.getEditNode(t),e,t))},formatNode:function(e,t,i){n("ie")?m(this,"focus",i,e):this.focus(i,e)},dispatchEvent:function(e,t){return e in this?this[e](t):void 0},getValue:function(e){return this.getEditNode(e)[this._valueProp]},setValue:function(e,t){var i=this.getEditNode(e);i&&(i[this._valueProp]=t)},focus:function(e,t){f(t||this.getEditNode(e))},save:function(e){this.value=this.value||this.getValue(e)},restore:function(e){this.setValue(e,this.value)},_finish:function(e){s.setSelectable(this.grid.domNode,!1),this.cancelFormatNode()},apply:function(e){this.applyEdit(this.getValue(e),e),this._finish(e)},cancel:function(e){this.cancelEdit(e),this._finish(e)}});p.markupFactory=function(e,t){var r=i.trim(d.get(e,"formatter")||"");r&&(t.formatter=i.getObject(r)||r);var a=i.trim(d.get(e,"get")||"");a&&(t.get=i.getObject(a));var o=function(t,r,a){var o=i.trim(d.get(e,t)||"");o&&(r[a||t]=!("false"==o.toLowerCase()))};o("sortDesc",t),o("editable",t),o("alwaysEditing",t),o("noresize",t),o("draggable",t);var n=i.trim(d.get(e,"loadingText")||d.get(e,"defaultValue")||"");n&&(t.defaultValue=n);var s=function(t,r,a){var o=i.trim(d.get(e,t)||"")||void 0;o&&(r[a||t]=o)};s("styles",t),s("headerStyles",t),s("cellStyles",t),s("classes",t),s("headerClasses",t),s("cellClasses",t)};var g=p.Cell=t("dojox.grid.cells.Cell",p,{constructor:function(){this.keyFilter=this.keyFilter},keyFilter:null,formatEditing:function(e,t){return this.needFormatNode(e,t),'<input class="dojoxGridInput" type="text" value="'+e+'">'},formatNode:function(e,t,i){this.inherited(arguments),this.registerOnBlur(e,i)},doKey:function(e){if(this.keyFilter){var t=String.fromCharCode(e.charCode);-1==t.search(this.keyFilter)&&r.stop(e)}},_finish:function(e){this.inherited(arguments);var t=this.getEditNode(e);try{c.fire(t,"blur")}catch(i){}}});g.markupFactory=function(e,t){p.markupFactory(e,t);var r=i.trim(d.get(e,"keyFilter")||"");r&&(t.keyFilter=new RegExp(r))};var y=p.RowIndex=t("dojox.grid.cells.RowIndex",g,{name:"Row",postscript:function(){this.editable=!1},get:function(e){return e+1}});y.markupFactory=function(e,t){g.markupFactory(e,t)};var v=p.Select=t("dojox.grid.cells.Select",g,{options:null,values:null,returnIndex:-1,constructor:function(e){this.values=this.values||this.options},formatEditing:function(e,t){this.needFormatNode(e,t);for(var i,r,a=['<select class="dojoxGridSelect">'],o=0;void 0!==(i=this.options[o])&&void 0!==(r=this.values[o]);o++)r=r.replace?r.replace(/&/g,"&amp;").replace(/</g,"&lt;"):r,i=i.replace?i.replace(/&/g,"&amp;").replace(/</g,"&lt;"):i,a.push("<option",e==r?" selected":"",' value="'+r+'"',">",i,"</option>");return a.push("</select>"),a.join("")},_defaultFormat:function(e,t){var i=this.inherited(arguments);if(!this.formatter&&this.values&&this.options){var r=o.indexOf(this.values,i);r>=0&&(i=this.options[r])}return i},getValue:function(e){var t=this.getEditNode(e);if(t){var i=t.selectedIndex,r=t.options[i];return this.returnIndex>-1?i:r.value||r.innerHTML}}});v.markupFactory=function(e,t){g.markupFactory(e,t);var r=i.trim(d.get(e,"options")||"");if(r){var a=r.split(",");a[0]!=r&&(t.options=a)}var o=i.trim(d.get(e,"values")||"");if(o){var n=o.split(",");n[0]!=o&&(t.values=n)}};var b=p.AlwaysEdit=t("dojox.grid.cells.AlwaysEdit",g,{alwaysEditing:!0,_formatNode:function(e,t){this.formatNode(this.getEditNode(t),e,t)},applyStaticValue:function(e){var t=this.grid.edit;t.applyCellEdit(this.getValue(e),this,e),t.start(this,e,!0)}});b.markupFactory=function(e,t){g.markupFactory(e,t)};var M=p.Bool=t("dojox.grid.cells.Bool",b,{_valueProp:"checked",formatEditing:function(e,t){return'<input class="dojoxGridInput" type="checkbox"'+(e?' checked="checked"':"")+' style="width: auto" />'},doclick:function(e){"INPUT"==e.target.tagName&&this.applyStaticValue(e.rowIndex)}});return M.markupFactory=function(e,t){b.markupFactory(e,t)},p});//# sourceMappingURL=_base.js.map