//>>built
define("dojox/grid/enhanced/plugins/AutoScroll",["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/_base/html","dojo/_base/window","../_Plugin","../../_RowSelector","../../EnhancedGrid"],function(e,t,i,a,n,o,r,s){var l=e("dojox.grid.enhanced.plugins.AutoScroll",o,{name:"autoScroll",autoScrollInterval:1e3,autoScrollMargin:30,constructor:function(e,t){this.grid=e,this.readyForAutoScroll=!1,this._scrolling=!1,t=i.isObject(t)?t:{},"interval"in t&&(this.autoScrollInterval=t.interval),"margin"in t&&(this.autoScrollMargin=t.margin),this._initEvents(),this._mixinGrid()},_initEvents:function(){var e=this.grid;this.connect(e,"onCellMouseDown",function(){this.readyForAutoScroll=!0}),this.connect(e,"onHeaderCellMouseDown",function(){this.readyForAutoScroll=!0}),this.connect(e,"onRowSelectorMouseDown",function(){this.readyForAutoScroll=!0}),this.connect(n.doc,"onmouseup",function(e){this._manageAutoScroll(!0),this.readyForAutoScroll=!1}),this.connect(n.doc,"onmousemove",function(i){if(this.readyForAutoScroll){this._event=i;var n=a.position(e.domNode),o=e._getHeaderHeight(),s=this.autoScrollMargin,l=i.clientY,d=i.clientX,u=n.y,h=n.x,c=n.h,m=n.w;if(d>=h&&d<=h+m){if(l>=u+o&&l<u+o+s)return void this._manageAutoScroll(!1,!0,!1);if(l>u+c-s&&l<=u+c)return void this._manageAutoScroll(!1,!0,!0);if(l>=u&&l<=u+c){if(t.some(e.views.views,function(e,t){if(e instanceof r)return!1;var i=a.position(e.domNode);return d<i.x+s&&d>=i.x?(this._manageAutoScroll(!1,!1,!1,e),!0):d>i.x+i.w-s&&d<i.x+i.w&&(this._manageAutoScroll(!1,!1,!0,e),!0)},this))return}}this._manageAutoScroll(!0)}})},_mixinGrid:function(){var e=this.grid;e.onStartAutoScroll=function(){},e.onEndAutoScroll=function(){}},_fireEvent:function(e,t){var i=this.grid;switch(e){case"start":i.onStartAutoScroll.apply(i,t);break;case"end":i.onEndAutoScroll.apply(i,t)}},_manageAutoScroll:function(e,t,a,n){e?(this._scrolling=!1,clearInterval(this._handler)):this._scrolling||(this._scrolling=!0,this._fireEvent("start",[t,a,n]),this._autoScroll(t,a,n),this._handler=setInterval(i.hitch(this,"_autoScroll",t,a,n),this.autoScrollInterval))},_autoScroll:function(e,t,i){var a=this.grid,n=null;if(e){var o=a.scroller.firstVisibleRow+(t?1:-1);o>=0&&o<a.rowCount&&(a.scrollToRow(o),n=o)}else n=this._scrollColumn(t,i);null!==n&&this._fireEvent("end",[e,t,i,n,this._event])},_scrollColumn:function(e,i){var n=i.scrollboxNode,o=null;if(n.clientWidth<n.scrollWidth){var r,s,l,d,u=t.filter(this.grid.layout.cells,function(e){return!e.hidden}),h=a.position(i.domNode);if(e){for(r=n.clientWidth,d=0;d<u.length;++d)if(l=a.position(u[d].getHeaderNode()),(s=l.x-h.x+l.w)>r){o=u[d].index,n.scrollLeft+=s-r+10;break}}else for(r=0,d=u.length-1;d>=0;--d)if(l=a.position(u[d].getHeaderNode()),(s=l.x-h.x)<r){o=u[d].index,n.scrollLeft+=s-r-10;break}}return o}});return s.registerPlugin(l),l});//# sourceMappingURL=AutoScroll.js.map