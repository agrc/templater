//>>built
require({cache:{"url:dojox/grid/enhanced/templates/FilterBar.html":'<table class="dojoxGridFBar" border="0" cellspacing="0" role="presentation" dojoAttachEvent="onclick:_onClickFilterBar, onmouseenter:_onMouseEnter, onmouseleave:_onMouseLeave, onmousemove:_onMouseMove"\n	><tr><td class="dojoxGridFBarBtnTD"\n		><span dojoType="dijit.form.Button" class="dojoxGridFBarBtn" dojoAttachPoint="defineFilterButton" label="..." iconClass="dojoxGridFBarDefFilterBtnIcon" showLabel="true" dojoAttachEvent="onClick:_showFilterDefDialog, onMouseEnter:_onEnterButton, onMouseLeave:_onLeaveButton, onMouseMove:_onMoveButton"></span\n	></td><td class="dojoxGridFBarInfoTD"\n		><span class="dojoxGridFBarInner"\n			><span class="dojoxGridFBarStatus" dojoAttachPoint="statusBarNode">${_noFilterMsg}</span\n			><span dojoType="dijit.form.Button" class="dojoxGridFBarClearFilterBtn" dojoAttachPoint="clearFilterButton" \n				label="${_filterBarClearBtnLabel}" iconClass="dojoxGridFBarClearFilterBtnIcon" showLabel="true" \n				dojoAttachEvent="onClick:_clearFilterDefDialog, onMouseEnter:_onEnterButton, onMouseLeave:_onLeaveButton, onMouseMove:_onMoveButton"></span\n			><span dojotype="dijit.form.Button" class="dojoxGridFBarCloseBtn" dojoAttachPoint="closeFilterBarButton" \n				label="${_closeFilterBarBtnLabel}" iconClass="dojoxGridFBarCloseBtnIcon" showLabel="false" \n				dojoAttachEvent="onClick:_closeFilterBar, onMouseEnter:_onEnterButton, onMouseLeave:_onLeaveButton, onMouseMove:_onMoveButton"></span\n		></span\n	></td></tr\n></table>\n'}}),define("dojox/grid/enhanced/plugins/filter/FilterBar",["dojo/_base/declare","dojo/_base/array","dojo/_base/connect","dojo/_base/lang","dojo/_base/sniff","dojo/_base/event","dojo/_base/html","dojo/_base/window","dojo/query","dijit/_Widget","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dojo/fx","dojo/_base/fx","dojo/string","dijit/focus","dojo/text!../../templates/FilterBar.html"],function(e,t,i,r,o,n,a,s,d,l,u,c,h,f,m,p,g){var y="dojoxGridFBarHover",v="dojoxGridFBarFiltered",b=function(e){try{e&&e.preventDefault&&n.stop(e)}catch(t){}};return e("dojox.grid.enhanced.plugins.filter.FilterBar",[l,u,c],{templateString:g,widgetsInTemplate:!0,_timeout_statusTooltip:300,_handle_statusTooltip:null,_curColIdx:-1,plugin:null,postMixInProperties:function(){var e=this.plugin,t=e.nls;this._filterBarDefBtnLabel=t.filterBarDefButton,this._filterBarClearBtnLabel=t.filterBarClearButton,this._closeFilterBarBtnLabel=t.closeFilterBarBtn;var i=e.args.itemsName||t.defaultItemsName;this._noFilterMsg=m.substitute(t.filterBarMsgNoFilterTemplate,["",i]);var o=this.plugin.args.statusTipTimeout;"number"==typeof o&&(this._timeout_statusTooltip=o);var n=e.grid;n.showFilterBar=r.hitch(this,"showFilterBar"),n.toggleFilterBar=r.hitch(this,"toggleFilterBar"),n.isFilterBarShown=r.hitch(this,"isFilterBarShown")},postCreate:function(){this.inherited(arguments),this.plugin.args.closeFilterbarButton||a.style(this.closeFilterBarButton.domNode,"display","none");var e=this,t=this.plugin.grid,i=this.oldGetHeaderHeight=r.hitch(t,t._getHeaderHeight);this.placeAt(t.viewsHeaderNode,"after"),this.connect(this.plugin.filterDefDialog,"showDialog","_onShowFilterDefDialog"),this.connect(this.plugin.filterDefDialog,"closeDialog","_onCloseFilterDefDialog"),this.connect(t.layer("filter"),"onFiltered",this._onFiltered),this.defineFilterButton.domNode.title=this.plugin.nls.filterBarDefButton,a.hasClass(s.body(),"dijit_a11y")&&this.defineFilterButton.set("label",this.plugin.nls.a11yFilterBarDefButton),this.connect(this.defineFilterButton.domNode,"click",b),this.connect(this.clearFilterButton.domNode,"click",b),this.connect(this.closeFilterBarButton.domNode,"click",b),this.toggleClearFilterBtn(!0),this._initAriaInfo(),t._getHeaderHeight=function(){return i()+a.marginBox(e.domNode).h},t.focus.addArea({name:"filterbar",onFocus:r.hitch(this,this._onFocusFilterBar,!1),onBlur:r.hitch(this,this._onBlurFilterBar)}),t.focus.placeArea("filterbar","after","header")},uninitialize:function(){var e=this.plugin.grid;e._getHeaderHeight=this.oldGetHeaderHeight,e.focus.removeArea("filterbar"),this.plugin=null},isFilterBarShown:function(){return"none"!=a.style(this.domNode,"display")},showFilterBar:function(e,i,n){var s=this.plugin.grid;if(i){if(Boolean(e)==this.isFilterBarShown())return;n=n||{};var d=[],l=500;d.push(h[e?"wipeIn":"wipeOut"](r.mixin({node:this.domNode,duration:l},n)));var u=s.views.views[0].domNode.offsetHeight,c={duration:l,properties:{height:{end:r.hitch(this,function(){var t=this.domNode.scrollHeight;return o("ff")&&(t-=2),e?u-t:u+t})}}};t.forEach(s.views.views,function(e){d.push(f.animateProperty(r.mixin({node:e.domNode},c,n)),f.animateProperty(r.mixin({node:e.scrollboxNode},c,n)))}),d.push(f.animateProperty(r.mixin({node:s.viewsNode},c,n))),h.combine(d).play()}else a.style(this.domNode,"display",e?"":"none"),s.update()},toggleFilterBar:function(e,t){this.showFilterBar(!this.isFilterBarShown(),e,t)},getColumnIdx:function(e){for(var t=d("[role='columnheader']",this.plugin.grid.viewsHeaderNode),i=-1,r=t.length-1;r>=0;--r){var o=a.position(t[r]);if(e>=o.x&&e<o.x+o.w){i=r;break}}return i>=0&&this.plugin.grid.layout.cells[i].filterable!==!1?i:-1},toggleClearFilterBtn:function(e){a.style(this.clearFilterButton.domNode,"display",e?"none":"")},_closeFilterBar:function(e){b(e);var t=this.plugin.filterDefDialog.getCriteria();if(t){var r=i.connect(this.plugin.filterDefDialog,"clearFilter",this,function(){this.showFilterBar(!1,!0),i.disconnect(r)});this._clearFilterDefDialog(e)}else this.showFilterBar(!1,!0)},_showFilterDefDialog:function(e){b(e),this.plugin.filterDefDialog.showDialog(this._curColIdx),this.plugin.grid.focus.focusArea("filterbar")},_clearFilterDefDialog:function(e){b(e),this.plugin.filterDefDialog.onClearFilter(),this.plugin.grid.focus.focusArea("filterbar")},_onEnterButton:function(e){this._onBlurFilterBar(),b(e)},_onMoveButton:function(e){this._onBlurFilterBar()},_onLeaveButton:function(e){this._leavingBtn=!0},_onShowFilterDefDialog:function(e){"number"==typeof e&&(this._curColIdx=e),this._defPaneIsShown=!0},_onCloseFilterDefDialog:function(){this._defPaneIsShown=!1,this._curColIdx=-1,p.focus(this.defineFilterButton.domNode)},_onClickFilterBar:function(e){b(e),this._clearStatusTipTimeout(),this.plugin.grid.focus.focusArea("filterbar"),this.plugin.filterDefDialog.showDialog(this.getColumnIdx(e.clientX))},_onMouseEnter:function(e){this._onFocusFilterBar(!0,null),this._updateTipPosition(e),this._setStatusTipTimeout()},_onMouseMove:function(e){this._leavingBtn&&(this._onFocusFilterBar(!0,null),this._leavingBtn=!1),this._isFocused&&(this._setStatusTipTimeout(),this._highlightHeader(this.getColumnIdx(e.clientX)),this._handle_statusTooltip&&this._updateTipPosition(e))},_onMouseLeave:function(e){this._onBlurFilterBar()},_updateTipPosition:function(e){this._tippos={x:e.pageX,y:e.pageY}},_onFocusFilterBar:function(e,t,i){if(!this.isFilterBarShown())return!1;if(this._isFocused=!0,a.addClass(this.domNode,y),!e){var r="none"!==a.style(this.clearFilterButton.domNode,"display"),o="none"!==a.style(this.closeFilterBarButton.domNode,"display");"undefined"==typeof this._focusPos&&(i>0?this._focusPos=0:(o?this._focusPos=1:this._focusPos=0,r&&++this._focusPos)),0===this._focusPos?p.focus(this.defineFilterButton.focusNode):1===this._focusPos&&r?p.focus(this.clearFilterButton.focusNode):p.focus(this.closeFilterBarButton.focusNode)}return b(t),!0},_onBlurFilterBar:function(e,t){this._isFocused&&(this._isFocused=!1,a.removeClass(this.domNode,y),this._clearStatusTipTimeout(),this._clearHeaderHighlight());var i=!0;if(t){var r=3;if("none"===a.style(this.closeFilterBarButton.domNode,"display")&&--r,"none"===a.style(this.clearFilterButton.domNode,"display")&&--r,1==r)delete this._focusPos;else{for(var o=this._focusPos,n=o+t;0>n;n+=r);n%=r,t>0&&o>n||0>t&&n>o?delete this._focusPos:(this._focusPos=n,i=!1)}}return i},_onFiltered:function(e,t){var i=this.plugin,r=i.args.itemsName||i.nls.defaultItemsName,o="",n=i.grid,s=n.layer("filter");s.filterDef()?(o=m.substitute(i.nls.filterBarMsgHasFilterTemplate,[e,t,r]),a.addClass(this.domNode,v)):(o=m.substitute(i.nls.filterBarMsgNoFilterTemplate,[t,r]),a.removeClass(this.domNode,v)),this.statusBarNode.innerHTML=o,this._focusPos=0},_initAriaInfo:function(){this.defineFilterButton.domNode.setAttribute("aria-label",this.plugin.nls.waiFilterBarDefButton),this.clearFilterButton.domNode.setAttribute("aria-label",this.plugin.nls.waiFilterBarClearButton)},_isInColumn:function(e,t,i){var r=a.position(t);return e>=r.x&&e<r.x+r.w},_setStatusTipTimeout:function(){this._clearStatusTipTimeout(),this._defPaneIsShown||(this._handle_statusTooltip=setTimeout(r.hitch(this,this._showStatusTooltip),this._timeout_statusTooltip))},_clearStatusTipTimeout:function(){clearTimeout(this._handle_statusTooltip),this._handle_statusTooltip=null},_showStatusTooltip:function(){this._handle_statusTooltip=null,this.plugin&&this.plugin.filterStatusTip.showDialog(this._tippos.x,this._tippos.y,this.getColumnIdx(this._tippos.x))},_highlightHeader:function(e){if(e!=this._previousHeaderIdx){var t=this.plugin.grid,i=t.getCell(this._previousHeaderIdx);i&&a.removeClass(i.getHeaderNode(),"dojoxGridCellOver"),i=t.getCell(e),i&&a.addClass(i.getHeaderNode(),"dojoxGridCellOver"),this._previousHeaderIdx=e}},_clearHeaderHighlight:function(){if("undefined"!=typeof this._previousHeaderIdx){var e=this.plugin.grid,t=e.getCell(this._previousHeaderIdx);t&&e.onHeaderCellMouseOut({cellNode:t.getHeaderNode()}),delete this._previousHeaderIdx}}})});//# sourceMappingURL=FilterBar.js.map