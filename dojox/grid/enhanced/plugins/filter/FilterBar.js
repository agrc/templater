//>>built
require({cache:{"url:dojox/grid/enhanced/templates/FilterBar.html":'<table class="dojoxGridFBar" border="0" cellspacing="0" role="presentation" dojoAttachEvent="onclick:_onClickFilterBar, onmouseenter:_onMouseEnter, onmouseleave:_onMouseLeave, onmousemove:_onMouseMove"\n\t><tr><td class="dojoxGridFBarBtnTD"\n\t\t><span dojoType="dijit.form.Button" class="dojoxGridFBarBtn" dojoAttachPoint="defineFilterButton" label="..." iconClass="dojoxGridFBarDefFilterBtnIcon" showLabel="true" dojoAttachEvent="onClick:_showFilterDefDialog, onMouseEnter:_onEnterButton, onMouseLeave:_onLeaveButton, onMouseMove:_onMoveButton"></span\n\t></td><td class="dojoxGridFBarInfoTD"\n\t\t><span class="dojoxGridFBarInner"\n\t\t\t><span class="dojoxGridFBarStatus" dojoAttachPoint="statusBarNode">${_noFilterMsg}</span\n\t\t\t><span dojoType="dijit.form.Button" class="dojoxGridFBarClearFilterBtn" dojoAttachPoint="clearFilterButton" \n\t\t\t\tlabel="${_filterBarClearBtnLabel}" iconClass="dojoxGridFBarClearFilterBtnIcon" showLabel="true" \n\t\t\t\tdojoAttachEvent="onClick:_clearFilterDefDialog, onMouseEnter:_onEnterButton, onMouseLeave:_onLeaveButton, onMouseMove:_onMoveButton"></span\n\t\t\t><span dojotype="dijit.form.Button" class="dojoxGridFBarCloseBtn" dojoAttachPoint="closeFilterBarButton" \n\t\t\t\tlabel="${_closeFilterBarBtnLabel}" iconClass="dojoxGridFBarCloseBtnIcon" showLabel="false" \n\t\t\t\tdojoAttachEvent="onClick:_closeFilterBar, onMouseEnter:_onEnterButton, onMouseLeave:_onLeaveButton, onMouseMove:_onMoveButton"></span\n\t\t></span\n\t></td></tr\n></table>\n'}}),define("dojox/grid/enhanced/plugins/filter/FilterBar",["dojo/_base/declare","dojo/_base/array","dojo/_base/connect","dojo/_base/lang","dojo/_base/sniff","dojo/_base/event","dojo/_base/html","dojo/_base/window","dojo/query","dijit/_Widget","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dojo/fx","dojo/_base/fx","dojo/string","dijit/focus","dojo/text!../../templates/FilterBar.html"],function(e,t,i,a,o,n,r,s,l,d,u,h,c,m,f,p,g){var y="dojoxGridFBarHover",v="dojoxGridFBarFiltered",k=function(e){try{e&&e.preventDefault&&n.stop(e)}catch(e){}};return e("dojox.grid.enhanced.plugins.filter.FilterBar",[d,u,h],{templateString:g,widgetsInTemplate:!0,_timeout_statusTooltip:300,_handle_statusTooltip:null,_curColIdx:-1,plugin:null,postMixInProperties:function(){var e=this.plugin,t=e.nls;this._filterBarDefBtnLabel=t.filterBarDefButton,this._filterBarClearBtnLabel=t.filterBarClearButton,this._closeFilterBarBtnLabel=t.closeFilterBarBtn;var i=e.args.itemsName||t.defaultItemsName;this._noFilterMsg=f.substitute(t.filterBarMsgNoFilterTemplate,["",i]);var o=this.plugin.args.statusTipTimeout;"number"==typeof o&&(this._timeout_statusTooltip=o);var n=e.grid;n.showFilterBar=a.hitch(this,"showFilterBar"),n.toggleFilterBar=a.hitch(this,"toggleFilterBar"),n.isFilterBarShown=a.hitch(this,"isFilterBarShown")},postCreate:function(){this.inherited(arguments),this.plugin.args.closeFilterbarButton||r.style(this.closeFilterBarButton.domNode,"display","none");var e=this,t=this.plugin.grid,i=this.oldGetHeaderHeight=a.hitch(t,t._getHeaderHeight);this.placeAt(t.viewsHeaderNode,"after"),this.connect(this.plugin.filterDefDialog,"showDialog","_onShowFilterDefDialog"),this.connect(this.plugin.filterDefDialog,"closeDialog","_onCloseFilterDefDialog"),this.connect(t.layer("filter"),"onFiltered",this._onFiltered),this.defineFilterButton.domNode.title=this.plugin.nls.filterBarDefButton,r.hasClass(s.body(),"dijit_a11y")&&this.defineFilterButton.set("label",this.plugin.nls.a11yFilterBarDefButton),this.connect(this.defineFilterButton.domNode,"click",k),this.connect(this.clearFilterButton.domNode,"click",k),this.connect(this.closeFilterBarButton.domNode,"click",k),this.toggleClearFilterBtn(!0),this._initAriaInfo(),t._getHeaderHeight=function(){return i()+r.marginBox(e.domNode).h},t.focus.addArea({name:"filterbar",onFocus:a.hitch(this,this._onFocusFilterBar,!1),onBlur:a.hitch(this,this._onBlurFilterBar)}),t.focus.placeArea("filterbar","after","header")},uninitialize:function(){var e=this.plugin.grid;e._getHeaderHeight=this.oldGetHeaderHeight,e.focus.removeArea("filterbar"),this.plugin=null},isFilterBarShown:function(){return"none"!=r.style(this.domNode,"display")},showFilterBar:function(e,i,n){var s=this.plugin.grid;if(i){if(Boolean(e)==this.isFilterBarShown())return;n=n||{};var l=[],d=500;l.push(c[e?"wipeIn":"wipeOut"](a.mixin({node:this.domNode,duration:d},n)));var u=s.views.views[0].domNode.offsetHeight,h={duration:d,properties:{height:{end:a.hitch(this,function(){var t=this.domNode.scrollHeight;return o("ff")&&(t-=2),e?u-t:u+t})}}};t.forEach(s.views.views,function(e){l.push(m.animateProperty(a.mixin({node:e.domNode},h,n)),m.animateProperty(a.mixin({node:e.scrollboxNode},h,n)))}),l.push(m.animateProperty(a.mixin({node:s.viewsNode},h,n))),c.combine(l).play()}else r.style(this.domNode,"display",e?"":"none"),s.update()},toggleFilterBar:function(e,t){this.showFilterBar(!this.isFilterBarShown(),e,t)},getColumnIdx:function(e){for(var t=l("[role='columnheader']",this.plugin.grid.viewsHeaderNode),i=-1,a=t.length-1;a>=0;--a){var o=r.position(t[a]);if(e>=o.x&&e<o.x+o.w){i=a;break}}return i>=0&&!1!==this.plugin.grid.layout.cells[i].filterable?i:-1},toggleClearFilterBtn:function(e){r.style(this.clearFilterButton.domNode,"display",e?"none":"")},_closeFilterBar:function(e){if(k(e),this.plugin.filterDefDialog.getCriteria()){var t=i.connect(this.plugin.filterDefDialog,"clearFilter",this,function(){this.showFilterBar(!1,!0),i.disconnect(t)});this._clearFilterDefDialog(e)}else this.showFilterBar(!1,!0)},_showFilterDefDialog:function(e){k(e),this.plugin.filterDefDialog.showDialog(this._curColIdx),this.plugin.grid.focus.focusArea("filterbar")},_clearFilterDefDialog:function(e){k(e),this.plugin.filterDefDialog.onClearFilter(),this.plugin.grid.focus.focusArea("filterbar")},_onEnterButton:function(e){this._onBlurFilterBar(),k(e)},_onMoveButton:function(e){this._onBlurFilterBar()},_onLeaveButton:function(e){this._leavingBtn=!0},_onShowFilterDefDialog:function(e){"number"==typeof e&&(this._curColIdx=e),this._defPaneIsShown=!0},_onCloseFilterDefDialog:function(){this._defPaneIsShown=!1,this._curColIdx=-1,p.focus(this.defineFilterButton.domNode)},_onClickFilterBar:function(e){k(e),this._clearStatusTipTimeout(),this.plugin.grid.focus.focusArea("filterbar"),this.plugin.filterDefDialog.showDialog(this.getColumnIdx(e.clientX))},_onMouseEnter:function(e){this._onFocusFilterBar(!0,null),this._updateTipPosition(e),this._setStatusTipTimeout()},_onMouseMove:function(e){this._leavingBtn&&(this._onFocusFilterBar(!0,null),this._leavingBtn=!1),this._isFocused&&(this._setStatusTipTimeout(),this._highlightHeader(this.getColumnIdx(e.clientX)),this._handle_statusTooltip&&this._updateTipPosition(e))},_onMouseLeave:function(e){this._onBlurFilterBar()},_updateTipPosition:function(e){this._tippos={x:e.pageX,y:e.pageY}},_onFocusFilterBar:function(e,t,i){if(!this.isFilterBarShown())return!1;if(this._isFocused=!0,r.addClass(this.domNode,y),!e){var a="none"!==r.style(this.clearFilterButton.domNode,"display"),o="none"!==r.style(this.closeFilterBarButton.domNode,"display");void 0===this._focusPos&&(i>0?this._focusPos=0:(this._focusPos=o?1:0,a&&++this._focusPos)),0===this._focusPos?p.focus(this.defineFilterButton.focusNode):1===this._focusPos&&a?p.focus(this.clearFilterButton.focusNode):p.focus(this.closeFilterBarButton.focusNode)}return k(t),!0},_onBlurFilterBar:function(e,t){this._isFocused&&(this._isFocused=!1,r.removeClass(this.domNode,y),this._clearStatusTipTimeout(),this._clearHeaderHighlight());var i=!0;if(t){var a=3;if("none"===r.style(this.closeFilterBarButton.domNode,"display")&&--a,"none"===r.style(this.clearFilterButton.domNode,"display")&&--a,1==a)delete this._focusPos;else{for(var o=this._focusPos,n=o+t;n<0;n+=a);n%=a,t>0&&n<o||t<0&&n>o?delete this._focusPos:(this._focusPos=n,i=!1)}}return i},_onFiltered:function(e,t){var i=this.plugin,a=i.args.itemsName||i.nls.defaultItemsName,o="";i.grid.layer("filter").filterDef()?(o=f.substitute(i.nls.filterBarMsgHasFilterTemplate,[e,t,a]),r.addClass(this.domNode,v)):(o=f.substitute(i.nls.filterBarMsgNoFilterTemplate,[t,a]),r.removeClass(this.domNode,v)),this.statusBarNode.innerHTML=o,this._focusPos=0},_initAriaInfo:function(){this.defineFilterButton.domNode.setAttribute("aria-label",this.plugin.nls.waiFilterBarDefButton),this.clearFilterButton.domNode.setAttribute("aria-label",this.plugin.nls.waiFilterBarClearButton)},_isInColumn:function(e,t,i){var a=r.position(t);return e>=a.x&&e<a.x+a.w},_setStatusTipTimeout:function(){this._clearStatusTipTimeout(),this._defPaneIsShown||(this._handle_statusTooltip=setTimeout(a.hitch(this,this._showStatusTooltip),this._timeout_statusTooltip))},_clearStatusTipTimeout:function(){clearTimeout(this._handle_statusTooltip),this._handle_statusTooltip=null},_showStatusTooltip:function(){this._handle_statusTooltip=null,this.plugin&&this.plugin.filterStatusTip.showDialog(this._tippos.x,this._tippos.y,this.getColumnIdx(this._tippos.x))},_highlightHeader:function(e){if(e!=this._previousHeaderIdx){var t=this.plugin.grid,i=t.getCell(this._previousHeaderIdx);i&&r.removeClass(i.getHeaderNode(),"dojoxGridCellOver"),i=t.getCell(e),i&&r.addClass(i.getHeaderNode(),"dojoxGridCellOver"),this._previousHeaderIdx=e}},_clearHeaderHighlight:function(){if(void 0!==this._previousHeaderIdx){var e=this.plugin.grid,t=e.getCell(this._previousHeaderIdx);t&&e.onHeaderCellMouseOut({cellNode:t.getHeaderNode()}),delete this._previousHeaderIdx}}})});//# sourceMappingURL=FilterBar.js.map