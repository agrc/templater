//>>built
define("dojox/secure/DOM",["dojo","dijit","dojox","dojo/require!dojox/lang/observable"],function(e,t,i){e.provide("dojox.secure.DOM"),e.require("dojox.lang.observable"),i.secure.DOM=function(t){function a(e){if(!e)return e;var i=e;do if(i==t)return r(e);while(i=i.parentNode);return null}function r(e){if(e){if(e.nodeType){var t=g(e);return 1==e.nodeType&&"function"==typeof t.style&&(t.style=y(e.style),t.ownerDocument=c,t.childNodes={__get__:function(t){return r(e.childNodes[t])},length:0}),t}if(e&&"object"==typeof e){if(e.__observable)return e.__observable;t=e instanceof Array?[]:{},e.__observable=t;for(var a in e)"__observable"!=a&&(t[a]=r(e[a]));return t.data__=e,t}if("function"==typeof e){var o=function(e){return"function"==typeof e?function(){for(var t=0;t<arguments.length;t++)arguments[t]=r(arguments[t]);return o(e.apply(r(this),arguments))}:i.secure.unwrap(e)};return function(){e.safetyCheck&&e.safetyCheck.apply(o(this),arguments);for(var t=0;t<arguments.length;t++)arguments[t]=o(arguments[t]);return r(e.apply(o(this),arguments))}}}return e}function o(e){if(e+="",e.match(/behavior:|content:|javascript:|binding|expression|\@import/))throw new Error("Illegal CSS");var i=t.id||(t.id="safe"+(""+Math.random()).substring(2));return e.replace(/(\}|^)\s*([^\{]*\{)/g,function(e,t,a){return t+" #"+i+" "+a})}function n(e){if(e.match(/:/)&&!e.match(/^(http|ftp|mailto)/))throw new Error("Unsafe URL "+e)}function s(t){if(t&&1==t.nodeType){if(t.tagName.match(/script/i)){var i=t.src;if(i&&""!=i)t.parentNode.removeChild(t),e.xhrGet({url:i,secure:!0}).addCallback(function(e){c.evaluate(e)});else{var a=t.innerHTML;t.parentNode.removeChild(t),r.evaluate(a)}}if(t.tagName.match(/link/i))throw new Error("illegal tag");if(t.tagName.match(/style/i)){var l=function(e){if(t.styleSheet)t.styleSheet.cssText=e;else{var i=h.createTextNode(e);t.childNodes[0]?t.replaceChild(i,t.childNodes[0]):t.appendChild(i)}};i=t.src,i&&""!=i&&(alert("src"+i),t.src=null,e.xhrGet({url:i,secure:!0}).addCallback(function(e){l(o(e))})),l(o(t.innerHTML))}t.style&&o(t.style.cssText),t.href&&n(t.href),t.src&&n(t.src);for(var d,u=0;d=t.attributes[u++];)if("on"==d.name.substring(0,2)&&"null"!=d.value&&""!=d.value)throw new Error("event handlers not allowed in the HTML, they must be set with element.addEventListener");for(var m=t.childNodes,u=0,f=m.length;f>u;u++)s(m[u])}}function l(e){var t=document.createElement("div");if(e.match(/<object/i))throw new Error("The object tag is not allowed");return t.innerHTML=e,s(t),t}function d(e,t){return function(i,a){return s(a[t]),i[e](a[0])}}function u(e){return i.lang.makeObservable(function(e,t){return e[t]},e,function(e,t,i,a){for(var o=0;o<a.length;o++)a[o]=unwrap(a[o]);return r(f[i]?f[i].call(e,t,a):t[i].apply(t,a))},f)}unwrap=i.secure.unwrap;var h=t.ownerDocument,c={getElementById:function(e){return a(h.getElementById(e))},createElement:function(e){return r(h.createElement(e))},createTextNode:function(e){return r(h.createTextNode(e))},write:function(e){for(var i=l(e);i.childNodes.length;)t.appendChild(i.childNodes[0])}};c.open=c.close=function(){};var m={innerHTML:function(e,t){e.innerHTML=l(t).innerHTML}};m.outerHTML=function(e,t){throw new Error("Can not set this property")};var f={appendChild:d("appendChild",0),insertBefore:d("insertBefore",0),replaceChild:d("replaceChild",1),cloneNode:function(e,t){return e.cloneNode(t[0])},addEventListener:function(t,i){e.connect(t,"on"+i[0],this,function(e){e=g(e||window.event),i[1].call(this,e)})}};f.childNodes=f.style=f.ownerDocument=function(){};var g=u(function(e,t,i){m[t]&&m[t](e,i),e[t]=i}),p={behavior:1,MozBinding:1},y=u(function(e,t,i){p[t]||(e[t]=o(i))});return r.safeHTML=l,r.safeCSS=o,r},i.secure.unwrap=function(e){return e&&e.data__||e}});//# sourceMappingURL=DOM.js.map