//>>built
define("dojox/secure/sandbox",["dojo","dijit","dojox","dojo/require!dojox/secure/DOM,dojox/secure/capability,dojo/NodeList-fx,dojo/_base/url"],function(dojo,dijit,dojox){dojo.provide("dojox.secure.sandbox"),dojo.require("dojox.secure.DOM"),dojo.require("dojox.secure.capability"),dojo.require("dojo.NodeList-fx"),dojo.require("dojo._base.url"),function(){var oldTimeout=setTimeout,oldInterval=setInterval;if({}.__proto__){var fixMozArrayFunction=function(e){var t=Array.prototype[e];t&&!t.fixed&&((Array.prototype[e]=function(){if(this==window)throw new TypeError("Called with wrong this");return t.apply(this,arguments)}).fixed=!0)};fixMozArrayFunction("concat"),fixMozArrayFunction("reverse"),fixMozArrayFunction("sort"),fixMozArrayFunction("slice"),fixMozArrayFunction("forEach"),fixMozArrayFunction("filter"),fixMozArrayFunction("reduce"),fixMozArrayFunction("reduceRight"),fixMozArrayFunction("every"),fixMozArrayFunction("map"),fixMozArrayFunction("some")}var xhrGet=function(){return dojo.xhrGet.apply(dojo,arguments)};dojox.secure.sandbox=function(element){function get(e,t){if(t=""+t,dojox.secure.badProps.test(t))throw new Error("bad property access");return e.__get__?e.__get__(t):e[t]}function set(e,t,i){return t=""+t,get(e,t),e.__set?e.__set(t):(e[t]=i,i)}function forEach(e,t){if("function"!=typeof t)throw new TypeError;if("length"in e)if(e.__get__)for(var i=e.__get__("length"),a=0;i>a;a++)a in e&&t.call(e,e.__get__(a),a,e);else for(i=e.length,a=0;i>a;a++)a in e&&t.call(e,e[a],a,e);else for(a in e)t.call(e,get(e,a),a,e)}function Class(e,t,i){function a(){r&&r.apply(this,arguments),o&&o.apply(this,arguments)}for(var n,r,o,s,l=0,d=arguments.length;"function"==typeof(s=arguments[l])&&d>l;l++)if(n)mixin(n,s.prototype);else{r=s;var u=function(){};u.prototype=s.prototype,n=new u}if(s){for(var c in s){var h=s[c];"function"==typeof h&&(s[c]=function(){if(this instanceof a)return arguments.callee.__rawMethod__.apply(this,arguments);throw new Error("Method called on wrong object")},s[c].__rawMethod__=h)}s.hasOwnProperty("constructor")&&(o=s.constructor)}return n=n?mixin(n,s):s,mixin(a,arguments[l]),n.constructor=a,a.prototype=n,a}function checkString(e){if("function"!=typeof e)throw new Error("String is not allowed in setTimeout/setInterval")}function setTimeout(e,t){return checkString(e),oldTimeout(e,t)}function setInterval(e,t){return checkString(e),oldInterval(e,t)}function evaluate(e){return wrap.evaluate(e)}var wrap=dojox.secure.DOM(element);element=wrap(element);var document=element.ownerDocument,mixin,dojo=dojox.secure._safeDojoFunctions(element,wrap),imports=[],safeCalls=["isNaN","isFinite","parseInt","parseFloat","escape","unescape","encodeURI","encodeURIComponent","decodeURI","decodeURIComponent","alert","confirm","prompt","Error","EvalError","RangeError","ReferenceError","SyntaxError","TypeError","Date","RegExp","Number","Object","Array","String","Math","setTimeout","setInterval","clearTimeout","clearInterval","dojo","get","set","forEach","load","evaluate"];for(var i in dojo)safeCalls.push(i),imports.push("var "+i+"=dojo."+i);eval(imports.join(";"));var load=wrap.load=function(e){if(e.match(/^[\w\s]*:/))throw new Error("Access denied to cross-site requests");return xhrGet({url:new dojo._Url(wrap.rootUrl,e)+"",secure:!0})};return wrap.evaluate=function(script){if(dojox.secure.capability.validate(script,safeCalls,{document:1,element:1}),script.match(/^\s*[\[\{]/))var result=eval("("+script+")");else eval(script)},{loadJS:function(e){return wrap.rootUrl=e,xhrGet({url:e,secure:!0}).addCallback(function(e){evaluate(e,element)})},loadHTML:function(e){return wrap.rootUrl=e,xhrGet({url:e,secure:!0}).addCallback(function(e){element.innerHTML=e})},evaluate:function(e){return wrap.evaluate(e)}}}}(),dojox.secure._safeDojoFunctions=function(e,t){var i=["mixin","require","isString","isArray","isFunction","isObject","isArrayLike","isAlien","hitch","delegate","partial","trim","disconnect","subscribe","unsubscribe","Deferred","toJson","style","attr"],a=(e.ownerDocument,dojox.secure.unwrap);dojo.NodeList.prototype.addContent.safetyCheck=function(e){t.safeHTML(e)},dojo.NodeList.prototype.style.safetyCheck=function(e,i){if("behavior"==e)throw new Error("Can not set behavior");t.safeCSS(i)},dojo.NodeList.prototype.attr.safetyCheck=function(e,t){if(t&&("src"==e||"href"==e||"style"==e))throw new Error("Illegal to set "+e)};for(var n={query:function(i,n){return t(dojo.query(i,a(n||e)))},connect:function(e,t){var i=e;if(arguments[0]=a(e),i!=arguments[0]&&"on"!=t.substring(0,2))throw new Error("Invalid event name for element");return dojo.connect.apply(dojo,arguments)},body:function(){return e},byId:function(t){return e.ownerDocument.getElementById(t)},fromJson:function(e){return dojox.secure.capability.validate(e,[],{}),dojo.fromJson(e)}},r=0;r<i.length;r++)n[i[r]]=dojo[i[r]];return n}});//# sourceMappingURL=sandbox.js.map