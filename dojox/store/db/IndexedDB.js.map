{"version":3,"sources":["IndexedDB.js.uncompressed.js"],"names":["define","declare","lang","Deferred","when","all","SimpleQueryEngine","QueryResults","makePromise","request","deferred","onsuccess","event","resolve","target","result","onerror","error","message","webkitErrorMessage","reject","promise","queueCursor","cursor","priority","retry","cursorsRunning","cursorQueue","length","push","sort","a","b","maxConcurrent","cursorObject","pop","e","name","yes","queryFromFilter","source","forEach","callback","thisObj","started","promisedResults","then","results","callbacks","filter","value","i","l","call","total","done","map","mapped","errback","wildcardRe","IDBKeyRange","window","webkitIDBKeyRange","constructor","options","safeMixin","this","store","dbConfig","indices","stores","storeName","cachedCount","index","preference","db","openRequest","indexedDB","open","parseInt","version","onupgradeneeded","storeConfig","objectStoreNames","contains","idbStore","transaction","objectStore","idProperty","createObjectStore","keyPath","autoIncrement","indexNames","indexed","createIndex","available","queryEngine","_currentTransaction","abort","commit","_getTransaction","oncomplete","_callOnStore","method","args","returnRequest","callOnStore","currentTransaction","allowRetry","apply","get","id","getIdentity","object","put","overwrite","add","remove","query","tryIndex","indexName","quality","factor","indexTries","indexDefinition","bestIndexQuality","bestIndex","start","count","Infinity","sortOption","sortOptions","sorter","totals","collectedCount","inCount","reduce","arguments","queues","collected","part","addToQueue","queue","nextInQueues","toMerge","every","next","nextSelected","indexOf","shift","queryResults","keyRange","alreadySearchedProperty","advance","filterValue","queryId","JSON","stringify","wildcard","range","newFilterValue","from","to","test","bound","excludeFrom","excludeTo","lowerBound","upperBound","first","match","only","item","some","slice","matchStart","RegExp","descending","mainSort","attribute","postSorting","cursorRequestArgs","cachedPosition","offset","preFilterOffset","mixin","filteredResults","adjustTotal","Math","round","countPromise","openCursor","cursorRequest","join","matches","lastCursor","sortedResults","delegate","rawResults"],"mappings":"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","file":"IndexedDB.js.uncompressed.js"}