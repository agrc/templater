//>>built
define("dojox/gfx/svg_attach",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","dojo/_base/Color","./_base","./svg","./matrix"],function(e,t,i,a,o,n,r){function s(e){var r=e.rawNode.getAttribute("fill");if("none"==r)return void(e.fillStyle=null);var s=null,l=n.getRef(r);if(l)switch(l.tagName.toLowerCase()){case"lineargradient":s=d(o.defaultLinearGradient,l),i.forEach(["x1","y1","x2","y2"],function(e){s[e]=l.getAttribute(e)});break;case"radialgradient":s=d(o.defaultRadialGradient,l),i.forEach(["cx","cy","r"],function(e){s[e]=l.getAttribute(e)}),s.cx=l.getAttribute("cx"),s.cy=l.getAttribute("cy"),s.r=l.getAttribute("r");break;case"pattern":s=t.clone(o.defaultPattern),i.forEach(["x","y","width","height"],function(e){s[e]=l.getAttribute(e)}),s.src=l.firstChild.getAttributeNS(n.xmlns.xlink,"href")}else{s=new a(r);var u=e.rawNode.getAttribute("fill-opacity");null!=u&&(s.a=u)}e.fillStyle=s}function d(e,i){var o=t.clone(e);o.colors=[];for(var n=0;n<i.childNodes.length;++n)o.colors.push({offset:i.childNodes[n].getAttribute("offset"),color:new a(i.childNodes[n].getAttribute("stop-color"))});return o}function l(e){var i=e.rawNode,n=i.getAttribute("stroke");if(null==n||"none"==n)return void(e.strokeStyle=null);var r=e.strokeStyle=t.clone(o.defaultStroke),s=new a(n);s&&(r.color=s,r.color.a=i.getAttribute("stroke-opacity"),r.width=i.getAttribute("stroke-width"),r.cap=i.getAttribute("stroke-linecap"),r.join=i.getAttribute("stroke-linejoin"),"miter"==r.join&&(r.join=i.getAttribute("stroke-miterlimit")),r.style=i.getAttribute("dojoGfxStrokeStyle"))}function u(e){var t=e.rawNode.getAttribute("transform");if(t.match(/^matrix\(.+\)$/)){var i=t.slice(7,-1).split(",");e.matrix=r.normalize({xx:parseFloat(i[0]),xy:parseFloat(i[2]),yx:parseFloat(i[1]),yy:parseFloat(i[3]),dx:parseFloat(i[4]),dy:parseFloat(i[5])})}else e.matrix=null}function h(e){var i=e.fontStyle=t.clone(o.defaultFont),a=e.rawNode;i.style=a.getAttribute("font-style"),i.variant=a.getAttribute("font-variant"),i.weight=a.getAttribute("font-weight"),i.size=a.getAttribute("font-size"),i.family=a.getAttribute("font-family")}function c(e,i){var a=e.shape=t.clone(i),o=e.rawNode;for(var n in a)a[n]=o.getAttribute(n)}function m(e){c(e,o.defaultRect),e.shape.r=Math.min(e.rawNode.getAttribute("rx"),e.rawNode.getAttribute("ry"))}function f(e){var i=e.shape=t.clone(o.defaultText),a=e.rawNode;i.x=a.getAttribute("x"),i.y=a.getAttribute("y"),i.align=a.getAttribute("text-anchor"),i.decoration=a.getAttribute("text-decoration"),i.rotated=0!=parseFloat(a.getAttribute("rotate")),i.kerning="auto"==a.getAttribute("kerning"),i.text=a.firstChild.nodeValue}function g(e){var i=e.shape=t.clone(o.defaultTextPath),a=e.rawNode;i.align=a.getAttribute("text-anchor"),i.decoration=a.getAttribute("text-decoration"),i.rotated=0!=parseFloat(a.getAttribute("rotate")),i.kerning="auto"==a.getAttribute("kerning"),i.text=a.firstChild.nodeValue}return e.experimental("dojox.gfx.svg_attach"),n.attachNode=function(e){if(!e)return null;var t=null;switch(e.tagName.toLowerCase()){case n.Rect.nodeType:t=new n.Rect(e),m(t);break;case n.Ellipse.nodeType:t=new n.Ellipse(e),c(t,o.defaultEllipse);break;case n.Polyline.nodeType:t=new n.Polyline(e),c(t,o.defaultPolyline);break;case n.Path.nodeType:t=new n.Path(e),c(t,o.defaultPath);break;case n.Circle.nodeType:t=new n.Circle(e),c(t,o.defaultCircle);break;case n.Line.nodeType:t=new n.Line(e),c(t,o.defaultLine);break;case n.Image.nodeType:t=new n.Image(e),c(t,o.defaultImage);break;case n.Text.nodeType:var i=e.getElementsByTagName("textPath");i&&i.length?(t=new n.TextPath(e),c(t,o.defaultPath),g(t)):(t=new n.Text(e),f(t)),h(t);break;default:return null}return t instanceof n.Image||(s(t),l(t)),u(t),t},n.attachSurface=function(e){var t=new n.Surface;t.rawNode=e;var i=e.getElementsByTagName("defs");return 0==i.length?null:(t.defNode=i[0],t)},n});//# sourceMappingURL=svg_attach.js.map