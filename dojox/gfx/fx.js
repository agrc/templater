//>>built
define("dojox/gfx/fx",["dojo/_base/lang","./_base","./matrix","dojo/_base/Color","dojo/_base/array","dojo/_base/fx","dojo/_base/connect","dojo/sniff"],function(e,t,a,i,r,o,n,d){function s(e,t){this.start=e,this.end=t}function l(e,t,a){this.start=e,this.end=t,this.units=a}function m(e,t){this.start=e,this.end=t,this.temp=new i}function u(e){this.values=e,this.length=e.length}function c(e,t){this.values=e,this.def=t||{}}function h(e,t){this.stack=e,this.original=t}function f(e,a,i,r){if(e.values)return new u(e.values);var o,n,d;return n=e.start?t.normalizeColor(e.start):o=a?i?a[i]:a:r,e.end?d=t.normalizeColor(e.end):(o||(o=a?i?a[i]:a:r),d=o),new m(n,d)}function y(e,t,a,i){if(e.values)return new u(e.values);var r,o,n;return o=e.start?e.start:r=t?t[a]:i,e.end?n=e.end:("number"!=typeof r&&(r=t?t[a]:i),n=r),new s(o,n)}var v=t.fx={};s.prototype.getValue=function(e){return(this.end-this.start)*e+this.start},l.prototype.getValue=function(e){return(this.end-this.start)*e+this.start+this.units},m.prototype.getValue=function(e){return i.blendColors(this.start,this.end,e,this.temp)},u.prototype.getValue=function(e){return this.values[Math.min(Math.floor(e*this.length),this.length-1)]},c.prototype.getValue=function(t){var a=e.clone(this.def);for(var i in this.values)a[i]=this.values[i].getValue(t);return a},h.prototype.getValue=function(e){var t=[];return r.forEach(this.stack,function(i){if(i instanceof a.Matrix2D)return void t.push(i);if("original"==i.name&&this.original)return void t.push(this.original);if("matrix"!=i.name){if(i.name in a){var o=a[i.name];if("function"!=typeof o)return void t.push(o);var n=r.map(i.start,function(t,a){return(i.end[a]-t)*e+t}),d=o.apply(a,n);d instanceof a.Matrix2D&&t.push(d)}}else if(i.start instanceof a.Matrix2D&&i.end instanceof a.Matrix2D){var s=new a.Matrix2D;for(var l in i.start)s[l]=(i.end[l]-i.start[l])*e+i.start[l];t.push(s)}},this),t};var g=new i(0,0,0,0);return v.animateStroke=function(e){e.easing||(e.easing=o._defaultEasing);var t,a=new o.Animation(e),i=e.shape;return n.connect(a,"beforeBegin",a,function(){t=i.getStroke();var a,r,o=e.color,n={};o&&(n.color=f(o,t,"color",g)),o=e.style,o&&o.values&&(n.style=new u(o.values)),o=e.width,o&&(n.width=y(o,t,"width",1)),o=e.cap,o&&o.values&&(n.cap=new u(o.values)),o=e.join,o&&(o.values?n.join=new u(o.values):(a=o.start?o.start:t&&t.join||0,r=o.end?o.end:t&&t.join||0,"number"==typeof a&&"number"==typeof r&&(n.join=new s(a,r)))),this.curve=new c(n,t)}),n.connect(a,"onAnimate",i,"setStroke"),a},v.animateFill=function(e){e.easing||(e.easing=o._defaultEasing);var t,a=new o.Animation(e),i=e.shape;return n.connect(a,"beforeBegin",a,function(){t=i.getFill();var a=e.color;a&&(this.curve=f(a,t,"",g))}),n.connect(a,"onAnimate",i,"setFill"),a},v.animateFont=function(e){e.easing||(e.easing=o._defaultEasing);var t,a=new o.Animation(e),i=e.shape;return n.connect(a,"beforeBegin",a,function(){t=i.getFont();var a,r,o=e.style,n={};o&&o.values&&(n.style=new u(o.values)),o=e.variant,o&&o.values&&(n.variant=new u(o.values)),o=e.weight,o&&o.values&&(n.weight=new u(o.values)),o=e.family,o&&o.values&&(n.family=new u(o.values)),o=e.size,o&&o.units&&(a=parseFloat(o.start?o.start:i.font&&i.font.size||"0"),r=parseFloat(o.end?o.end:i.font&&i.font.size||"0"),n.size=new l(a,r,o.units)),this.curve=new c(n,t)}),n.connect(a,"onAnimate",i,"setFont"),a},v.animateTransform=function(e){e.easing||(e.easing=o._defaultEasing);var a,i=new o.Animation(e),s=e.shape;if(n.connect(i,"beforeBegin",i,function(){a=s.getTransform(),this.curve=new h(e.transform,a)}),n.connect(i,"onAnimate",s,"setTransform"),"svg"===t.renderer&&(d("ie")>=9||d("ff")))var l=[n.connect(i,"onBegin",i,function(){for(var e=s.getParent();e&&e.getParent;)e=e.getParent();e&&(s.__svgContainer=e.rawNode.parentNode,s.__svgRoot=e.rawNode,s.__svgRoot&&s.__svgRoot.getAttribute&&(s.__svgWidth=parseInt(s.__svgRoot.getAttribute("width"),10),isNaN(s.__svgWidth)&&delete s.__svgWidth))}),n.connect(i,"onAnimate",i,function(){try{if(s.__svgContainer){var e=s.__svgContainer.style.visibility;s.__svgContainer.style.visibility="visible";s.__svgContainer.offsetHeight;s.__svgContainer.style.visibility=e;var t=s.__svgWidth;if(!isNaN(t))try{s.__svgRoot.setAttribute("width",t-5e-6),s.__svgRoot.setAttribute("width",t)}catch(e){}}}catch(e){}}),n.connect(i,"onEnd",i,function(){if(r.forEach(l,n.disconnect),s.__svgContainer){var e=s.__svgContainer;if(null==e.getAttribute("__gotVis")){e.setAttribute("__gotVis",!0);var t=s.__svgContainer.style.visibility,a=s.__svgRoot,i=s.__svgWidth;e.style.visibility="visible",setTimeout(function(){try{e.style.visibility=t,e.removeAttribute("__gotVis"),e=null;try{isNaN(i)||(a.setAttribute("width",i-5e-6),a.setAttribute("width",i))}catch(e){}}catch(e){}},100)}}delete s.__svgContainer,delete s.__svgRoot,delete s.__svgWidth})];return i},v});//# sourceMappingURL=fx.js.map