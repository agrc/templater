//>>built
define("dojox/gfx/decompose",["./_base","dojo/_base/lang","./matrix"],function(e,t,i){function a(e,t){return Math.abs(e-t)<=1e-6*(Math.abs(e)+Math.abs(t))}function r(e,t,i,a){return isFinite(e)?isFinite(i)?(t=Math.abs(t),a=Math.abs(a),(t*e+a*i)/(t+a)):e:i}function o(e){var a=new i.Matrix2D(e);return t.mixin(a,{dx:0,dy:0,xy:a.yx,yx:a.xy})}function n(e){return e.xx*e.yy<0||e.xy*e.yx>0?-1:1}function s(e){var t=i.normalize(e),r=-t.xx-t.yy,o=t.xx*t.yy-t.xy*t.yx,n=Math.sqrt(r*r-4*o),s=-(r+(0>r?-n:n))/2,d=o/s,l=t.xy/(s-t.xx),u=1,c=t.xy/(d-t.xx),h=1;a(s,d)&&(l=1,u=0,c=0,h=1),isFinite(l)||(l=1,u=(s-t.xx)/t.xy,isFinite(u)||(l=(s-t.yy)/t.yx,u=1,isFinite(l)||(l=1,u=t.yx/(s-t.yy)))),isFinite(c)||(c=1,h=(d-t.xx)/t.xy,isFinite(h)||(c=(d-t.yy)/t.yx,h=1,isFinite(c)||(c=1,h=t.yx/(d-t.yy))));var f=Math.sqrt(l*l+u*u),m=Math.sqrt(c*c+h*h);return isFinite(l/=f)||(l=0),isFinite(u/=f)||(u=0),isFinite(c/=m)||(c=0),isFinite(h/=m)||(h=0),{value1:s,value2:d,vector1:{x:l,y:u},vector2:{x:c,y:h}}}function d(e,t){var i=n(e),a=t.angle1=(Math.atan2(e.yx,e.yy)+Math.atan2(-i*e.xy,i*e.xx))/2,o=Math.cos(a),s=Math.sin(a);return t.sx=r(e.xx/o,o,-e.xy/s,s),t.sy=r(e.yy/o,o,e.yx/s,s),t}function l(e,t){var i=n(e),a=t.angle2=(Math.atan2(i*e.yx,i*e.xx)+Math.atan2(-e.xy,e.yy))/2,o=Math.cos(a),s=Math.sin(a);return t.sx=r(e.xx/o,o,e.yx/s,s),t.sy=r(e.yy/o,o,-e.xy/s,s),t}return e.decompose=function(e){var r=i.normalize(e),n={dx:r.dx,dy:r.dy,sx:1,sy:1,angle1:0,angle2:0};if(a(r.xy,0)&&a(r.yx,0))return t.mixin(n,{sx:r.xx,sy:r.yy});if(a(r.xx*r.yx,-r.xy*r.yy))return d(r,n);if(a(r.xx*r.xy,-r.yx*r.yy))return l(r,n);var u=o(r),c=s([r,u]),h=s([u,r]),f=new i.Matrix2D({xx:c.vector1.x,xy:c.vector2.x,yx:c.vector1.y,yy:c.vector2.y}),m=new i.Matrix2D({xx:h.vector1.x,xy:h.vector1.y,yx:h.vector2.x,yy:h.vector2.y}),p=new i.Matrix2D([i.invert(f),r,i.invert(m)]);return d(m,n),p.xx*=n.sx,p.yy*=n.sy,l(f,n),p.xx*=n.sx,p.yy*=n.sy,t.mixin(n,{sx:p.xx,sy:p.yy})}});//# sourceMappingURL=decompose.js.map