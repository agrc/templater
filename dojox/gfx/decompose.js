//>>built
define("dojox/gfx/decompose",["./_base","dojo/_base/lang","./matrix"],function(e,t,a){function i(e,t){return Math.abs(e-t)<=1e-6*(Math.abs(e)+Math.abs(t))}function n(e,t,a,i){return isFinite(e)?isFinite(a)?(t=Math.abs(t),i=Math.abs(i),(t*e+i*a)/(t+i)):e:a}function o(e){var i=new a.Matrix2D(e);return t.mixin(i,{dx:0,dy:0,xy:i.yx,yx:i.xy})}function r(e){return e.xx*e.yy<0||e.xy*e.yx>0?-1:1}function s(e){var t=a.normalize(e),n=-t.xx-t.yy,o=t.xx*t.yy-t.xy*t.yx,r=Math.sqrt(n*n-4*o),s=-(n+(0>n?-r:r))/2,l=o/s,d=t.xy/(s-t.xx),c=1,u=t.xy/(l-t.xx),m=1;i(s,l)&&(d=1,c=0,u=0,m=1),isFinite(d)||(d=1,c=(s-t.xx)/t.xy,isFinite(c)||(d=(s-t.yy)/t.yx,c=1,isFinite(d)||(d=1,c=t.yx/(s-t.yy)))),isFinite(u)||(u=1,m=(l-t.xx)/t.xy,isFinite(m)||(u=(l-t.yy)/t.yx,m=1,isFinite(u)||(u=1,m=t.yx/(l-t.yy))));var h=Math.sqrt(d*d+c*c),f=Math.sqrt(u*u+m*m);return isFinite(d/=h)||(d=0),isFinite(c/=h)||(c=0),isFinite(u/=f)||(u=0),isFinite(m/=f)||(m=0),{value1:s,value2:l,vector1:{x:d,y:c},vector2:{x:u,y:m}}}function l(e,t){var a=r(e),i=t.angle1=(Math.atan2(e.yx,e.yy)+Math.atan2(-a*e.xy,a*e.xx))/2,o=Math.cos(i),s=Math.sin(i);return t.sx=n(e.xx/o,o,-e.xy/s,s),t.sy=n(e.yy/o,o,e.yx/s,s),t}function d(e,t){var a=r(e),i=t.angle2=(Math.atan2(a*e.yx,a*e.xx)+Math.atan2(-e.xy,e.yy))/2,o=Math.cos(i),s=Math.sin(i);return t.sx=n(e.xx/o,o,e.yx/s,s),t.sy=n(e.yy/o,o,-e.xy/s,s),t}return e.decompose=function(e){var n=a.normalize(e),r={dx:n.dx,dy:n.dy,sx:1,sy:1,angle1:0,angle2:0};if(i(n.xy,0)&&i(n.yx,0))return t.mixin(r,{sx:n.xx,sy:n.yy});if(i(n.xx*n.yx,-n.xy*n.yy))return l(n,r);if(i(n.xx*n.xy,-n.yx*n.yy))return d(n,r);var c=o(n),u=s([n,c]),m=s([c,n]),h=new a.Matrix2D({xx:u.vector1.x,xy:u.vector2.x,yx:u.vector1.y,yy:u.vector2.y}),f=new a.Matrix2D({xx:m.vector1.x,xy:m.vector1.y,yx:m.vector2.x,yy:m.vector2.y}),p=new a.Matrix2D([a.invert(h),n,a.invert(f)]);return l(f,r),p.xx*=r.sx,p.yy*=r.sy,d(h,r),p.xx*=r.sx,p.yy*=r.sy,t.mixin(r,{sx:p.xx,sy:p.yy})}});//# sourceMappingURL=decompose.js.map