//>>built
define("dojox/gfx/decompose",["./_base","dojo/_base/lang","./matrix"],function(e,t,i){function r(e,t){return Math.abs(e-t)<=1e-6*(Math.abs(e)+Math.abs(t))}function a(e,t,i,r){return isFinite(e)?isFinite(i)?(t=Math.abs(t),r=Math.abs(r),(t*e+r*i)/(t+r)):e:i}function o(e){var r=new i.Matrix2D(e);return t.mixin(r,{dx:0,dy:0,xy:r.yx,yx:r.xy})}function n(e){return e.xx*e.yy<0||e.xy*e.yx>0?-1:1}function s(e){var t=i.normalize(e),a=-t.xx-t.yy,o=t.xx*t.yy-t.xy*t.yx,n=Math.sqrt(a*a-4*o),s=-(a+(0>a?-n:n))/2,l=o/s,d=t.xy/(s-t.xx),u=1,c=t.xy/(l-t.xx),h=1;r(s,l)&&(d=1,u=0,c=0,h=1),isFinite(d)||(d=1,u=(s-t.xx)/t.xy,isFinite(u)||(d=(s-t.yy)/t.yx,u=1,isFinite(d)||(d=1,u=t.yx/(s-t.yy)))),isFinite(c)||(c=1,h=(l-t.xx)/t.xy,isFinite(h)||(c=(l-t.yy)/t.yx,h=1,isFinite(c)||(c=1,h=t.yx/(l-t.yy))));var m=Math.sqrt(d*d+u*u),f=Math.sqrt(c*c+h*h);return isFinite(d/=m)||(d=0),isFinite(u/=m)||(u=0),isFinite(c/=f)||(c=0),isFinite(h/=f)||(h=0),{value1:s,value2:l,vector1:{x:d,y:u},vector2:{x:c,y:h}}}function l(e,t){var i=n(e),r=t.angle1=(Math.atan2(e.yx,e.yy)+Math.atan2(-i*e.xy,i*e.xx))/2,o=Math.cos(r),s=Math.sin(r);return t.sx=a(e.xx/o,o,-e.xy/s,s),t.sy=a(e.yy/o,o,e.yx/s,s),t}function d(e,t){var i=n(e),r=t.angle2=(Math.atan2(i*e.yx,i*e.xx)+Math.atan2(-e.xy,e.yy))/2,o=Math.cos(r),s=Math.sin(r);return t.sx=a(e.xx/o,o,e.yx/s,s),t.sy=a(e.yy/o,o,-e.xy/s,s),t}return e.decompose=function(e){var a=i.normalize(e),n={dx:a.dx,dy:a.dy,sx:1,sy:1,angle1:0,angle2:0};if(r(a.xy,0)&&r(a.yx,0))return t.mixin(n,{sx:a.xx,sy:a.yy});if(r(a.xx*a.yx,-a.xy*a.yy))return l(a,n);if(r(a.xx*a.xy,-a.yx*a.yy))return d(a,n);var u=o(a),c=s([a,u]),h=s([u,a]),m=new i.Matrix2D({xx:c.vector1.x,xy:c.vector2.x,yx:c.vector1.y,yy:c.vector2.y}),f=new i.Matrix2D({xx:h.vector1.x,xy:h.vector1.y,yx:h.vector2.x,yy:h.vector2.y}),p=new i.Matrix2D([i.invert(m),a,i.invert(f)]);return l(f,n),p.xx*=n.sx,p.yy*=n.sy,d(m,n),p.xx*=n.sx,p.yy*=n.sy,t.mixin(n,{sx:p.xx,sy:p.yy})}});//# sourceMappingURL=decompose.js.map