//>>built
define("dojox/mobile/ValuePickerSlot",["dojo/_base/array","dojo/_base/declare","dojo/_base/event","dojo/_base/lang","dojo/_base/window","dojo/dom-class","dojo/dom-construct","dojo/dom-attr","dojo/touch","dijit/_WidgetBase","./iconUtils","dojo/has","dojo/has!dojo-bidi?dojox/mobile/bidi/ValuePickerSlot"],function(e,t,i,o,n,a,r,s,d,l,u,c,h){var m=t(c("dojo-bidi")?"dojox.mobile.NonBidiValuePickerSlot":"dojox.mobile.ValuePickerSlot",l,{items:[],labels:[],labelFrom:0,labelTo:0,zeroPad:0,value:"",step:1,readOnly:!1,tabIndex:"0",plusBtnLabel:"",plusBtnLabelRef:"",minusBtnLabel:"",minusBtnLabelRef:"",baseClass:"mblValuePickerSlot",buildRendering:function(){if(this.inherited(arguments),this.initLabels(),this.labels.length>0){this.items=[];for(var e=0;e<this.labels.length;e++)this.items.push([e,this.labels[e]])}this.plusBtnNode=r.create("div",{className:"mblValuePickerSlotPlusButton mblValuePickerSlotButton",title:"+"},this.domNode),this.plusIconNode=r.create("div",{className:"mblValuePickerSlotIcon"},this.plusBtnNode),u.createIcon("mblDomButtonGrayPlus",null,this.plusIconNode),this.inputAreaNode=r.create("div",{className:"mblValuePickerSlotInputArea"},this.domNode),this.inputNode=r.create("input",{className:"mblValuePickerSlotInput",readonly:this.readOnly},this.inputAreaNode),this.minusBtnNode=r.create("div",{className:"mblValuePickerSlotMinusButton mblValuePickerSlotButton",title:"-"},this.domNode),this.minusIconNode=r.create("div",{className:"mblValuePickerSlotIcon"},this.minusBtnNode),u.createIcon("mblDomButtonGrayMinus",null,this.minusIconNode),s.set(this.plusBtnNode,"role","button"),this._setPlusBtnLabelAttr(this.plusBtnLabel),this._setPlusBtnLabelRefAttr(this.plusBtnLabelRef),s.set(this.inputNode,"role","textbox");var t=require("dijit/registry"),i=t.getUniqueId("dojo_mobile__mblValuePickerSlotInput");s.set(this.inputNode,"id",i),s.set(this.plusBtnNode,"aria-controls",i),s.set(this.minusBtnNode,"role","button"),s.set(this.minusBtnNode,"aria-controls",i),this._setMinusBtnLabelAttr(this.minusBtnLabel),this._setMinusBtnLabelRefAttr(this.minusBtnLabelRef),""===this.value&&this.items.length>0&&(this.value=this.items[0][1]),this._initialValue=this.value},startup:function(){this._started||(this._handlers=[this.connect(this.plusBtnNode,d.press,"_onTouchStart"),this.connect(this.minusBtnNode,d.press,"_onTouchStart"),this.connect(this.plusBtnNode,"onkeydown","_onClick"),this.connect(this.minusBtnNode,"onkeydown","_onClick"),this.connect(this.inputNode,"onchange",o.hitch(this,function(e){this._onChange(e)}))],this.inherited(arguments),this._set(this.plusBtnLabel))},initLabels:function(){if(this.labelFrom!==this.labelTo)for(var e=this.labels=[],t=this.zeroPad&&Array(this.zeroPad).join("0"),i=this.labelFrom;i<=this.labelTo;i+=this.step)e.push(this.zeroPad?(t+i).slice(-this.zeroPad):i+"")},spin:function(e){for(var t=-1,i=this.get("value"),o=this.items.length,n=0;o>n;n++)if(this.items[n][1]===i){t=n;break}if(-1!=i){t+=e,0>t&&(t+=(Math.abs(Math.ceil(t/o))+1)*o);var a=this.items[t%o];this.set("value",a[1])}},setInitialValue:function(){this.set("value",this._initialValue)},_onClick:function(e){if((!e||"keydown"!==e.type||13===e.keyCode)&&this.onClick(e)!==!1){var t=e.currentTarget;t!==this.plusBtnNode&&t!==this.minusBtnNode||(this._btn=t),this.spin(this._btn===this.plusBtnNode?1:-1)}},onClick:function(){},_onChange:function(e){if(this.onChange(e)!==!1){var t=this.get("value"),i=this.validate(t);this.set("value",i.length?i[0][1]:this.value)}},onChange:function(){},validate:function(t){return e.filter(this.items,function(e){return(e[1]+"").toLowerCase()==(t+"").toLowerCase()})},_onTouchStart:function(e){this._conn=[this.connect(n.body(),d.move,"_onTouchMove"),this.connect(n.body(),d.release,"_onTouchEnd")],this.touchStartX=e.touches?e.touches[0].pageX:e.clientX,this.touchStartY=e.touches?e.touches[0].pageY:e.clientY,a.add(e.currentTarget,"mblValuePickerSlotButtonSelected"),this._btn=e.currentTarget,this._timer&&(this._timer.remove(),this._timer=null),this._interval&&(clearInterval(this._interval),this._interval=null),this._timer=this.defer(function(){this._interval=setInterval(o.hitch(this,function(){this.spin(this._btn===this.plusBtnNode?1:-1)}),60),this._timer=null},1e3),i.stop(e)},_onTouchMove:function(t){var i=t.touches?t.touches[0].pageX:t.clientX,o=t.touches?t.touches[0].pageY:t.clientY;(Math.abs(i-this.touchStartX)>=4||Math.abs(o-this.touchStartY)>=4)&&(this._timer&&(this._timer.remove(),this._timer=null),this._interval&&(clearInterval(this._interval),this._interval=null),e.forEach(this._conn,this.disconnect,this),a.remove(this._btn,"mblValuePickerSlotButtonSelected"))},_onTouchEnd:function(t){this._timer&&(this._timer.remove(),this._timer=null),e.forEach(this._conn,this.disconnect,this),a.remove(this._btn,"mblValuePickerSlotButtonSelected"),this._interval?(clearInterval(this._interval),this._interval=null):this._onClick(t)},_getKeyAttr:function(){var t=this.get("value"),i=e.filter(this.items,function(e){return e[1]===t})[0];return i?i[0]:null},_getValueAttr:function(){return this.inputNode.value},_setValueAttr:function(e){this._spinToValue(e,!0)},_spinToValue:function(e,t){if(this.get("value")!=e){this.inputNode.value=e,t&&this._set("value",e);var i=this.getParent();i&&i.onValueChanged&&i.onValueChanged(this)}},_setTabIndexAttr:function(e){this.plusBtnNode.setAttribute("tabIndex",e),this.minusBtnNode.setAttribute("tabIndex",e)},_setAria:function(e,t,i){i?s.set(e,t,i):s.remove(e,t)},_setPlusBtnLabelAttr:function(e){this._setAria(this.plusBtnNode,"aria-label",e)},_setPlusBtnLabelRefAttr:function(e){this._setAria(this.plusBtnNode,"aria-labelledby",e)},_setMinusBtnLabelAttr:function(e){this._setAria(this.minusBtnNode,"aria-label",e)},_setMinusBtnLabelRefAttr:function(e){this._setAria(this.minusBtnNode,"aria-labelledby",e)}});return c("dojo-bidi")?t("dojox.mobile.ValuePickerSlot",[m,h]):m});//# sourceMappingURL=ValuePickerSlot.js.map