//>>built
define("dojox/mobile/FilteredListMixin",["require","dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/dom","dojo/dom-class","dojo/dom-construct","dojo/aspect","dijit/registry","./SearchBox","./ScrollableView","./viewRegistry"],function(e,t,i,a,o,n,r,s,d,l,h,u){return i("dojox.mobile.FilteredListMixin",null,{filterBoxRef:null,placeHolder:"",filterBoxVisible:!0,_filterBox:null,_createdFilterBox:null,_createdScrollableView:null,startup:function(){if(!this._started){if(this.inherited(arguments),this.filterBoxRef){if(this._filterBox=d.byId(this.filterBoxRef),!this._filterBox||!this._filterBox.isInstanceOf(l))throw new Error("Cannot find a widget of type dojox/mobile/SearchBox or subclass at the specified filterBoxRef: "+this.filterBoxRef);this._filterBox.set("searchAttr",this.labelProperty?this.labelProperty:"label"),this._filterBox.placeHolder||this._filterBox.set("placeHolder",this.placeHolder),this._filterBox.on("search",a.hitch(this,"_onFilter"))}else{this._filterBox=new l({searchAttr:this.labelProperty?this.labelProperty:"label",ignoreCase:!0,incremental:!0,onSearch:a.hitch(this,"_onFilter"),selectOnClick:!0,placeHolder:this.placeHolder}),this._createdFilterBox=this._filterBox,this._createdScrollableView=new h;var e=this.domNode,t=this.domNode.parentNode;t.replaceChild(this._createdScrollableView.domNode,this.domNode),r.place(e,this._createdScrollableView.containerNode);var i=r.create("div");r.place(this._createdFilterBox.domNode,i),r.place(i,this._createdScrollableView.domNode,"before"),this.filterBoxClass&&n.add(i,this.filterBoxClass),this._createdFilterBox.startup(),this._createdScrollableView.startup(),this._createdScrollableView.resize()}var o=u.getEnclosingScrollable(this.domNode);o&&this.connect(o,"onFlickAnimationEnd",a.hitch(this,function(){this._filterBox.focusNode.value||(this._previousUnfilteredScrollPos=o.getPos())})),this.store?this._initStore():this._createStore(this._initStore)}},_setFilterBoxVisibleAttr:function(e){this._set("filterBoxVisible",e),this._filterBox&&this._filterBox.domNode&&(this._filterBox.domNode.style.display=e?"":"none")},_setPlaceHolderAttr:function(e){this._set("placeHolder",e),this._filterBox&&this._filterBox.set("placeHolder",e)},getFilterBox:function(){return this._filterBox},getScrollableView:function(){return this._createdScrollableView},_initStore:function(){var t=this.store;t.get&&t.query?this._filterBox.store=t:e(["dojo/store/DataStore"],a.hitch(this,function(e){t=new e({store:t}),this._filterBox.store=t}))},_createStore:function(o){e(["./_StoreListMixin","dojo/store/Memory"],a.hitch(this,function(e,n){i.safeMixin(this,new e),this.append=!0,this.createListItem=function(e){return e.listItem},s.before(this,"generateList",function(){t.forEach(this.getChildren(),function(e){e.domNode.parentNode.removeChild(e.domNode)})});var r=[],d=null;t.forEach(this.getChildren(),function(e){d=e.label?e.label:e.domNode.innerText||e.domNode.textContent,r.push({label:d,listItem:e})});var l={items:r},h=new n({idProperty:"label",data:l});this.store=null,this.query={},this.setStore(h,this.query,this.queryOptions),a.hitch(this,o)()}))},_onFilter:function(e,t,i){if(this.onFilter(e,t,i)!==!1){this.setQuery(t);var a=u.getEnclosingScrollable(this.domNode);a&&a.scrollTo(this._filterBox.focusNode.value?{x:0,y:0}:this._previousUnfilteredScrollPos||{x:0,y:0})}},onFilter:function(){},destroy:function(e){this.inherited(arguments),this._createdFilterBox&&(this._createdFilterBox.destroy(e),this._createdFilterBox=null),this._createdScrollableView&&(this._createdScrollableView.destroy(e),this._createdScrollableView=null)}})});//# sourceMappingURL=FilteredListMixin.js.map