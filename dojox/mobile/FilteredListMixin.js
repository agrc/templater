//>>built
define("dojox/mobile/FilteredListMixin",["require","dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/dom","dojo/dom-class","dojo/dom-construct","dojo/aspect","dijit/registry","./SearchBox","./ScrollableView","./viewRegistry"],function(e,t,a,i,r,n,o,s,l,d,u,c){return a("dojox.mobile.FilteredListMixin",null,{filterBoxRef:null,placeHolder:"",filterBoxVisible:!0,_filterBox:null,_createdFilterBox:null,_createdScrollableView:null,startup:function(){if(!this._started){if(this.inherited(arguments),this.filterBoxRef){if(this._filterBox=l.byId(this.filterBoxRef),!this._filterBox||!this._filterBox.isInstanceOf(d))throw new Error("Cannot find a widget of type dojox/mobile/SearchBox or subclass at the specified filterBoxRef: "+this.filterBoxRef);this._filterBox.set("searchAttr",this.labelProperty?this.labelProperty:"label"),this._filterBox.placeHolder||this._filterBox.set("placeHolder",this.placeHolder),this._filterBox.on("search",i.hitch(this,"_onFilter"))}else{this._filterBox=new d({searchAttr:this.labelProperty?this.labelProperty:"label",ignoreCase:!0,incremental:!0,onSearch:i.hitch(this,"_onFilter"),selectOnClick:!0,placeHolder:this.placeHolder}),this._createdFilterBox=this._filterBox,this._createdScrollableView=new u;var e=this.domNode,t=this.domNode.parentNode;t.replaceChild(this._createdScrollableView.domNode,this.domNode),o.place(e,this._createdScrollableView.containerNode);var a=o.create("div");o.place(this._createdFilterBox.domNode,a),o.place(a,this._createdScrollableView.domNode,"before"),this.filterBoxClass&&n.add(a,this.filterBoxClass),this._createdFilterBox.startup(),this._createdScrollableView.startup(),this._createdScrollableView.resize()}var r=c.getEnclosingScrollable(this.domNode);r&&this.connect(r,"onFlickAnimationEnd",i.hitch(this,function(){this._filterBox.focusNode.value||(this._previousUnfilteredScrollPos=r.getPos())})),this.store?this._initStore():this._createStore(this._initStore)}},_setFilterBoxVisibleAttr:function(e){this._set("filterBoxVisible",e),this._filterBox&&this._filterBox.domNode&&(this._filterBox.domNode.style.display=e?"":"none")},_setPlaceHolderAttr:function(e){this._set("placeHolder",e),this._filterBox&&this._filterBox.set("placeHolder",e)},getFilterBox:function(){return this._filterBox},getScrollableView:function(){return this._createdScrollableView},_initStore:function(){var t=this.store;t.get&&t.query?this._filterBox.store=t:e(["dojo/store/DataStore"],i.hitch(this,function(e){t=new e({store:t}),this._filterBox.store=t}))},_createStore:function(r){e(["./_StoreListMixin","dojo/store/Memory"],i.hitch(this,function(e,n){a.safeMixin(this,new e),this.append=!0,this.createListItem=function(e){return e.listItem},s.before(this,"generateList",function(){t.forEach(this.getChildren(),function(e){e.domNode.parentNode.removeChild(e.domNode)})});var o=[],l=null;t.forEach(this.getChildren(),function(e){l=e.label?e.label:e.domNode.innerText||e.domNode.textContent,o.push({label:l,listItem:e})});var d={items:o},u=new n({idProperty:"label",data:d});this.store=null,this.query={},this.setStore(u,this.query,this.queryOptions),i.hitch(this,r)()}))},_onFilter:function(e,t,a){if(this.onFilter(e,t,a)!==!1){this.setQuery(t);var i=c.getEnclosingScrollable(this.domNode);i&&i.scrollTo(this._filterBox.focusNode.value?{x:0,y:0}:this._previousUnfilteredScrollPos||{x:0,y:0})}},onFilter:function(){},destroy:function(e){this.inherited(arguments),this._createdFilterBox&&(this._createdFilterBox.destroy(e),this._createdFilterBox=null),this._createdScrollableView&&(this._createdScrollableView.destroy(e),this._createdScrollableView=null)}})});//# sourceMappingURL=FilteredListMixin.js.map