//>>built
define("dijit/_PaletteMixin",["dojo/_base/declare","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/keys","dojo/_base/lang","dojo/on","./_CssStateMixin","./a11yclick","./focus","./typematic"],function(t,e,i,o,s,n,a,r,d,c,h){var l=t("dijit._PaletteMixin",r,{defaultTimeout:500,timeoutChangeRate:.9,value:"",_selectedCell:-1,tabIndex:"0",cellClass:"dijitPaletteCell",dyeClass:null,_dyeFactory:function(t){var e="string"==typeof this.dyeClass?n.getObject(this.dyeClass):this.dyeClass;return new e(t)},_preparePalette:function(t,e){this._cells=[];var i=this._blankGif;this.own(a(this.gridNode,d,n.hitch(this,"_onCellClick")));for(var r=0;r<t.length;r++)for(var c=o.create("tr",{tabIndex:"-1",role:"row"},this.gridNode),l=0;l<t[r].length;l++){var u=t[r][l];if(u){var f=this._dyeFactory(u,r,l,e[u]),p=o.create("td",{"class":this.cellClass,tabIndex:"-1",title:e[u],role:"gridcell"},c);f.fillCell(p,i),p.idx=this._cells.length,this._cells.push({node:p,dye:f})}}this._xDim=t[0].length,this._yDim=t.length;var _={UP_ARROW:-this._xDim,DOWN_ARROW:this._xDim,RIGHT_ARROW:this.isLeftToRight()?1:-1,LEFT_ARROW:this.isLeftToRight()?-1:1};for(var g in _)this.own(h.addKeyListener(this.domNode,{keyCode:s[g],ctrlKey:!1,altKey:!1,shiftKey:!1},this,function(){var t=_[g];return function(e){this._navigateByKey(t,e)}}(),this.timeoutChangeRate,this.defaultTimeout))},postCreate:function(){this.inherited(arguments),this._setCurrent(this._cells[0].node)},focus:function(){c.focus(this._currentFocus)},_onCellClick:function(t){for(var e=t.target;"TD"!=e.tagName;){if(!e.parentNode||e==this.gridNode)return;e=e.parentNode}var i=this._getDye(e).getValue();this._setCurrent(e),c.focus(e),this._setValueAttr(i,!0),t.stopPropagation(),t.preventDefault()},_setCurrent:function(t){"_currentFocus"in this&&e.set(this._currentFocus,"tabIndex","-1"),this._currentFocus=t,t&&e.set(t,"tabIndex",this.tabIndex)},_setValueAttr:function(t,e){if(this._selectedCell>=0&&i.remove(this._cells[this._selectedCell].node,this.cellClass+"Selected"),this._selectedCell=-1,t)for(var o=0;o<this._cells.length;o++)if(t==this._cells[o].dye.getValue()){this._selectedCell=o,i.add(this._cells[o].node,this.cellClass+"Selected");break}this._set("value",this._selectedCell>=0?t:null),(e||void 0===e)&&this.onChange(t)},onChange:function(){},_navigateByKey:function(t,e){if(-1!=e){var i=this._currentFocus.idx+t;if(i<this._cells.length&&i>-1){var o=this._cells[i].node;this._setCurrent(o),this.defer(n.hitch(c,"focus",o))}}},_getDye:function(t){return this._cells[t.idx].dye}});return l});//# sourceMappingURL=_PaletteMixin.js.map