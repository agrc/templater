//>>built
define("dijit/_base/focus",["dojo/_base/array","dojo/dom","dojo/_base/lang","dojo/topic","dojo/_base/window","../focus","../selection","../main"],function(t,e,o,i,n,s,a,r){var d={_curFocus:null,_prevFocus:null,isCollapsed:function(){return r.getBookmark().isCollapsed},getBookmark:function(){return(n.global==window?a:new a.SelectionManager(n.global)).getBookmark()},moveToBookmark:function(t){return(n.global==window?a:new a.SelectionManager(n.global)).moveToBookmark(t)},getFocus:function(t,o){var i=!s.curNode||t&&e.isDescendant(s.curNode,t.domNode)?r._prevFocus:s.curNode;return{node:i,bookmark:i&&i==s.curNode&&n.withGlobal(o||n.global,r.getBookmark),openedForWindow:o}},_activeStack:[],registerIframe:function(t){return s.registerIframe(t)},unregisterIframe:function(t){t&&t.remove()},registerWin:function(t,e){return s.registerWin(t,e)},unregisterWin:function(t){t&&t.remove()}};return s.focus=function(t){if(t){var e="node"in t?t.node:t,o=t.bookmark,i=t.openedForWindow,a=!!o&&o.isCollapsed;if(e){var d="iframe"==e.tagName.toLowerCase()?e.contentWindow:e;if(d&&d.focus)try{d.focus()}catch(t){}s._onFocusNode(e)}if(o&&n.withGlobal(i||n.global,r.isCollapsed)&&!a){i&&i.focus();try{n.withGlobal(i||n.global,r.moveToBookmark,null,[o])}catch(t){}}}},s.watch("curNode",function(t,e,o){r._curFocus=o,r._prevFocus=e,o&&i.publish("focusNode",o)}),s.watch("activeStack",function(t,e,o){r._activeStack=o}),s.on("widget-blur",function(t,e){i.publish("widgetBlur",t,e)}),s.on("widget-focus",function(t,e){i.publish("widgetFocus",t,e)}),o.mixin(r,d),r});//# sourceMappingURL=focus.js.map