//>>built
define("dijit/popup",["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/has","dojo/keys","dojo/_base/lang","dojo/on","./place","./BackgroundIframe","./Viewport","./main","dojo/touch"],function(e,t,i,o,n,a,s,r,d,c,l,h,u,p,f,g){function m(){this._popupWrapper&&(a.destroy(this._popupWrapper),delete this._popupWrapper)}var v=i(null,{_stack:[],_beginZIndex:1e3,_idGen:1,_repositionAll:function(){if(this._firstAroundNode){var e=this._firstAroundPosition,t=s.position(this._firstAroundNode,!0),i=t.x-e.x,o=t.y-e.y;if(i||o){this._firstAroundPosition=t;for(var n=0;n<this._stack.length;n++){var a=this._stack[n].wrapper.style;a.top=parseFloat(a.top)+o+"px","auto"==a.right?a.left=parseFloat(a.left)+i+"px":a.right=parseFloat(a.right)-i+"px"}}this._aroundMoveListener=setTimeout(l.hitch(this,"_repositionAll"),i||o?10:50)}},_createWrapper:function(e){var i=e._popupWrapper,o=e.domNode;if(!i){i=a.create("div",{"class":"dijitPopup",style:{display:"none"},role:"region","aria-label":e["aria-label"]||e.label||e.name||e.id},e.ownerDocumentBody),i.appendChild(o);var n=o.style;n.display="",n.visibility="",n.position="",n.top="0px",e._popupWrapper=i,t.after(e,"destroy",m,!0),"ontouchend"in document&&h(i,"touchend",function(e){/^(input|button|textarea)$/i.test(e.target.tagName)||e.preventDefault()}),i.dojoClick=!0}return i},moveOffScreen:function(e){var t=this._createWrapper(e),i=s.isBodyLtr(e.ownerDocument),o={visibility:"hidden",top:"-9999px",display:""};return o[i?"left":"right"]="-9999px",o[i?"right":"left"]="auto",r.set(t,o),t},hide:function(e){var t=this._createWrapper(e);r.set(t,{display:"none",height:"auto",overflowY:"visible",border:""});var i=e.domNode;"_originalStyle"in i&&(i.style.cssText=i._originalStyle)},getTopPopup:function(){for(var e=this._stack,t=e.length-1;t>0&&e[t].parent===e[t-1].widget;t--);return e[t]},open:function(e){for(var t=this._stack,i=e.popup,a=i.domNode,g=e.orient||["below","below-alt","above","above-alt"],m=e.parent?e.parent.isLeftToRight():s.isBodyLtr(i.ownerDocument),v=e.around,_=e.around&&e.around.id?e.around.id+"_dropdown":"popup_"+this._idGen++;t.length&&(!e.parent||!o.isDescendant(e.parent.domNode,t[t.length-1].widget.domNode));)this.close(t[t.length-1].widget);var b=this.moveOffScreen(i);i.startup&&!i._started&&i.startup();var y,j=s.position(a);if("maxHeight"in e&&-1!=e.maxHeight)y=e.maxHeight||1/0;else{var C=f.getEffectiveBox(this.ownerDocument),w=v?s.position(v,!1):{y:e.y-(e.padding||0),h:2*(e.padding||0)};y=Math.floor(Math.max(w.y,C.h-(w.y+w.h)))}if(j.h>y){var x=r.getComputedStyle(a),k=x.borderLeftWidth+" "+x.borderLeftStyle+" "+x.borderLeftColor;r.set(b,{overflowY:"scroll",height:y+"px",border:k}),a._originalStyle=a.style.cssText,a.style.border="none"}n.set(b,{id:_,style:{zIndex:this._beginZIndex+t.length},"class":"dijitPopup "+(i.baseClass||i["class"]||"").split(" ")[0]+"Popup",dijitPopupParent:e.parent?e.parent.id:""}),0==t.length&&v&&(this._firstAroundNode=v,this._firstAroundPosition=s.position(v,!0),this._aroundMoveListener=setTimeout(l.hitch(this,"_repositionAll"),50)),d("config-bgIframe")&&!i.bgIframe&&(i.bgIframe=new p(b));var S=i.orient?l.hitch(i,"orient"):null,N=v?u.around(b,v,g,m,S):u.at(b,e,"R"==g?["TR","BR","TL","BL"]:["TL","BL","TR","BR"],e.padding,S);b.style.visibility="visible",a.style.visibility="visible";var T=[];return T.push(h(b,"keydown",l.hitch(this,function(t){if(t.keyCode==c.ESCAPE&&e.onCancel)t.stopPropagation(),t.preventDefault(),e.onCancel();else if(t.keyCode==c.TAB){t.stopPropagation(),t.preventDefault();var i=this.getTopPopup();i&&i.onCancel&&i.onCancel()}}))),i.onCancel&&e.onCancel&&T.push(i.on("cancel",e.onCancel)),T.push(i.on(i.onExecute?"execute":"change",l.hitch(this,function(){var e=this.getTopPopup();e&&e.onExecute&&e.onExecute()}))),t.push({widget:i,wrapper:b,parent:e.parent,onExecute:e.onExecute,onCancel:e.onCancel,onClose:e.onClose,handlers:T}),i.onOpen&&i.onOpen(N),N},close:function(t){for(var i=this._stack;t&&e.some(i,function(e){return e.widget==t})||!t&&i.length;){var o=i.pop(),n=o.widget,a=o.onClose;n.bgIframe&&(n.bgIframe.destroy(),delete n.bgIframe),n.onClose&&n.onClose();for(var s;s=o.handlers.pop();)s.remove();n&&n.domNode&&this.hide(n),a&&a()}0==i.length&&this._aroundMoveListener&&(clearTimeout(this._aroundMoveListener),this._firstAroundNode=this._firstAroundPosition=this._aroundMoveListener=null)}});return g.popup=new v});//# sourceMappingURL=popup.js.map