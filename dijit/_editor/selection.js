//>>built
define("dijit/_editor/selection",["dojo/dom","dojo/_base/lang","dojo/sniff","dojo/_base/window","../main"],function(e,t,i,n,o){var a={getType:function(){if(n.doc.getSelection){var e,t="text";try{e=n.global.getSelection()}catch(i){}if(e&&1==e.rangeCount){var o=e.getRangeAt(0);o.startContainer==o.endContainer&&o.endOffset-o.startOffset==1&&3!=o.startContainer.nodeType&&(t="control")}return t}return n.doc.selection.type.toLowerCase()},getSelectedText:function(){if(n.doc.getSelection){var e=n.global.getSelection();return e?e.toString():""}return"control"==o._editor.selection.getType()?null:n.doc.selection.createRange().text},getSelectedHtml:function(){if(n.doc.getSelection){var e=n.global.getSelection();if(e&&e.rangeCount){var t,i="";for(t=0;t<e.rangeCount;t++){var a=e.getRangeAt(t).cloneContents(),r=n.doc.createElement("div");r.appendChild(a),i+=r.innerHTML}return i}return null}return"control"==o._editor.selection.getType()?null:n.doc.selection.createRange().htmlText},getSelectedElement:function(){if("control"==o._editor.selection.getType()){if(n.doc.getSelection){var e=n.global.getSelection();return e.anchorNode.childNodes[e.anchorOffset]}var t=n.doc.selection.createRange();if(t&&t.item)return n.doc.selection.createRange().item(0)}return null},getParentElement:function(){if("control"==o._editor.selection.getType()){var e=this.getSelectedElement();if(e)return e.parentNode}else{if(!n.doc.getSelection){var t=n.doc.selection.createRange();return t.collapse(!0),t.parentElement()}var i=n.global.getSelection();if(i){for(var a=i.anchorNode;a&&1!=a.nodeType;)a=a.parentNode;return a}}return null},hasAncestorElement:function(e){return null!=this.getAncestorElement.apply(this,arguments)},getAncestorElement:function(e){var t=this.getSelectedElement()||this.getParentElement();return this.getParentOfType(t,arguments)},isTag:function(e,t){if(e&&e.tagName)for(var i=e.tagName.toLowerCase(),n=0;n<t.length;n++){var o=String(t[n]).toLowerCase();if(i==o)return o}return""},getParentOfType:function(e,t){for(;e;){if(this.isTag(e,t).length)return e;e=e.parentNode}return null},collapse:function(e){if(n.doc.getSelection){var t=n.global.getSelection();t.removeAllRanges?e?t.collapseToStart():t.collapseToEnd():t.collapse(e)}else{var i=n.doc.selection.createRange();i.collapse(e),i.select()}},remove:function(){var e=n.doc.selection;return n.doc.getSelection?(e=n.global.getSelection(),e.deleteFromDocument(),e):("none"!=e.type.toLowerCase()&&e.clear(),e)},selectElementChildren:function(t,o){var a,r=n.doc;if(t=e.byId(t),n.doc.getSelection){var s=n.global.getSelection();i("opera")?(a=s.rangeCount?s.getRangeAt(0):r.createRange(),a.setStart(t,0),a.setEnd(t,3==t.nodeType?t.length:t.childNodes.length),s.addRange(a)):s.selectAllChildren(t)}else if(a=t.ownerDocument.body.createTextRange(),a.moveToElementText(t),!o)try{a.select()}catch(d){}},selectElement:function(t,o){var a;t=e.byId(t);var r=t.ownerDocument,s=n.global;if(r.getSelection){var d=s.getSelection();a=r.createRange(),d.removeAllRanges&&(i("opera")&&d.getRangeAt(0)&&(a=d.getRangeAt(0)),a.selectNode(t),d.removeAllRanges(),d.addRange(a))}else try{var l=t.tagName?t.tagName.toLowerCase():"";a="img"===l||"table"===l?n.body(r).createControlRange():n.body(r).createRange(),a.addElement(t),o||a.select()}catch(c){this.selectElementChildren(t,o)}},inSelection:function(e){if(e){var t,i,o=n.doc;if(n.doc.getSelection){var a=n.global.getSelection();if(a&&a.rangeCount>0&&(i=a.getRangeAt(0)),i&&i.compareBoundaryPoints&&o.createRange)try{if(t=o.createRange(),t.setStart(e,0),1===i.compareBoundaryPoints(i.START_TO_END,t))return!0}catch(r){}}else{i=o.selection.createRange();try{t=e.ownerDocument.body.createControlRange(),t&&t.addElement(e)}catch(s){try{t=e.ownerDocument.body.createTextRange(),t.moveToElementText(e)}catch(d){}}if(i&&t&&1===i.compareEndPoints("EndToStart",t))return!0}}return!1}};return t.setObject("dijit._editor.selection",a),a});//# sourceMappingURL=selection.js.map