//>>built
define("dijit/_editor/selection",["dojo/dom","dojo/_base/lang","dojo/sniff","dojo/_base/window","../main"],function(e,t,n,o,i){var r={getType:function(){if(o.doc.getSelection){var e,t="text";try{e=o.global.getSelection()}catch(n){}if(e&&1==e.rangeCount){var i=e.getRangeAt(0);i.startContainer==i.endContainer&&i.endOffset-i.startOffset==1&&3!=i.startContainer.nodeType&&(t="control")}return t}return o.doc.selection.type.toLowerCase()},getSelectedText:function(){if(o.doc.getSelection){var e=o.global.getSelection();return e?e.toString():""}return"control"==i._editor.selection.getType()?null:o.doc.selection.createRange().text},getSelectedHtml:function(){if(o.doc.getSelection){var e=o.global.getSelection();if(e&&e.rangeCount){var t,n="";for(t=0;t<e.rangeCount;t++){var r=e.getRangeAt(t).cloneContents(),a=o.doc.createElement("div");a.appendChild(r),n+=a.innerHTML}return n}return null}return"control"==i._editor.selection.getType()?null:o.doc.selection.createRange().htmlText},getSelectedElement:function(){if("control"==i._editor.selection.getType()){if(o.doc.getSelection){var e=o.global.getSelection();return e.anchorNode.childNodes[e.anchorOffset]}var t=o.doc.selection.createRange();if(t&&t.item)return o.doc.selection.createRange().item(0)}return null},getParentElement:function(){if("control"==i._editor.selection.getType()){var e=this.getSelectedElement();if(e)return e.parentNode}else{if(!o.doc.getSelection){var t=o.doc.selection.createRange();return t.collapse(!0),t.parentElement()}var n=o.global.getSelection();if(n){for(var r=n.anchorNode;r&&1!=r.nodeType;)r=r.parentNode;return r}}return null},hasAncestorElement:function(e){return null!=this.getAncestorElement.apply(this,arguments)},getAncestorElement:function(e){var t=this.getSelectedElement()||this.getParentElement();return this.getParentOfType(t,arguments)},isTag:function(e,t){if(e&&e.tagName)for(var n=e.tagName.toLowerCase(),o=0;o<t.length;o++){var i=String(t[o]).toLowerCase();if(n==i)return i}return""},getParentOfType:function(e,t){for(;e;){if(this.isTag(e,t).length)return e;e=e.parentNode}return null},collapse:function(e){if(o.doc.getSelection){var t=o.global.getSelection();t.removeAllRanges?e?t.collapseToStart():t.collapseToEnd():t.collapse(e)}else{var n=o.doc.selection.createRange();n.collapse(e),n.select()}},remove:function(){var e=o.doc.selection;return o.doc.getSelection?(e=o.global.getSelection(),e.deleteFromDocument(),e):("none"!=e.type.toLowerCase()&&e.clear(),e)},selectElementChildren:function(t,i){var r,a=o.doc;if(t=e.byId(t),o.doc.getSelection){var c=o.global.getSelection();n("opera")?(r=c.rangeCount?c.getRangeAt(0):a.createRange(),r.setStart(t,0),r.setEnd(t,3==t.nodeType?t.length:t.childNodes.length),c.addRange(r)):c.selectAllChildren(t)}else if(r=t.ownerDocument.body.createTextRange(),r.moveToElementText(t),!i)try{r.select()}catch(s){}},selectElement:function(t,i){var r;t=e.byId(t);var a=t.ownerDocument,c=o.global;if(a.getSelection){var s=c.getSelection();r=a.createRange(),s.removeAllRanges&&(n("opera")&&s.getRangeAt(0)&&(r=s.getRangeAt(0)),r.selectNode(t),s.removeAllRanges(),s.addRange(r))}else try{var d=t.tagName?t.tagName.toLowerCase():"";r="img"===d||"table"===d?o.body(a).createControlRange():o.body(a).createRange(),r.addElement(t),i||r.select()}catch(l){this.selectElementChildren(t,i)}},inSelection:function(e){if(e){var t,n,i=o.doc;if(o.doc.getSelection){var r=o.global.getSelection();if(r&&r.rangeCount>0&&(n=r.getRangeAt(0)),n&&n.compareBoundaryPoints&&i.createRange)try{if(t=i.createRange(),t.setStart(e,0),1===n.compareBoundaryPoints(n.START_TO_END,t))return!0}catch(a){}}else{n=i.selection.createRange();try{t=e.ownerDocument.body.createControlRange(),t&&t.addElement(e)}catch(c){try{t=e.ownerDocument.body.createTextRange(),t.moveToElementText(e)}catch(s){}}if(n&&t&&1===n.compareEndPoints("EndToStart",t))return!0}}return!1}};return t.setObject("dijit._editor.selection",r),r});//# sourceMappingURL=selection.js.map