//>>built
define("dijit/selection",["dojo/_base/array","dojo/dom","dojo/_base/lang","dojo/sniff","dojo/_base/window","dijit/focus"],function(e,t,i,o,n,a){var s=function(s){var r=s.document;this.getType=function(){if(r.getSelection){var e,t="text";try{e=s.getSelection()}catch(i){}if(e&&1==e.rangeCount){var o=e.getRangeAt(0);o.startContainer==o.endContainer&&o.endOffset-o.startOffset==1&&3!=o.startContainer.nodeType&&(t="control")}return t}return r.selection.type.toLowerCase()},this.getSelectedText=function(){if(r.getSelection){var e=s.getSelection();return e?e.toString():""}return"control"==this.getType()?null:r.selection.createRange().text},this.getSelectedHtml=function(){if(r.getSelection){var e=s.getSelection();if(e&&e.rangeCount){var t,i="";for(t=0;t<e.rangeCount;t++){var o=e.getRangeAt(t).cloneContents(),n=r.createElement("div");n.appendChild(o),i+=n.innerHTML}return i}return null}return"control"==this.getType()?null:r.selection.createRange().htmlText},this.getSelectedElement=function(){if("control"==this.getType()){if(r.getSelection){var e=s.getSelection();return e.anchorNode.childNodes[e.anchorOffset]}var t=r.selection.createRange();if(t&&t.item)return r.selection.createRange().item(0)}return null},this.getParentElement=function(){if("control"==this.getType()){var e=this.getSelectedElement();if(e)return e.parentNode}else{if(!r.getSelection){var t=r.selection.createRange();return t.collapse(!0),t.parentElement()}var i=r.getSelection();if(i){for(var o=i.anchorNode;o&&1!=o.nodeType;)o=o.parentNode;return o}}return null},this.hasAncestorElement=function(e){return null!=this.getAncestorElement.apply(this,arguments)},this.getAncestorElement=function(e){var t=this.getSelectedElement()||this.getParentElement();return this.getParentOfType(t,arguments)},this.isTag=function(e,t){if(e&&e.tagName)for(var i=e.tagName.toLowerCase(),o=0;o<t.length;o++){var n=String(t[o]).toLowerCase();if(i==n)return n}return""},this.getParentOfType=function(e,t){for(;e;){if(this.isTag(e,t).length)return e;e=e.parentNode}return null},this.collapse=function(e){if(r.getSelection){var t=s.getSelection();t.removeAllRanges?e?t.collapseToStart():t.collapseToEnd():t.collapse(e)}else{var i=r.selection.createRange();i.collapse(e),i.select()}},this.remove=function(){var e=r.selection;return r.getSelection?(e=s.getSelection(),e.deleteFromDocument(),e):("none"!=e.type.toLowerCase()&&e.clear(),e)},this.selectElementChildren=function(e,i){var n;if(e=t.byId(e),r.getSelection){var a=s.getSelection();o("opera")?(n=a.rangeCount?a.getRangeAt(0):r.createRange(),n.setStart(e,0),n.setEnd(e,3==e.nodeType?e.length:e.childNodes.length),a.addRange(n)):a.selectAllChildren(e)}else if(n=e.ownerDocument.body.createTextRange(),n.moveToElementText(e),!i)try{n.select()}catch(d){}},this.selectElement=function(e,i){var a;if(e=t.byId(e),r.getSelection){var s=r.getSelection();a=r.createRange(),s.removeAllRanges&&(o("opera")&&s.getRangeAt(0)&&(a=s.getRangeAt(0)),a.selectNode(e),s.removeAllRanges(),s.addRange(a))}else try{var d=e.tagName?e.tagName.toLowerCase():"";a="img"===d||"table"===d?n.body(r).createControlRange():n.body(r).createRange(),a.addElement(e),i||a.select()}catch(l){this.selectElementChildren(e,i)}},this.inSelection=function(e){if(e){var t,i;if(r.getSelection){var o=s.getSelection();if(o&&o.rangeCount>0&&(i=o.getRangeAt(0)),i&&i.compareBoundaryPoints&&r.createRange)try{if(t=r.createRange(),t.setStart(e,0),1===i.compareBoundaryPoints(i.START_TO_END,t))return!0}catch(n){}}else{i=r.selection.createRange();try{t=e.ownerDocument.body.createTextRange(),t.moveToElementText(e)}catch(a){}if(i&&t&&1===i.compareEndPoints("EndToStart",t))return!0}}return!1},this.getBookmark=function(){var e,t,i,o=r.selection,n=a.curNode;if(r.getSelection){if(o=s.getSelection())if(o.isCollapsed){if(i=n?n.tagName:"",i&&(i=i.toLowerCase(),"textarea"==i||"input"==i&&(!n.type||"text"==n.type.toLowerCase())))return o={start:n.selectionStart,end:n.selectionEnd,node:n,pRange:!0},{isCollapsed:o.end<=o.start,mark:o};e={isCollapsed:!0},o.rangeCount&&(e.mark=o.getRangeAt(0).cloneRange())}else t=o.getRangeAt(0),e={isCollapsed:!1,mark:t.cloneRange()}}else if(o){if(i=n?n.tagName:"",i=i.toLowerCase(),n&&i&&("button"==i||"textarea"==i||"input"==i))return o.type&&"none"==o.type.toLowerCase()?{isCollapsed:!0,mark:null}:(t=o.createRange(),{isCollapsed:!t.text||!t.text.length,mark:{range:t,pRange:!0}});e={};try{t=o.createRange(),e.isCollapsed=!("Text"==o.type?t.htmlText.length:t.length)}catch(d){return e.isCollapsed=!0,e}if("CONTROL"==o.type.toUpperCase())if(t.length){e.mark=[];for(var l=0,c=t.length;c>l;)e.mark.push(t.item(l++))}else e.isCollapsed=!0,e.mark=null;else e.mark=t.getBookmark()}return e},this.moveToBookmark=function(t){var o=t.mark;if(o)if(r.getSelection){var n=s.getSelection();if(n&&n.removeAllRanges)if(o.pRange){var a=o.node;a.selectionStart=o.start,a.selectionEnd=o.end}else n.removeAllRanges(),n.addRange(o)}else if(r.selection&&o){var d;o.pRange?d=o.range:i.isArray(o)?(d=r.body.createControlRange(),e.forEach(o,function(e){d.addElement(e)})):(d=r.body.createTextRange(),d.moveToBookmark(o)),d.select()}},this.isCollapsed=function(){return this.getBookmark().isCollapsed}},r=new s(window);return r.SelectionManager=s,r});//# sourceMappingURL=selection.js.map