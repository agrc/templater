//>>built
define("dojo/back",["./_base/config","./_base/lang","./sniff","./dom","./dom-construct","./_base/window","require"],function(e,t,i,o,n,s,r){function a(){var e=N.pop();if(e){var t=N[N.length-1];t||0!=N.length||(t=b),t&&(t.kwArgs.back?t.kwArgs.back():t.kwArgs.backButton?t.kwArgs.backButton():t.kwArgs.handle&&t.kwArgs.handle("back")),y.push(e)}}function d(){var e=y.pop();e&&(e.kwArgs.forward?e.kwArgs.forward():e.kwArgs.forwardButton?e.kwArgs.forwardButton():e.kwArgs.handle&&e.kwArgs.handle("forward"),N.push(e))}function h(e,t,i){return{url:e,kwArgs:t,urlHash:i}}function l(e){var t=e.split("?");return t.length<2?null:t[1]}function c(){var t=(e.dojoIframeHistoryUrl||r.toUrl("./resources/iframe_history.html"))+"?"+(new Date).getTime();return w=!0,C&&(i("webkit")?C.location=t:window.frames[C.name].location=t),t}function u(){if(!T){var e=N.length,t=m();if((t===v||window.location.href==_)&&1==e)return void a();if(y.length>0&&y[y.length-1].urlHash===t)return void d();e>=2&&N[e-2]&&N[e-2].urlHash===t&&a()}}var p={};t.setObject("dojo.back",p);var f,m=p.getHash=function(){var e=window.location.hash;return"#"==e.charAt(0)&&(e=e.substring(1)),i("mozilla")?e:decodeURIComponent(e)},g=p.setHash=function(e){e||(e=""),window.location.hash=encodeURIComponent(e),f=history.length},_="undefined"!=typeof window?window.location.href:"",v="undefined"!=typeof window?m():"",b=null,j=null,x=null,C=null,y=[],N=[],w=!1,T=!1;return p.goBack=a,p.goForward=d,p.init=function(){if(!o.byId("dj_history")){var t=e.dojoIframeHistoryUrl||r.toUrl("./resources/iframe_history.html");e.afterOnLoad||document.write('<iframe style="border:0;width:1px;height:1px;position:absolute;visibility:hidden;bottom:0;right:0;" name="dj_history" id="dj_history" src="'+t+'"></iframe>')}},p.setInitialState=function(e){b=h(_,e,v)},p.addToHistory=function(t){y=[];var o=null,r=null;if(C||(e.useXDomain&&!e.dojoIframeHistoryUrl,C=window.frames.dj_history),x||(x=n.create("a",{style:{display:"none"}},s.body())),t.changeUrl){if(o=""+(t.changeUrl!==!0?t.changeUrl:(new Date).getTime()),0==N.length&&b.urlHash==o)return void(b=h(r,t,o));if(N.length>0&&N[N.length-1].urlHash==o)return void(N[N.length-1]=h(r,t,o));if(T=!0,setTimeout(function(){g(o),T=!1},1),x.href=o,i("ie")){r=c();var a=t.back||t.backButton||t.handle,d=function(e){""!=m()&&setTimeout(function(){g(o)},1),a.apply(this,[e])};t.back?t.back=d:t.backButton?t.backButton=d:t.handle&&(t.handle=d);var l=t.forward||t.forwardButton||t.handle,p=function(e){""!=m()&&g(o),l&&l.apply(this,[e])};t.forward?t.forward=p:t.forwardButton?t.forwardButton=p:t.handle&&(t.handle=p)}else i("ie")||j||(j=setInterval(u,200))}else r=c();N.push(h(r,t,o))},p._iframeLoaded=function(e,t){var i=l(t.href);return null==i?void(1==N.length&&a()):w?void(w=!1):void(N.length>=2&&i==l(N[N.length-2].url)?a():y.length>0&&i==l(y[y.length-1].url)&&d())},p});//# sourceMappingURL=back.js.map