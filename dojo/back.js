//>>built
define("dojo/back",["./_base/config","./_base/lang","./sniff","./dom","./dom-construct","./_base/window","require"],function(t,e,i,o,n,s,r){function a(){var t=w.pop();if(t){var e=w[w.length-1];e||0!=w.length||(e=v),e&&(e.kwArgs.back?e.kwArgs.back():e.kwArgs.backButton?e.kwArgs.backButton():e.kwArgs.handle&&e.kwArgs.handle("back")),C.push(t)}}function d(){var t=C.pop();t&&(t.kwArgs.forward?t.kwArgs.forward():t.kwArgs.forwardButton?t.kwArgs.forwardButton():t.kwArgs.handle&&t.kwArgs.handle("forward"),w.push(t))}function l(t,e,i){return{url:t,kwArgs:e,urlHash:i}}function h(t){var e=t.split("?");return e.length<2?null:e[1]}function c(){var e=(t.dojoIframeHistoryUrl||r.toUrl("./resources/iframe_history.html"))+"?"+(new Date).getTime();return N=!0,k&&(i("webkit")?k.location=e:window.frames[k.name].location=e),e}function u(){if(!x){var t=w.length,e=p();if((e===b||window.location.href==_)&&1==t)return void a();if(C.length>0&&C[C.length-1].urlHash===e)return void d();t>=2&&w[t-2]&&w[t-2].urlHash===e&&a()}}var f={};e.setObject("dojo.back",f);var m,p=f.getHash=function(){var t=window.location.hash;return"#"==t.charAt(0)&&(t=t.substring(1)),i("mozilla")?t:decodeURIComponent(t)},g=f.setHash=function(t){t||(t=""),window.location.hash=encodeURIComponent(t),m=history.length},_="undefined"!=typeof window?window.location.href:"",b="undefined"!=typeof window?p():"",v=null,y=null,j=null,k=null,C=[],w=[],N=!1,x=!1;return f.goBack=a,f.goForward=d,f.init=function(){if(!o.byId("dj_history")){var e=t.dojoIframeHistoryUrl||r.toUrl("./resources/iframe_history.html");t.afterOnLoad||document.write('<iframe style="border:0;width:1px;height:1px;position:absolute;visibility:hidden;bottom:0;right:0;" name="dj_history" id="dj_history" src="'+e+'"></iframe>')}},f.setInitialState=function(t){v=l(_,t,b)},f.addToHistory=function(e){C=[];var o=null,r=null;if(k||(t.useXDomain&&!t.dojoIframeHistoryUrl,k=window.frames.dj_history),j||(j=n.create("a",{style:{display:"none"}},s.body())),e.changeUrl){if(o=""+(e.changeUrl!==!0?e.changeUrl:(new Date).getTime()),0==w.length&&v.urlHash==o)return void(v=l(r,e,o));if(w.length>0&&w[w.length-1].urlHash==o)return void(w[w.length-1]=l(r,e,o));if(x=!0,setTimeout(function(){g(o),x=!1},1),j.href=o,i("ie")){r=c();var a=e.back||e.backButton||e.handle,d=function(t){""!=p()&&setTimeout(function(){g(o)},1),a.apply(this,[t])};e.back?e.back=d:e.backButton?e.backButton=d:e.handle&&(e.handle=d);var h=e.forward||e.forwardButton||e.handle,f=function(t){""!=p()&&g(o),h&&h.apply(this,[t])};e.forward?e.forward=f:e.forwardButton?e.forwardButton=f:e.handle&&(e.handle=f)}else i("ie")||y||(y=setInterval(u,200))}else r=c();w.push(l(r,e,o))},f._iframeLoaded=function(t,e){var i=h(e.href);return null==i?void(1==w.length&&a()):N?void(N=!1):void(w.length>=2&&i==h(w[w.length-2].url)?a():C.length>0&&i==h(C[C.length-1].url)&&d())},f});//# sourceMappingURL=back.js.map