//>>built
define("dojo/back",["./_base/config","./_base/lang","./sniff","./dom","./dom-construct","./_base/window","require"],function(e,t,i,n,o,a,r){function s(){var e=k.pop();if(e){var t=k[k.length-1];t||0!=k.length||(t=j),t&&(t.kwArgs.back?t.kwArgs.back():t.kwArgs.backButton?t.kwArgs.backButton():t.kwArgs.handle&&t.kwArgs.handle("back")),x.push(e)}}function d(){var e=x.pop();e&&(e.kwArgs.forward?e.kwArgs.forward():e.kwArgs.forwardButton?e.kwArgs.forwardButton():e.kwArgs.handle&&e.kwArgs.handle("forward"),k.push(e))}function l(e,t,i){return{url:e,kwArgs:t,urlHash:i}}function u(e){var t=e.split("?");return t.length<2?null:t[1]}function h(){var t=(e.dojoIframeHistoryUrl||r.toUrl("./resources/iframe_history.html"))+"?"+(new Date).getTime();return C=!0,w&&(i("webkit")?w.location=t:window.frames[w.name].location=t),t}function c(){if(!N){var e=k.length,t=g();if((t===v||window.location.href==b)&&1==e)return void s();if(x.length>0&&x[x.length-1].urlHash===t)return void d();e>=2&&k[e-2]&&k[e-2].urlHash===t&&s()}}var f={};t.setObject("dojo.back",f);var p,g=f.getHash=function(){var e=window.location.hash;return"#"==e.charAt(0)&&(e=e.substring(1)),i("mozilla")?e:decodeURIComponent(e)},m=f.setHash=function(e){e||(e=""),window.location.hash=encodeURIComponent(e),p=history.length},b="undefined"!=typeof window?window.location.href:"",v="undefined"!=typeof window?g():"",j=null,y=null,_=null,w=null,x=[],k=[],C=!1,N=!1;return f.goBack=s,f.goForward=d,f.init=function(){if(!n.byId("dj_history")){var t=e.dojoIframeHistoryUrl||r.toUrl("./resources/iframe_history.html");e.afterOnLoad||document.write('<iframe style="border:0;width:1px;height:1px;position:absolute;visibility:hidden;bottom:0;right:0;" name="dj_history" id="dj_history" src="'+t+'"></iframe>')}},f.setInitialState=function(e){j=l(b,e,v)},f.addToHistory=function(t){x=[];var n=null,r=null;if(w||(e.useXDomain&&!e.dojoIframeHistoryUrl,w=window.frames.dj_history),_||(_=o.create("a",{style:{display:"none"}},a.body())),t.changeUrl){if(n=""+(t.changeUrl!==!0?t.changeUrl:(new Date).getTime()),0==k.length&&j.urlHash==n)return void(j=l(r,t,n));if(k.length>0&&k[k.length-1].urlHash==n)return void(k[k.length-1]=l(r,t,n));if(N=!0,setTimeout(function(){m(n),N=!1},1),_.href=n,i("ie")){r=h();var s=t.back||t.backButton||t.handle,d=function(e){""!=g()&&setTimeout(function(){m(n)},1),s.apply(this,[e])};t.back?t.back=d:t.backButton?t.backButton=d:t.handle&&(t.handle=d);var u=t.forward||t.forwardButton||t.handle,f=function(e){""!=g()&&m(n),u&&u.apply(this,[e])};t.forward?t.forward=f:t.forwardButton?t.forwardButton=f:t.handle&&(t.handle=f)}else i("ie")||y||(y=setInterval(c,200))}else r=h();k.push(l(r,t,n))},f._iframeLoaded=function(e,t){var i=u(t.href);return null==i?void(1==k.length&&s()):C?void(C=!1):void(k.length>=2&&i==u(k[k.length-2].url)?s():x.length>0&&i==u(x[x.length-1].url)&&d())},f});//# sourceMappingURL=back.js.map