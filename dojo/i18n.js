//>>built
define("dojo/i18n",["./_base/kernel","require","./has","./_base/array","./_base/config","./_base/lang","./_base/xhr","./json","module"],function(t,e,i,o,n,r,s,a,d){i.add("dojo-preload-i18n-Api",1);var l=t.i18n={},h=/(^.*(^|\/)nls)(\/|$)([^\/]*)\/?([^\/]*)/,c=function(t,e,i,o){for(var n=[i+o],r=e.split("-"),s="",a=0;a<r.length;a++)s+=(s?"-":"")+r[a],t&&!t[s]||(n.push(i+s+"/"+o),n.specificity=s);return n},u={},f=function(e,i,o){return o=o?o.toLowerCase():t.locale,e=e.replace(/\./g,"/"),i=i.replace(/\./g,"/"),/root/i.test(o)?e+"/nls/"+i:e+"/nls/"+o+"/"+i},m=t.getL10nName=function(t,e,i){return t=d.id+"!"+f(t,e,i)},p=function(t,e,i,o,n,s){t([e],function(a){var d=r.clone(a.root||a.ROOT),l=c(!a._v1x&&a,n,i,o);t(l,function(){for(var t=1;t<l.length;t++)d=r.mixin(r.clone(d),arguments[t]);var i=e+"/"+n;u[i]=d,d.$locale=l.specificity,s()})})},g=function(t,e){return/^\./.test(t)?e(t):t},_=function(t){var e=n.extraLocale||[];return e=r.isArray(e)?e:[e],e.push(t),e},b=function(e,n,s){if(i("dojo-preload-i18n-Api")){var d=e.split("*"),l="preload"==d[1];if(l&&(u[e]||(u[e]=1,w(d[2],a.parse(d[3]),1,n)),s(1)),l||x(e,n,s))return}var c=h.exec(e),f=c[1]+"/",m=c[5]||c[4],g=f+m,b=c[5]&&c[4],v=b||t.locale||"",y=g+"/"+v,j=b?[v]:_(v),k=j.length,C=function(){--k||s(r.delegate(u[y]))};o.forEach(j,function(t){var e=g+"/"+t;i("dojo-preload-i18n-Api")&&N(e),u[e]?C():p(n,g,f,m,t,C)})};if(i("dojo-unit-tests"))var v=l.unitTests=[];if(i("dojo-preload-i18n-Api"),!0)var y=l.normalizeLocale=function(e){var i=e?e.toLowerCase():t.locale;return"root"==i?"ROOT":i},j=function(t,e){return!0},k=0,C=[],w=l._preloadLocalizations=function(i,n,s,a){function d(t,e){j(t,a)||s?a([t],e):A([t],e,a)}function l(t,e){for(var i=t.split("-");i.length;){if(e(i.join("-")))return;i.pop()}e("ROOT")}function h(){k++}function c(){for(--k;!k&&C.length;)b.apply(null,C.shift())}function f(t,e,i,o){return o.toAbsMid(t+e+"/"+i)}function m(t){t=y(t),l(t,function(s){if(o.indexOf(n,s)>=0){var m=i.replace(/\./g,"/")+"_"+s;return h(),d(m,function(i){function o(i,o,n,s){var d=[],m=[];l(t,function(t){s[t]&&(d.push(e.toAbsMid(i+t+"/"+o)),m.push(f(i,o,t,e)))}),d.length?(h(),a(d,function(){for(var s=d.length-1;s>=0;s--)n=r.mixin(r.clone(n),arguments[s]),u[m[s]]=n;u[f(i,o,t,e)]=r.clone(n),c()})):u[f(i,o,t,e)]=n}for(var n in i){var d,m,p=i[n],g=n.match(/(.+)\/([^\/]+)$/);if(g&&(d=g[2],m=g[1]+"/",p._localized)){var _;if("ROOT"===s){var b=_=p._localized;delete p._localized,b.root=p,u[e.toAbsMid(n)]=b}else _=p._localized,u[f(m,d,s,e)]=p;s!==t&&o(m,d,p,_)}}c()}),!0}return!1})}a=a||e,m(),o.forEach(t.config.extraLocale,m)},x=function(t,e,i){return k&&C.push([t,e,i]),k},N=function(){};var T={},S=new Function("__bundle","__checkForLegacyModules","__mid","__amdValue","var define = function(mid, factory){define.called = 1; __amdValue.result = factory || mid;},	   require = function(){define.called = 1;};try{define.called = 0;eval(__bundle);if(define.called==1)return __amdValue;if((__checkForLegacyModules = __checkForLegacyModules(__mid)))return __checkForLegacyModules;}catch(e){}try{return eval('('+__bundle+')');}catch(e){return e;}"),A=function(t,e,i){var n=[];o.forEach(t,function(t){function e(e){var i=S(e,N,t,T);i===T?n.push(u[o]=T.result):(i instanceof Error&&(i={}),n.push(u[o]=/nls\/[^\/]+\/[^\/]+$/.test(o)?i:{root:i,_v1x:1}))}var o=i.toUrl(t+".js");if(u[o])n.push(u[o]);else{var r=i.syncLoadNls(t);if(r||(r=N(t.replace(/nls\/([^\/]*)\/([^\/]*)$/,"nls/$2/$1"))),r)n.push(r);else if(s)s.get({url:o,sync:!0,load:e,error:function(){n.push(u[o]={})}});else try{i.getText(o,!0,e)}catch(a){n.push(u[o]={})}}}),e&&e.apply(null,n)};return N=function(e){for(var i,o=e.split("/"),n=t.global[o[0]],r=1;n&&r<o.length-1;n=n[o[r++]]);return n&&(i=n[o[r]],i||(i=n[o[r].replace(/-/g,"_")]),i&&(u[e]=i)),i},l.getLocalization=function(t,i,o){var n,r=f(t,i,o);return b(r,j(r,e)?e:function(t,i){A(t,i,e)},function(t){n=t}),n},i("dojo-unit-tests")&&v.push(function(t){t.register("tests.i18n.unit",function(t){var e;e=S("{prop:1}",N,"nonsense",T),t.is({prop:1},e),t.is(void 0,e[1]),e=S("({prop:1})",N,"nonsense",T),t.is({prop:1},e),t.is(void 0,e[1]),e=S("{'prop-x':1}",N,"nonsense",T),t.is({"prop-x":1},e),t.is(void 0,e[1]),e=S("({'prop-x':1})",N,"nonsense",T),t.is({"prop-x":1},e),t.is(void 0,e[1]),e=S("define({'prop-x':1})",N,"nonsense",T),t.is(T,e),t.is({"prop-x":1},T.result),e=S("define('some/module', {'prop-x':1})",N,"nonsense",T),t.is(T,e),t.is({"prop-x":1},T.result),e=S("this is total nonsense and should throw an error",N,"nonsense",T),t.is(e instanceof Error,!0)})}),r.mixin(l,{dynamic:!0,normalize:g,load:b,cache:u,getL10nName:m})});//# sourceMappingURL=i18n.js.map