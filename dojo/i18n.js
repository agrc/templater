//>>built
define("dojo/i18n",["./_base/kernel","require","./has","./_base/array","./_base/config","./_base/lang","./_base/xhr","./json","module"],function(t,e,n,i,r,o,a,s,c){n.add("dojo-preload-i18n-Api",1);var u=t.i18n={},l=/(^.*(^|\/)nls)(\/|$)([^\/]*)\/?([^\/]*)/,d=function(t,e,n,i){for(var r=[n+i],o=e.split("-"),a="",s=0;s<o.length;s++)a+=(a?"-":"")+o[s],t&&!t[a]||(r.push(n+a+"/"+i),r.specificity=a);return r},h={},f=function(e,n,i){return i=i?i.toLowerCase():t.locale,e=e.replace(/\./g,"/"),n=n.replace(/\./g,"/"),/root/i.test(i)?e+"/nls/"+n:e+"/nls/"+i+"/"+n},p=t.getL10nName=function(t,e,n){return t=c.id+"!"+f(t,e,n)},m=function(t,e,n,i,r,a){t([e],function(s){var c=o.clone(s.root||s.ROOT),u=d(!s._v1x&&s,r,n,i);t(u,function(){for(var t=1;t<u.length;t++)c=o.mixin(o.clone(c),arguments[t]);var n=e+"/"+r;h[n]=c,c.$locale=u.specificity,a()})})},g=function(t,e){return/^\./.test(t)?e(t):t},v=function(t){var e=r.extraLocale||[];return e=o.isArray(e)?e:[e],e.push(t),e},y=function(e,r,a){if(n("dojo-preload-i18n-Api")){var c=e.split("*"),u="preload"==c[1];if(u&&(h[e]||(h[e]=1,j(c[2],s.parse(c[3]),1,r)),a(1)),u||S(e,r,a))return}var d=l.exec(e),f=d[1]+"/",p=d[5]||d[4],g=f+p,y=d[5]&&d[4],b=y||t.locale||"",_=g+"/"+b,k=y?[b]:v(b),x=k.length,w=function(){--x||a(o.delegate(h[_]))};i.forEach(k,function(t){var e=g+"/"+t;n("dojo-preload-i18n-Api")&&C(e),h[e]?w():m(r,g,f,p,t,w)})};if(n("dojo-unit-tests"))var b=u.unitTests=[];if(n("dojo-preload-i18n-Api"),!0)var _=u.normalizeLocale=function(e){var n=e?e.toLowerCase():t.locale;return"root"==n?"ROOT":n},k=function(t,e){return!0},x=0,w=[],j=u._preloadLocalizations=function(n,r,a,s){function c(t,e){k(t,s)||a?s([t],e):T([t],e,s)}function u(t,e){for(var n=t.split("-");n.length;){if(e(n.join("-")))return;n.pop()}e("ROOT")}function l(){x++}function d(){for(--x;!x&&w.length;)y.apply(null,w.shift())}function f(t,e,n,i){return i.toAbsMid(t+e+"/"+n)}function p(t){t=_(t),u(t,function(a){if(i.indexOf(r,a)>=0){var p=n.replace(/\./g,"/")+"_"+a;return l(),c(p,function(n){function i(n,i,r,a){var c=[],p=[];u(t,function(t){a[t]&&(c.push(e.toAbsMid(n+t+"/"+i)),p.push(f(n,i,t,e)))}),c.length?(l(),s(c,function(){for(var a=c.length-1;a>=0;a--)r=o.mixin(o.clone(r),arguments[a]),h[p[a]]=r;h[f(n,i,t,e)]=o.clone(r),d()})):h[f(n,i,t,e)]=r}for(var r in n){var c,p,m=n[r],g=r.match(/(.+)\/([^\/]+)$/);if(g&&(c=g[2],p=g[1]+"/",m._localized)){var v;if("ROOT"===a){var y=v=m._localized;delete m._localized,y.root=m,h[e.toAbsMid(r)]=y}else v=m._localized,h[f(p,c,a,e)]=m;a!==t&&i(p,c,m,v)}}d()}),!0}return!1})}s=s||e,p(),i.forEach(t.config.extraLocale,p)},S=function(t,e,n){return x&&w.push([t,e,n]),x},C=function(){};var N={},E=new Function("__bundle","__checkForLegacyModules","__mid","__amdValue","var define = function(mid, factory){define.called = 1; __amdValue.result = factory || mid;},	   require = function(){define.called = 1;};try{define.called = 0;eval(__bundle);if(define.called==1)return __amdValue;if((__checkForLegacyModules = __checkForLegacyModules(__mid)))return __checkForLegacyModules;}catch(e){}try{return eval('('+__bundle+')');}catch(e){return e;}"),T=function(t,e,n){var r=[];i.forEach(t,function(t){function e(e){var n=E(e,C,t,N);n===N?r.push(h[i]=N.result):(n instanceof Error&&(n={}),r.push(h[i]=/nls\/[^\/]+\/[^\/]+$/.test(i)?n:{root:n,_v1x:1}))}var i=n.toUrl(t+".js");if(h[i])r.push(h[i]);else{var o=n.syncLoadNls(t);if(o||(o=C(t.replace(/nls\/([^\/]*)\/([^\/]*)$/,"nls/$2/$1"))),o)r.push(o);else if(a)a.get({url:i,sync:!0,load:e,error:function(){r.push(h[i]={})}});else try{n.getText(i,!0,e)}catch(s){r.push(h[i]={})}}}),e&&e.apply(null,r)};return C=function(e){for(var n,i=e.split("/"),r=t.global[i[0]],o=1;r&&o<i.length-1;r=r[i[o++]]);return r&&(n=r[i[o]],n||(n=r[i[o].replace(/-/g,"_")]),n&&(h[e]=n)),n},u.getLocalization=function(t,n,i){var r,o=f(t,n,i);return y(o,k(o,e)?e:function(t,n){T(t,n,e)},function(t){r=t}),r},n("dojo-unit-tests")&&b.push(function(t){t.register("tests.i18n.unit",function(t){var e;e=E("{prop:1}",C,"nonsense",N),t.is({prop:1},e),t.is(void 0,e[1]),e=E("({prop:1})",C,"nonsense",N),t.is({prop:1},e),t.is(void 0,e[1]),e=E("{'prop-x':1}",C,"nonsense",N),t.is({"prop-x":1},e),t.is(void 0,e[1]),e=E("({'prop-x':1})",C,"nonsense",N),t.is({"prop-x":1},e),t.is(void 0,e[1]),e=E("define({'prop-x':1})",C,"nonsense",N),t.is(N,e),t.is({"prop-x":1},N.result),e=E("define('some/module', {'prop-x':1})",C,"nonsense",N),t.is(N,e),t.is({"prop-x":1},N.result),e=E("this is total nonsense and should throw an error",C,"nonsense",N),t.is(e instanceof Error,!0)})}),o.mixin(u,{dynamic:!0,normalize:g,load:y,cache:h,getL10nName:p})});//# sourceMappingURL=i18n.js.map