//>>built
define("dojo/request/node",["require","./util","./handlers","../errors/RequestTimeoutError","../node!http","../node!https","../node!url","../node!stream"],function(e,t,a,i,r,d,o,n){function s(e,n){var s=t.parseArgs(e,t.deepCreate(f,n),n&&n.data instanceof m);e=s.url,n=s.options;var l=t.deferred(s,function(e,t){t.clientRequest.abort()});e=o.parse(e);var u=s.requestOptions={hostname:e.hostname,port:e.port,socketPath:n.socketPath,method:n.method,headers:n.headers,agent:n.agent,pfx:n.pfx,key:n.key,passphrase:n.passphrase,cert:n.cert,ca:n.ca,ciphers:n.ciphers,rejectUnauthorized:n.rejectUnauthorized!==!1};e.path&&(u.path=e.path),(n.user||n.password)&&(u.auth=(n.user||"")+":"+(n.password||""));var h=s.clientRequest=("https:"===e.protocol?d:r).request(u);if(n.socketOptions&&("timeout"in n.socketOptions&&h.setTimeout(n.socketOptions.timeout),"noDelay"in n.socketOptions&&h.setNoDelay(n.socketOptions.noDelay),"keepAlive"in n.socketOptions)){var c=n.socketOptions.keepAlive;h.setKeepAlive(c>=0,c||0)}if(h.on("socket",function(){s.hasSocket=!0,l.progress(s)}),h.on("response",function(e){s.clientResponse=e,s.status=e.statusCode,s.getHeader=function(t){return e.headers[t.toLowerCase()]||null};var t=[];e.on("data",function(e){t.push(e)}),e.on("end",function(){y&&clearTimeout(y),s.text=t.join("");try{a(s),l.resolve(s)}catch(e){l.reject(e)}})}),h.on("error",l.reject),n.data?"string"==typeof n.data?h.end(n.data):n.data.pipe(h):h.end(),n.timeout)var y=setTimeout(function(){l.cancel(new i(s))},n.timeout);return l.promise}var l,m=n.Stream,f={method:"GET",query:null,data:l,headers:{}};return t.addCommonMethods(s),s});//# sourceMappingURL=node.js.map