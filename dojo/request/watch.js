//>>built
define("dojo/request/watch",["./util","../errors/RequestTimeoutError","../errors/CancelError","../_base/array","../_base/window","../has!host-browser?dom-addeventlistener?:../on:"],function(e,t,a,i,r,d){function o(){for(var e,a=+new Date,i=0;i<s.length&&(e=s[i]);i++){var r=e.response,d=r.options;e.isCanceled&&e.isCanceled()||e.isValid&&!e.isValid(r)?(s.splice(i--,1),n._onAction&&n._onAction()):e.isReady&&e.isReady(r)?(s.splice(i--,1),e.handleResponse(r),n._onAction&&n._onAction()):e.startTime&&e.startTime+(d.timeout||0)<a&&(s.splice(i--,1),e.cancel(new t("Timeout exceeded",r)),n._onAction&&n._onAction())}n._onInFlight&&n._onInFlight(e),s.length||(clearInterval(l),l=null)}function n(e){e.response.options.timeout&&(e.startTime=+new Date),e.isFulfilled()||(s.push(e),l||(l=setInterval(o,50)),e.response.options.sync&&o())}var l=null,s=[];return n.cancelAll=function(){try{i.forEach(s,function(e){try{e.cancel(new a("All requests canceled."))}catch(e){}})}catch(e){}},r&&d&&r.doc.attachEvent&&d(r.global,"unload",function(){n.cancelAll()}),n});//# sourceMappingURL=watch.js.map