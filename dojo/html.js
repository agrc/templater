//>>built
define("dojo/html",["./_base/kernel","./_base/lang","./_base/array","./_base/declare","./dom","./dom-construct","./parser"],function(e,t,n,i,r,o,a){var s=0,c={_secureForInnerHtml:function(e){return e.replace(/(?:\s*<!DOCTYPE\s[^>]+>|<title[^>]*>[\s\S]*?<\/title>)/gi,"")},_emptyNode:o.empty,_setNodeContent:function(e,n){if(o.empty(e),n)if("number"==typeof n&&(n=n.toString()),"string"==typeof n&&(n=o.toDom(n,e.ownerDocument)),!n.nodeType&&t.isArrayLike(n))for(var i=n.length,r=0;r<n.length;r=i==n.length?r+1:0)o.place(n[r],e,"last");else o.place(n,e,"last");return e},_ContentSetter:i("dojo.html._ContentSetter",null,{node:"",content:"",id:"",cleanContent:!1,extractContent:!1,parseContent:!1,parserScope:e._scopeName,startup:!0,constructor:function(e,n){t.mixin(this,e||{}),n=this.node=r.byId(this.node||n),this.id||(this.id=["Setter",n?n.id||n.tagName:"",s++].join("_"))},set:function(e,t){void 0!==e&&(this.content=e),"number"==typeof e&&(e=e.toString()),t&&this._mixin(t),this.onBegin(),this.setContent();var n=this.onEnd();return n&&n.then?n:this.node},setContent:function(){var e=this.node;if(!e)throw new Error(this.declaredClass+": setContent given no node");try{e=c._setNodeContent(e,this.content)}catch(n){var t=this.onContentError(n);try{e.innerHTML=t}catch(e){}}this.node=e},empty:function(){this.parseDeferred&&(this.parseDeferred.isResolved()||this.parseDeferred.cancel(),delete this.parseDeferred),this.parseResults&&this.parseResults.length&&(n.forEach(this.parseResults,function(e){e.destroy&&e.destroy()}),delete this.parseResults),o.empty(this.node)},onBegin:function(){var e=this.content;if(t.isString(e)&&(this.cleanContent&&(e=c._secureForInnerHtml(e)),this.extractContent)){var n=e.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);n&&(e=n[1])}return this.empty(),this.content=e,this.node},onEnd:function(){return this.parseContent&&this._parse(),this.node},tearDown:function(){delete this.parseResults,delete this.parseDeferred,delete this.node,delete this.content},onContentError:function(e){return"Error occurred setting content: "+e},onExecError:function(e){return"Error occurred executing scripts: "+e},_mixin:function(e){var t,n={};for(t in e)t in n||(this[t]=e[t])},_parse:function(){var e=this.node;try{var t={};n.forEach(["dir","lang","textDir"],function(e){this[e]&&(t[e]=this[e])},this);var i=this;this.parseDeferred=a.parse({rootNode:e,noStart:!this.startup,inherited:t,scope:this.parserScope}).then(function(e){return i.parseResults=e},function(e){i._onError("Content",e,"Error parsing in _ContentSetter#"+this.id)})}catch(e){this._onError("Content",e,"Error parsing in _ContentSetter#"+this.id)}},_onError:function(e,t,n){var i=this["on"+e+"Error"].call(this,t);n||i&&c._setNodeContent(this.node,i,!0)}}),set:function(e,n,i){if(void 0==n&&(n=""),"number"==typeof n&&(n=n.toString()),i){return new c._ContentSetter(t.mixin(i,{content:n,node:e})).set()}return c._setNodeContent(e,n,!0)}};return t.setObject("dojo.html",c),c});//# sourceMappingURL=html.js.map