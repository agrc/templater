//>>built
define("dojo/on",["./has!dom-addeventlistener?:./aspect","./_base/kernel","./sniff"],function(t,e,i){"use strict";function n(t,e,n,o,r){var s=e.match(/(.*):(.*)/);if(s)return e=s[2],s=s[1],a.selector(s,e).call(r,t,n);if(i("touch")&&(d.test(e)&&(n=C(n)),i("event-orientationchange")||"orientationchange"!=e||(e="resize",t=window,n=C(n))),p&&(n=p(n)),t.addEventListener){var l=e in h,u=l?h[e]:e;return t.addEventListener(u,n,l),{remove:function(){t.removeEventListener(u,n,l)}}}if(e="on"+e,v&&t.attachEvent)return v(t,e,n);throw new Error("Target must be an event emitter")}function o(){this.cancelable=!1,this.defaultPrevented=!0}function r(){this.bubbles=!1}var s=window.ScriptEngineMajorVersion;i.add("jscript",s&&s()+ScriptEngineMinorVersion()/10),i.add("event-orientationchange",i("touch")&&!i("android")),i.add("event-stopimmediatepropagation",window.Event&&!!window.Event.prototype&&!!window.Event.prototype.stopImmediatePropagation),i.add("event-focusin",function(t,e,i){return"onfocusin"in i}),i("touch")&&i.add("touch-can-modify-event-delegate",function(){var t=function(){};t.prototype=document.createEvent("MouseEvents");try{var e=new t;return e.target=null,null===e.target}catch(t){return!1}});var a=function(t,e,i,o){return"function"!=typeof t.on||"function"==typeof e||t.nodeType?a.parse(t,e,i,n,o,this):t.on(e,i)};a.pausable=function(t,e,i,n){var o,r=a(t,e,function(){if(!o)return i.apply(this,arguments)},n);return r.pause=function(){o=!0},r.resume=function(){o=!1},r},a.once=function(t,e,i,n){var o=a(t,e,function(){return o.remove(),i.apply(this,arguments)});return o},a.parse=function(t,e,i,n,o,r){var s;if(e.call)return e.call(r,t,i);if(e instanceof Array?s=e:e.indexOf(",")>-1&&(s=e.split(/\s*,\s*/)),s){for(var d,l=[],u=0;d=s[u++];)l.push(a.parse(t,d,i,n,o,r));return l.remove=function(){for(var t=0;t<l.length;t++)l[t].remove()},l}return n(t,e,i,o,r)};var d=/^touch/;a.matches=function(t,i,n,o,r){for(r=r&&"function"==typeof r.matches?r:e.query,o=!1!==o,1!=t.nodeType&&(t=t.parentNode);!r.matches(t,i,n);)if(t==n||!1===o||!(t=t.parentNode)||1!=t.nodeType)return!1;return t},a.selector=function(t,e,i){return function(n,o){function r(e){return a.matches(e,t,n,i,s)}var s="function"==typeof t?{matches:t}:this,d=e.bubble;return d?a(n,d(r),o):a(n,e,function(t){var e=r(t.target);if(e)return t.selectorTarget=e,o.call(e,t)})}};var l=[].slice,u=a.emit=function(t,e,i){var n=l.call(arguments,2),s="on"+e;if("parentNode"in t){var a=n[0]={};for(var d in i)a[d]=i[d];a.preventDefault=o,a.stopPropagation=r,a.target=t,a.type=e,i=a}do{t[s]&&t[s].apply(t,n)}while(i&&i.bubbles&&(t=t.parentNode));return i&&i.cancelable&&i},h=i("event-focusin")?{}:{focusin:"focus",focusout:"blur"};if(!i("event-stopimmediatepropagation"))var c=function(){this.immediatelyStopped=!0,this.modified=!0},p=function(t){return function(e){if(!e.immediatelyStopped)return e.stopImmediatePropagation=c,t.apply(this,arguments)}};if(i("dom-addeventlistener"))a.emit=function(t,e,i){if(t.dispatchEvent&&document.createEvent){var n=t.ownerDocument||document,o=n.createEvent("HTMLEvents");o.initEvent(e,!!i.bubbles,!!i.cancelable);for(var r in i)r in o||(o[r]=i[r]);return t.dispatchEvent(o)&&o}return u.apply(a,arguments)};else{a._fixEvent=function(t,e){if(!t){t=(e&&(e.ownerDocument||e.document||e).parentWindow||window).event}if(!t)return t;try{f&&t.type==f.type&&t.srcElement==f.target&&(t=f)}catch(t){}if(!t.target)switch(t.target=t.srcElement,t.currentTarget=e||t.srcElement,"mouseover"==t.type&&(t.relatedTarget=t.fromElement),"mouseout"==t.type&&(t.relatedTarget=t.toElement),t.stopPropagation||(t.stopPropagation=_,t.preventDefault=y),t.type){case"keypress":var i="charCode"in t?t.charCode:t.keyCode;10==i?(i=0,t.keyCode=13):13==i||27==i?i=0:3==i&&(i=99),t.charCode=i,b(t)}return t};var f,m=function(t){this.handle=t};m.prototype.remove=function(){delete _dojoIEListeners_[this.handle]};var g=function(t){return function(e){e=a._fixEvent(e,this);var i=t.call(this,e);return e.modified&&(f||setTimeout(function(){f=null}),f=e),i}},v=function(e,n,o){if(o=g(o),((e.ownerDocument?e.ownerDocument.parentWindow:e.parentWindow||e.window||window)!=top||i("jscript")<5.8)&&!i("config-_allow_leaks")){"undefined"==typeof _dojoIEListeners_&&(_dojoIEListeners_=[]);var r=e[n];if(!r||!r.listeners){var s=r;r=Function("event","var callee = arguments.callee; for(var i = 0; i<callee.listeners.length; i++){var listener = _dojoIEListeners_[callee.listeners[i]]; if(listener){listener.call(this,event);}}"),r.listeners=[],e[n]=r,r.global=this,s&&r.listeners.push(_dojoIEListeners_.push(s)-1)}var a;return r.listeners.push(a=r.global._dojoIEListeners_.push(o)-1),new m(a)}return t.after(e,n,o,!0)},b=function(t){t.keyChar=t.charCode?String.fromCharCode(t.charCode):"",t.charOrCode=t.keyChar||t.keyCode},_=function(){this.cancelBubble=!0},y=a._preventDefault=function(){if(this.bubbledKeyCode=this.keyCode,this.ctrlKey)try{this.keyCode=0}catch(t){}this.defaultPrevented=!0,this.returnValue=!1,this.modified=!0}}if(i("touch"))var j=function(){},x=window.orientation,C=function(t){return function(e){var n=e.corrected;if(!n){var o=e.type;try{delete e.type}catch(t){}if(e.type){if(i("touch-can-modify-event-delegate"))j.prototype=e,n=new j;else{n={};for(var r in e)n[r]=e[r]}n.preventDefault=function(){e.preventDefault()},n.stopPropagation=function(){e.stopPropagation()}}else n=e,n.type=o;if(e.corrected=n,"resize"==o)return x==window.orientation?null:(x=window.orientation,n.type="orientationchange",t.call(this,n));if("rotation"in n||(n.rotation=0,n.scale=1),window.TouchEvent&&e instanceof TouchEvent){var s=n.changedTouches[0];for(var a in s)delete n[a],n[a]=s[a]}}return t.call(this,n)}};return a});//# sourceMappingURL=on.js.map