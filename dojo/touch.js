//>>built
define("dojo/touch",["./_base/kernel","./aspect","./dom","./dom-class","./_base/lang","./on","./has","./mouse","./domReady","./_base/window"],function(e,t,i,n,o,s,a,r,d,l){function c(e,t,i){return x&&i?function(e,t){return s(e,i,t)}:N?function(i,n){var o=s(i,t,function(e){n.call(this,e),y=(new Date).getTime()}),a=s(i,e,function(e){(!y||(new Date).getTime()>y+1e3)&&n.call(this,e)});return{remove:function(){o.remove(),a.remove()}}}:function(t,i){return s(t,e,i)}}function u(e){do{if(void 0!==e.dojoClick)return e}while(e=e.parentNode)}function h(e,t,o){function a(e){p=w?i.isDescendant(l.doc.elementFromPoint(e.changedTouches?e.changedTouches[0].pageX-l.global.pageXOffset:e.clientX,e.changedTouches?e.changedTouches[0].pageY-l.global.pageYOffset:e.clientY),g):p&&(e.changedTouches?e.changedTouches[0].target:e.target)==g&&Math.abs((e.changedTouches?e.changedTouches[0].pageX-l.global.pageXOffset:e.clientX)-m)<=b&&Math.abs((e.changedTouches?e.changedTouches[0].pageY-l.global.pageYOffset:e.clientY)-v)<=_}function d(e){l.doc.addEventListener(e,function(t){var i=t.target;p&&!t._dojo_click&&(new Date).getTime()<=j+1e3&&("INPUT"!=i.tagName||!n.contains(i,"dijitOffScreen"))&&(t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),"click"==e&&("INPUT"!=i.tagName||"radio"==i.type&&(n.contains(i,"dijitCheckBoxInput")||n.contains(i,"mblRadioButton"))||"checkbox"==i.type&&(n.contains(i,"dijitCheckBoxInput")||n.contains(i,"mblCheckBox")))&&"TEXTAREA"!=i.tagName&&"AUDIO"!=i.tagName&&"VIDEO"!=i.tagName&&t.preventDefault())},!0)}if(!r.isRight(e)){var c=u(e.target);p=!e.target.disabled&&c&&c.dojoClick,p&&(w="useTarget"==p,g=w?c:e.target,w&&e.preventDefault(),m=e.changedTouches?e.changedTouches[0].pageX-l.global.pageXOffset:e.clientX,v=e.changedTouches?e.changedTouches[0].pageY-l.global.pageYOffset:e.clientY,b=("object"==typeof p?p.x:"number"==typeof p?p:0)||4,_=("object"==typeof p?p.y:"number"==typeof p?p:0)||4,f||(f=!0,l.doc.addEventListener(t,function(e){r.isRight(e)||(a(e),w&&e.preventDefault())},!0),l.doc.addEventListener(o,function(e){function t(t){var i=document.createEvent("MouseEvents");return i._dojo_click=!0,i.initMouseEvent(t,!0,!0,e.view,e.detail,o.screenX,o.screenY,o.clientX,o.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null),i}if(!r.isRight(e)&&(a(e),p)){j=(new Date).getTime();var n=w?g:e.target;"LABEL"===n.tagName&&(n=i.byId(n.getAttribute("for"))||n);var o=e.changedTouches?e.changedTouches[0]:e,d=t("mousedown"),l=t("mouseup"),c=t("click");setTimeout(function(){s.emit(n,"mousedown",d),s.emit(n,"mouseup",l),s.emit(n,"click",c),j=(new Date).getTime()},0)}},!0),d("click"),d("mousedown"),d("mouseup")))}}var f,p,g,m,v,b,_,j,y,k,C=a("ios")<5,x=a("pointer-events")||a("MSPointer"),T=function(){var e={};for(var t in{down:1,move:1,up:1,cancel:1,over:1,out:1})e[t]=a("MSPointer")?"MSPointer"+t.charAt(0).toUpperCase()+t.slice(1):"pointer"+t;return e}(),N=a("touch-events"),w=!1;a("touch")&&d(x?function(){l.doc.addEventListener(T.down,function(e){h(e,T.move,T.up)},!0)}:function(){function e(e){var t=o.delegate(e,{bubbles:!0});return a("ios")>=6&&(t.touches=e.touches,t.altKey=e.altKey,t.changedTouches=e.changedTouches,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.targetTouches=e.targetTouches),t}k=l.body(),l.doc.addEventListener("touchstart",function(e){y=(new Date).getTime();var t=k;k=e.target,s.emit(t,"dojotouchout",{relatedTarget:k,bubbles:!0}),s.emit(k,"dojotouchover",{relatedTarget:t,bubbles:!0}),h(e,"touchmove","touchend")},!0),s(l.doc,"touchmove",function(t){y=(new Date).getTime();var i=l.doc.elementFromPoint(t.pageX-(C?0:l.global.pageXOffset),t.pageY-(C?0:l.global.pageYOffset));i&&(k!==i&&(s.emit(k,"dojotouchout",{relatedTarget:i,bubbles:!0}),s.emit(i,"dojotouchover",{relatedTarget:k,bubbles:!0}),k=i),s.emit(i,"dojotouchmove",e(t))||t.preventDefault())}),s(l.doc,"touchend",function(t){y=(new Date).getTime();var i=l.doc.elementFromPoint(t.pageX-(C?0:l.global.pageXOffset),t.pageY-(C?0:l.global.pageYOffset))||l.body();s.emit(i,"dojotouchend",e(t))})});var S={press:c("mousedown","touchstart",T.down),move:c("mousemove","dojotouchmove",T.move),release:c("mouseup","dojotouchend",T.up),cancel:c(r.leave,"touchcancel",x?T.cancel:null),over:c("mouseover","dojotouchover",T.over),out:c("mouseout","dojotouchout",T.out),enter:r._eventHandler(c("mouseover","dojotouchover",T.over)),leave:r._eventHandler(c("mouseout","dojotouchout",T.out))};return e.touch=S,S});//# sourceMappingURL=touch.js.map