//>>built
define("dojo/touch",["./_base/kernel","./aspect","./dom","./dom-class","./_base/lang","./on","./has","./mouse","./domReady","./_base/window"],function(e,t,i,n,o,r,a,s,d,l){function c(e,t,i){return C&&i?function(e,t){return r(e,i,t)}:N?function(i,n){var o=r(i,t,function(e){n.call(this,e),y=(new Date).getTime()}),a=r(i,e,function(e){(!y||(new Date).getTime()>y+1e3)&&n.call(this,e)});return{remove:function(){o.remove(),a.remove()}}}:function(t,i){return r(t,e,i)}}function u(e){do if(void 0!==e.dojoClick)return e;while(e=e.parentNode)}function h(e,t,o){function a(e){p=x?i.isDescendant(l.doc.elementFromPoint(e.changedTouches?e.changedTouches[0].pageX-l.global.pageXOffset:e.clientX,e.changedTouches?e.changedTouches[0].pageY-l.global.pageYOffset:e.clientY),g):p&&(e.changedTouches?e.changedTouches[0].target:e.target)==g&&Math.abs((e.changedTouches?e.changedTouches[0].pageX-l.global.pageXOffset:e.clientX)-m)<=b&&Math.abs((e.changedTouches?e.changedTouches[0].pageY-l.global.pageYOffset:e.clientY)-v)<=_}function d(e){l.doc.addEventListener(e,function(t){p&&!t._dojo_click&&(new Date).getTime()<=j+1e3&&("INPUT"!=t.target.tagName||!n.contains(t.target,"dijitOffScreen"))&&(t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),"click"!=e||"INPUT"==t.target.tagName&&"radio"!=t.target.type&&"checkbox"!=t.target.type||"TEXTAREA"==t.target.tagName||"AUDIO"==t.target.tagName||"VIDEO"==t.target.tagName||t.preventDefault())},!0)}if(!s.isRight(e)){var c=u(e.target);p=!e.target.disabled&&c&&c.dojoClick,p&&(x="useTarget"==p,g=x?c:e.target,x&&e.preventDefault(),m=e.changedTouches?e.changedTouches[0].pageX-l.global.pageXOffset:e.clientX,v=e.changedTouches?e.changedTouches[0].pageY-l.global.pageYOffset:e.clientY,b=("object"==typeof p?p.x:"number"==typeof p?p:0)||4,_=("object"==typeof p?p.y:"number"==typeof p?p:0)||4,f||(f=!0,l.doc.addEventListener(t,function(e){s.isRight(e)||(a(e),x&&e.preventDefault())},!0),l.doc.addEventListener(o,function(e){function t(t){var i=document.createEvent("MouseEvents");return i._dojo_click=!0,i.initMouseEvent(t,!0,!0,e.view,e.detail,o.screenX,o.screenY,o.clientX,o.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null),i}if(!s.isRight(e)&&(a(e),p)){j=(new Date).getTime();var n=x?g:e.target;"LABEL"===n.tagName&&(n=i.byId(n.getAttribute("for"))||n);var o=e.changedTouches?e.changedTouches[0]:e,d=t("mousedown"),l=t("mouseup"),c=t("click");setTimeout(function(){r.emit(n,"mousedown",d),r.emit(n,"mouseup",l),r.emit(n,"click",c),j=(new Date).getTime()},0)}},!0),d("click"),d("mousedown"),d("mouseup")))}}var f,p,g,m,v,b,_,j,y,S,w=a("ios")<5,C=a("pointer-events")||a("MSPointer"),T=function(){var e={};for(var t in{down:1,move:1,up:1,cancel:1,over:1,out:1})e[t]=a("MSPointer")?"MSPointer"+t.charAt(0).toUpperCase()+t.slice(1):"pointer"+t;return e}(),N=a("touch-events"),x=!1;a("touch")&&d(C?function(){l.doc.addEventListener(T.down,function(e){h(e,T.move,T.up)},!0)}:function(){function e(e){var t=o.delegate(e,{bubbles:!0});return a("ios")>=6&&(t.touches=e.touches,t.altKey=e.altKey,t.changedTouches=e.changedTouches,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.targetTouches=e.targetTouches),t}S=l.body(),l.doc.addEventListener("touchstart",function(e){y=(new Date).getTime();var t=S;S=e.target,r.emit(t,"dojotouchout",{relatedTarget:S,bubbles:!0}),r.emit(S,"dojotouchover",{relatedTarget:t,bubbles:!0}),h(e,"touchmove","touchend")},!0),r(l.doc,"touchmove",function(t){y=(new Date).getTime();var i=l.doc.elementFromPoint(t.pageX-(w?0:l.global.pageXOffset),t.pageY-(w?0:l.global.pageYOffset));i&&(S!==i&&(r.emit(S,"dojotouchout",{relatedTarget:i,bubbles:!0}),r.emit(i,"dojotouchover",{relatedTarget:S,bubbles:!0}),S=i),r.emit(i,"dojotouchmove",e(t))||t.preventDefault())}),r(l.doc,"touchend",function(t){y=(new Date).getTime();var i=l.doc.elementFromPoint(t.pageX-(w?0:l.global.pageXOffset),t.pageY-(w?0:l.global.pageYOffset))||l.body();r.emit(i,"dojotouchend",e(t))})});var k={press:c("mousedown","touchstart",T.down),move:c("mousemove","dojotouchmove",T.move),release:c("mouseup","dojotouchend",T.up),cancel:c(s.leave,"touchcancel",C?T.cancel:null),over:c("mouseover","dojotouchover",T.over),out:c("mouseout","dojotouchout",T.out),enter:s._eventHandler(c("mouseover","dojotouchover",T.over)),leave:s._eventHandler(c("mouseout","dojotouchout",T.out))};return e.touch=k,k});//# sourceMappingURL=touch.js.map