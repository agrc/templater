//>>built
define("dojo/touch",["./_base/kernel","./aspect","./dom","./dom-class","./_base/lang","./on","./has","./mouse","./domReady","./_base/window"],function(e,t,i,o,n,r,s,a,d,c){function l(e,t,i){return x&&i?function(e,t){return r(e,i,t)}:w?function(i,o){var n=r(i,t,function(e){o.call(this,e),y=(new Date).getTime()}),s=r(i,e,function(e){(!y||(new Date).getTime()>y+1e3)&&o.call(this,e)});return{remove:function(){n.remove(),s.remove()}}}:function(t,i){return r(t,e,i)}}function u(e){do{if(void 0!==e.dojoClick)return e}while(e=e.parentNode)}function h(e,t,n){function s(e){m=N?i.isDescendant(c.doc.elementFromPoint(e.changedTouches?e.changedTouches[0].pageX-c.global.pageXOffset:e.clientX,e.changedTouches?e.changedTouches[0].pageY-c.global.pageYOffset:e.clientY),p):m&&(e.changedTouches?e.changedTouches[0].target:e.target)==p&&Math.abs((e.changedTouches?e.changedTouches[0].pageX-c.global.pageXOffset:e.clientX)-g)<=b&&Math.abs((e.changedTouches?e.changedTouches[0].pageY-c.global.pageYOffset:e.clientY)-v)<=j}function d(e){c.doc.addEventListener(e,function(t){var i=t.target;m&&!t._dojo_click&&(new Date).getTime()<=_+1e3&&("INPUT"!=i.tagName||!o.contains(i,"dijitOffScreen"))&&(t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),"click"==e&&("INPUT"!=i.tagName||"radio"==i.type&&(o.contains(i,"dijitCheckBoxInput")||o.contains(i,"mblRadioButton"))||"checkbox"==i.type&&(o.contains(i,"dijitCheckBoxInput")||o.contains(i,"mblCheckBox")))&&"TEXTAREA"!=i.tagName&&"AUDIO"!=i.tagName&&"VIDEO"!=i.tagName&&t.preventDefault())},!0)}if(!a.isRight(e)){var l=u(e.target);m=!e.target.disabled&&l&&l.dojoClick,m&&(N="useTarget"==m,p=N?l:e.target,N&&e.preventDefault(),g=e.changedTouches?e.changedTouches[0].pageX-c.global.pageXOffset:e.clientX,v=e.changedTouches?e.changedTouches[0].pageY-c.global.pageYOffset:e.clientY,b=("object"==typeof m?m.x:"number"==typeof m?m:0)||4,j=("object"==typeof m?m.y:"number"==typeof m?m:0)||4,f||(f=!0,c.doc.addEventListener(t,function(e){a.isRight(e)||(s(e),N&&e.preventDefault())},!0),c.doc.addEventListener(n,function(e){function t(t){var i=document.createEvent("MouseEvents");return i._dojo_click=!0,i.initMouseEvent(t,!0,!0,e.view,e.detail,n.screenX,n.screenY,n.clientX,n.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null),i}if(!a.isRight(e)&&(s(e),m)){_=(new Date).getTime();var o=N?p:e.target;"LABEL"===o.tagName&&(o=i.byId(o.getAttribute("for"))||o);var n=e.changedTouches?e.changedTouches[0]:e,d=t("mousedown"),c=t("mouseup"),l=t("click");setTimeout(function(){r.emit(o,"mousedown",d),r.emit(o,"mouseup",c),r.emit(o,"click",l),_=(new Date).getTime()},0)}},!0),d("click"),d("mousedown"),d("mouseup")))}}var f,m,p,g,v,b,j,_,y,k,C=s("ios")<5,x=s("pointer-events")||s("MSPointer"),T=function(){var e={};for(var t in{down:1,move:1,up:1,cancel:1,over:1,out:1})e[t]=s("MSPointer")?"MSPointer"+t.charAt(0).toUpperCase()+t.slice(1):"pointer"+t;return e}(),w=s("touch-events"),N=!1;s("touch")&&d(x?function(){c.doc.addEventListener(T.down,function(e){h(e,T.move,T.up)},!0)}:function(){function e(e){var t=n.delegate(e,{bubbles:!0});return s("ios")>=6&&(t.touches=e.touches,t.altKey=e.altKey,t.changedTouches=e.changedTouches,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.targetTouches=e.targetTouches),t}k=c.body(),c.doc.addEventListener("touchstart",function(e){y=(new Date).getTime();var t=k;k=e.target,r.emit(t,"dojotouchout",{relatedTarget:k,bubbles:!0}),r.emit(k,"dojotouchover",{relatedTarget:t,bubbles:!0}),h(e,"touchmove","touchend")},!0),r(c.doc,"touchmove",function(t){y=(new Date).getTime();var i=c.doc.elementFromPoint(t.pageX-(C?0:c.global.pageXOffset),t.pageY-(C?0:c.global.pageYOffset));i&&(k!==i&&(r.emit(k,"dojotouchout",{relatedTarget:i,bubbles:!0}),r.emit(i,"dojotouchover",{relatedTarget:k,bubbles:!0}),k=i),r.emit(i,"dojotouchmove",e(t))||t.preventDefault())}),r(c.doc,"touchend",function(t){y=(new Date).getTime();var i=c.doc.elementFromPoint(t.pageX-(C?0:c.global.pageXOffset),t.pageY-(C?0:c.global.pageYOffset))||c.body();r.emit(i,"dojotouchend",e(t))})});var S={press:l("mousedown","touchstart",T.down),move:l("mousemove","dojotouchmove",T.move),release:l("mouseup","dojotouchend",T.up),cancel:l(a.leave,"touchcancel",x?T.cancel:null),over:l("mouseover","dojotouchover",T.over),out:l("mouseout","dojotouchout",T.out),enter:a._eventHandler(l("mouseover","dojotouchover",T.over)),leave:a._eventHandler(l("mouseout","dojotouchout",T.out))};return e.touch=S,S});//# sourceMappingURL=touch.js.map