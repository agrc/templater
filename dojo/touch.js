//>>built
define("dojo/touch",["./_base/kernel","./aspect","./dom","./dom-class","./_base/lang","./on","./has","./mouse","./domReady","./_base/window"],function(t,e,i,o,n,a,s,r,d,l){function h(t,e,i){return D&&i?function(t,e){return a(t,i,e)}:x?function(i,o){var n=a(i,e,function(t){o.call(this,t),y=(new Date).getTime()}),s=a(i,t,function(t){(!y||(new Date).getTime()>y+1e3)&&o.call(this,t)});return{remove:function(){n.remove(),s.remove()}}}:function(e,i){return a(e,t,i)}}function u(t){do if(void 0!==t.dojoClick)return t;while(t=t.parentNode)}function c(t,e,n){function s(t){f=N?i.isDescendant(l.doc.elementFromPoint(t.changedTouches?t.changedTouches[0].pageX-l.global.pageXOffset:t.clientX,t.changedTouches?t.changedTouches[0].pageY-l.global.pageYOffset:t.clientY),m):f&&(t.changedTouches?t.changedTouches[0].target:t.target)==m&&Math.abs((t.changedTouches?t.changedTouches[0].pageX-l.global.pageXOffset:t.clientX)-g)<=b&&Math.abs((t.changedTouches?t.changedTouches[0].pageY-l.global.pageYOffset:t.clientY)-_)<=j}function d(t){l.doc.addEventListener(t,function(e){f&&!e._dojo_click&&(new Date).getTime()<=v+1e3&&("INPUT"!=e.target.tagName||!o.contains(e.target,"dijitOffScreen"))&&(e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),"click"!=t||"INPUT"==e.target.tagName&&"radio"!=e.target.type&&"checkbox"!=e.target.type||"TEXTAREA"==e.target.tagName||"AUDIO"==e.target.tagName||"VIDEO"==e.target.tagName||e.preventDefault())},!0)}if(!r.isRight(t)){var h=u(t.target);f=!t.target.disabled&&h&&h.dojoClick,f&&(N="useTarget"==f,m=N?h:t.target,N&&t.preventDefault(),g=t.changedTouches?t.changedTouches[0].pageX-l.global.pageXOffset:t.clientX,_=t.changedTouches?t.changedTouches[0].pageY-l.global.pageYOffset:t.clientY,b=("object"==typeof f?f.x:"number"==typeof f?f:0)||4,j=("object"==typeof f?f.y:"number"==typeof f?f:0)||4,p||(p=!0,l.doc.addEventListener(e,function(t){r.isRight(t)||(s(t),N&&t.preventDefault())},!0),l.doc.addEventListener(n,function(t){function e(e){var i=document.createEvent("MouseEvents");return i._dojo_click=!0,i.initMouseEvent(e,!0,!0,t.view,t.detail,n.screenX,n.screenY,n.clientX,n.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,0,null),i}if(!r.isRight(t)&&(s(t),f)){v=(new Date).getTime();var o=N?m:t.target;"LABEL"===o.tagName&&(o=i.byId(o.getAttribute("for"))||o);var n=t.changedTouches?t.changedTouches[0]:t,d=e("mousedown"),l=e("mouseup"),h=e("click");setTimeout(function(){a.emit(o,"mousedown",d),a.emit(o,"mouseup",l),a.emit(o,"click",h),v=(new Date).getTime()},0)}},!0),d("click"),d("mousedown"),d("mouseup")))}}var p,f,m,g,_,b,j,v,y,C,w=s("ios")<5,D=s("pointer-events")||s("MSPointer"),k=function(){var t={};for(var e in{down:1,move:1,up:1,cancel:1,over:1,out:1})t[e]=s("MSPointer")?"MSPointer"+e.charAt(0).toUpperCase()+e.slice(1):"pointer"+e;return t}(),x=s("touch-events"),N=!1;s("touch")&&d(D?function(){l.doc.addEventListener(k.down,function(t){c(t,k.move,k.up)},!0)}:function(){function t(t){var e=n.delegate(t,{bubbles:!0});return s("ios")>=6&&(e.touches=t.touches,e.altKey=t.altKey,e.changedTouches=t.changedTouches,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.targetTouches=t.targetTouches),e}C=l.body(),l.doc.addEventListener("touchstart",function(t){y=(new Date).getTime();var e=C;C=t.target,a.emit(e,"dojotouchout",{relatedTarget:C,bubbles:!0}),a.emit(C,"dojotouchover",{relatedTarget:e,bubbles:!0}),c(t,"touchmove","touchend")},!0),a(l.doc,"touchmove",function(e){y=(new Date).getTime();var i=l.doc.elementFromPoint(e.pageX-(w?0:l.global.pageXOffset),e.pageY-(w?0:l.global.pageYOffset));i&&(C!==i&&(a.emit(C,"dojotouchout",{relatedTarget:i,bubbles:!0}),a.emit(i,"dojotouchover",{relatedTarget:C,bubbles:!0}),C=i),a.emit(i,"dojotouchmove",t(e))||e.preventDefault())}),a(l.doc,"touchend",function(e){y=(new Date).getTime();var i=l.doc.elementFromPoint(e.pageX-(w?0:l.global.pageXOffset),e.pageY-(w?0:l.global.pageYOffset))||l.body();a.emit(i,"dojotouchend",t(e))})});var T={press:h("mousedown","touchstart",k.down),move:h("mousemove","dojotouchmove",k.move),release:h("mouseup","dojotouchend",k.up),cancel:h(r.leave,"touchcancel",D?k.cancel:null),over:h("mouseover","dojotouchover",k.over),out:h("mouseout","dojotouchout",k.out),enter:r._eventHandler(h("mouseover","dojotouchover",k.over)),leave:r._eventHandler(h("mouseout","dojotouchout",k.out))};return t.touch=T,T});//# sourceMappingURL=touch.js.map