//>>built
define("dojo/touch",["./_base/kernel","./aspect","./dom","./dom-class","./_base/lang","./on","./has","./mouse","./domReady","./_base/window"],function(e,t,i,n,o,a,s,r,d,l){function u(e,t,i){return k&&i?function(e,t){return a(e,i,t)}:D?function(i,n){var o=a(i,t,function(e){n.call(this,e),y=(new Date).getTime()}),s=a(i,e,function(e){(!y||(new Date).getTime()>y+1e3)&&n.call(this,e)});return{remove:function(){o.remove(),s.remove()}}}:function(t,i){return a(t,e,i)}}function c(e){do if(void 0!==e.dojoClick)return e;while(e=e.parentNode)}function h(e,t,o){function s(e){p=I?i.isDescendant(l.doc.elementFromPoint(e.changedTouches?e.changedTouches[0].pageX-l.global.pageXOffset:e.clientX,e.changedTouches?e.changedTouches[0].pageY-l.global.pageYOffset:e.clientY),m):p&&(e.changedTouches?e.changedTouches[0].target:e.target)==m&&Math.abs((e.changedTouches?e.changedTouches[0].pageX-l.global.pageXOffset:e.clientX)-g)<=_&&Math.abs((e.changedTouches?e.changedTouches[0].pageY-l.global.pageYOffset:e.clientY)-b)<=j}function d(e){l.doc.addEventListener(e,function(t){p&&!t._dojo_click&&(new Date).getTime()<=v+1e3&&("INPUT"!=t.target.tagName||!n.contains(t.target,"dijitOffScreen"))&&(t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),"click"!=e||"INPUT"==t.target.tagName&&"radio"!=t.target.type&&"checkbox"!=t.target.type||"TEXTAREA"==t.target.tagName||"AUDIO"==t.target.tagName||"VIDEO"==t.target.tagName||t.preventDefault())},!0)}if(!r.isRight(e)){var u=c(e.target);p=!e.target.disabled&&u&&u.dojoClick,p&&(I="useTarget"==p,m=I?u:e.target,I&&e.preventDefault(),g=e.changedTouches?e.changedTouches[0].pageX-l.global.pageXOffset:e.clientX,b=e.changedTouches?e.changedTouches[0].pageY-l.global.pageYOffset:e.clientY,_=("object"==typeof p?p.x:"number"==typeof p?p:0)||4,j=("object"==typeof p?p.y:"number"==typeof p?p:0)||4,f||(f=!0,l.doc.addEventListener(t,function(e){r.isRight(e)||(s(e),I&&e.preventDefault())},!0),l.doc.addEventListener(o,function(e){function t(t){var i=document.createEvent("MouseEvents");return i._dojo_click=!0,i.initMouseEvent(t,!0,!0,e.view,e.detail,o.screenX,o.screenY,o.clientX,o.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null),i}if(!r.isRight(e)&&(s(e),p)){v=(new Date).getTime();var n=I?m:e.target;"LABEL"===n.tagName&&(n=i.byId(n.getAttribute("for"))||n);var o=e.changedTouches?e.changedTouches[0]:e,d=t("mousedown"),l=t("mouseup"),u=t("click");setTimeout(function(){a.emit(n,"mousedown",d),a.emit(n,"mouseup",l),a.emit(n,"click",u),v=(new Date).getTime()},0)}},!0),d("click"),d("mousedown"),d("mouseup")))}}var f,p,m,g,b,_,j,v,y,C,w=s("ios")<5,k=s("pointer-events")||s("MSPointer"),x=function(){var e={};for(var t in{down:1,move:1,up:1,cancel:1,over:1,out:1})e[t]=s("MSPointer")?"MSPointer"+t.charAt(0).toUpperCase()+t.slice(1):"pointer"+t;return e}(),D=s("touch-events"),I=!1;s("touch")&&d(k?function(){l.doc.addEventListener(x.down,function(e){h(e,x.move,x.up)},!0)}:function(){function e(e){var t=o.delegate(e,{bubbles:!0});return s("ios")>=6&&(t.touches=e.touches,t.altKey=e.altKey,t.changedTouches=e.changedTouches,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.targetTouches=e.targetTouches),t}C=l.body(),l.doc.addEventListener("touchstart",function(e){y=(new Date).getTime();var t=C;C=e.target,a.emit(t,"dojotouchout",{relatedTarget:C,bubbles:!0}),a.emit(C,"dojotouchover",{relatedTarget:t,bubbles:!0}),h(e,"touchmove","touchend")},!0),a(l.doc,"touchmove",function(t){y=(new Date).getTime();var i=l.doc.elementFromPoint(t.pageX-(w?0:l.global.pageXOffset),t.pageY-(w?0:l.global.pageYOffset));i&&(C!==i&&(a.emit(C,"dojotouchout",{relatedTarget:i,bubbles:!0}),a.emit(i,"dojotouchover",{relatedTarget:C,bubbles:!0}),C=i),a.emit(i,"dojotouchmove",e(t))||t.preventDefault())}),a(l.doc,"touchend",function(t){y=(new Date).getTime();var i=l.doc.elementFromPoint(t.pageX-(w?0:l.global.pageXOffset),t.pageY-(w?0:l.global.pageYOffset))||l.body();a.emit(i,"dojotouchend",e(t))})});var T={press:u("mousedown","touchstart",x.down),move:u("mousemove","dojotouchmove",x.move),release:u("mouseup","dojotouchend",x.up),cancel:u(r.leave,"touchcancel",k?x.cancel:null),over:u("mouseover","dojotouchover",x.over),out:u("mouseout","dojotouchout",x.out),enter:r._eventHandler(u("mouseover","dojotouchover",x.over)),leave:r._eventHandler(u("mouseout","dojotouchout",x.out))};return e.touch=T,T});//# sourceMappingURL=touch.js.map