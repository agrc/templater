//>>built
define("dojo/_base/connect",["./kernel","../on","../topic","../aspect","./event","../mouse","./sniff","./lang","../keys"],function(e,t,n,i,o,r,a,s){function d(n,o,a,d,c){if(d=s.hitch(a,d),!n||!n.addEventListener&&!n.attachEvent)return i.after(n||e.global,o,d,!0);if("string"==typeof o&&"on"==o.substring(0,2)&&(o=o.substring(2)),n||(n=e.global),!c)switch(o){case"keypress":o=l;break;case"mouseenter":o=r.enter;break;case"mouseleave":o=r.leave}return t(n,o,d,c)}function c(e){e.keyChar=e.charCode?String.fromCharCode(e.charCode):"",e.charOrCode=e.keyChar||e.keyCode}a.add("events-keypress-typed",function(){var e={charCode:0};try{e=document.createEvent("KeyboardEvent"),(e.initKeyboardEvent||e.initKeyEvent).call(e,"keypress",!0,!0,null,!1,!1,!1,!1,9,3)}catch(t){}return 0==e.charCode&&!a("opera")});var l,u={106:42,111:47,186:59,187:43,188:44,189:45,190:46,191:47,192:96,219:91,220:92,221:93,222:39,229:113},h=a("mac")?"metaKey":"ctrlKey",f=function(e,t){var n=s.mixin({},e,t);return c(n),n.preventDefault=function(){e.preventDefault()},n.stopPropagation=function(){e.stopPropagation()},n};if(a("events-keypress-typed")){var p=function(e,t){try{return e.keyCode=t}catch(e){return 0}};l=function(e,n){var i=t(e,"keydown",function(e){var t=e.keyCode,i=13!=t&&32!=t&&(27!=t||!a("ie"))&&(48>t||t>90)&&(96>t||t>111)&&(186>t||t>192)&&(219>t||t>222)&&229!=t;if(i||e.ctrlKey){var o=i?0:t;if(e.ctrlKey){if(3==t||13==t)return n.call(e.currentTarget,e);o>95&&106>o?o-=48:!e.shiftKey&&o>=65&&90>=o?o+=32:o=u[o]||o}var r=f(e,{type:"keypress",faux:!0,charCode:o});n.call(e.currentTarget,r),a("ie")&&p(e,r.keyCode)}}),o=t(e,"keypress",function(e){var t=e.charCode;return t=t>=32?t:0,e=f(e,{charCode:t,faux:!0}),n.call(this,e)});return{remove:function(){i.remove(),o.remove()}}}}else l=a("opera")?function(e,n){return t(e,"keypress",function(e){var t=e.which;return 3==t&&(t=99),t=32>t&&!e.shiftKey?0:t,e.ctrlKey&&!e.shiftKey&&t>=65&&90>=t&&(t+=32),n.call(this,f(e,{charCode:t}))})}:function(e,n){return t(e,"keypress",function(e){return c(e),n.call(this,e)})};var m={_keypress:l,connect:function(e,t,n,i,o){var r=arguments,a=[],s=0;a.push("string"==typeof r[0]?null:r[s++],r[s++]);var c=r[s+1];a.push("string"==typeof c||"function"==typeof c?r[s++]:null,r[s++]);for(var l=r.length;l>s;s++)a.push(r[s]);return d.apply(this,a)},disconnect:function(e){e&&e.remove()},subscribe:function(e,t,i){return n.subscribe(e,s.hitch(t,i))},publish:function(e,t){return n.publish.apply(n,[e].concat(t))},connectPublisher:function(e,t,n){var i=function(){m.publish(e,arguments)};return n?m.connect(t,n,i):m.connect(t,i)},isCopyKey:function(e){return e[h]}};return m.unsubscribe=m.disconnect,s.mixin(e,m),m});//# sourceMappingURL=connect.js.map