//>>built
define("dojo/_base/connect",["./kernel","../on","../topic","../aspect","./event","../mouse","./sniff","./lang","../keys"],function(e,t,i,n,o,r,s,a){function d(i,o,s,d,l){if(d=a.hitch(s,d),!i||!i.addEventListener&&!i.attachEvent)return n.after(i||e.global,o,d,!0);if("string"==typeof o&&"on"==o.substring(0,2)&&(o=o.substring(2)),i||(i=e.global),!l)switch(o){case"keypress":o=h;break;case"mouseenter":o=r.enter;break;case"mouseleave":o=r.leave}return t(i,o,d,l)}function l(e){e.keyChar=e.charCode?String.fromCharCode(e.charCode):"",e.charOrCode=e.keyChar||e.keyCode}s.add("events-keypress-typed",function(){var e={charCode:0};try{e=document.createEvent("KeyboardEvent"),(e.initKeyboardEvent||e.initKeyEvent).call(e,"keypress",!0,!0,null,!1,!1,!1,!1,9,3)}catch(e){}return 0==e.charCode&&!s("opera")});var h,c={106:42,111:47,186:59,187:43,188:44,189:45,190:46,191:47,192:96,219:91,220:92,221:93,222:39,229:113},u=s("mac")?"metaKey":"ctrlKey",f=function(e,t){var i=a.mixin({},e,t);return l(i),i.preventDefault=function(){e.preventDefault()},i.stopPropagation=function(){e.stopPropagation()},i};if(s("events-keypress-typed")){var p=function(e,t){try{return e.keyCode=t}catch(e){return 0}};h=function(e,i){var n=t(e,"keydown",function(e){var t=e.keyCode,n=13!=t&&32!=t&&(27!=t||!s("ie"))&&(t<48||t>90)&&(t<96||t>111)&&(t<186||t>192)&&(t<219||t>222)&&229!=t;if(n||e.ctrlKey){var o=n?0:t;if(e.ctrlKey){if(3==t||13==t)return i.call(e.currentTarget,e);o>95&&o<106?o-=48:!e.shiftKey&&o>=65&&o<=90?o+=32:o=c[o]||o}var r=f(e,{type:"keypress",faux:!0,charCode:o});i.call(e.currentTarget,r),s("ie")&&p(e,r.keyCode)}}),o=t(e,"keypress",function(e){var t=e.charCode;return t=t>=32?t:0,e=f(e,{charCode:t,faux:!0}),i.call(this,e)});return{remove:function(){n.remove(),o.remove()}}}}else h=s("opera")?function(e,i){return t(e,"keypress",function(e){var t=e.which;return 3==t&&(t=99),t=t<32&&!e.shiftKey?0:t,e.ctrlKey&&!e.shiftKey&&t>=65&&t<=90&&(t+=32),i.call(this,f(e,{charCode:t}))})}:function(e,i){return t(e,"keypress",function(e){return l(e),i.call(this,e)})};var m={_keypress:h,connect:function(e,t,i,n,o){var r=arguments,s=[],a=0;s.push("string"==typeof r[0]?null:r[a++],r[a++]);var l=r[a+1];s.push("string"==typeof l||"function"==typeof l?r[a++]:null,r[a++]);for(var h=r.length;a<h;a++)s.push(r[a]);return d.apply(this,s)},disconnect:function(e){e&&e.remove()},subscribe:function(e,t,n){return i.subscribe(e,a.hitch(t,n))},publish:function(e,t){return i.publish.apply(i,[e].concat(t))},connectPublisher:function(e,t,i){var n=function(){m.publish(e,arguments)};return i?m.connect(t,i,n):m.connect(t,n)},isCopyKey:function(e){return e[u]}};return m.unsubscribe=m.disconnect,a.mixin(e,m),m});//# sourceMappingURL=connect.js.map