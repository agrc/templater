//>>built
define("dojo/_base/fx",["./kernel","./config","./lang","../Evented","./Color","../aspect","../sniff","../dom","../dom-style"],function(t,e,i,n,o,r,s,a,d){var l=i.mixin,c={},u=c._Line=function(t,e){this.start=t,this.end=e};u.prototype.getValue=function(t){return(this.end-this.start)*t+this.start};var h=c.Animation=function(t){l(this,t),i.isArray(this.curve)&&(this.curve=new u(this.curve[0],this.curve[1]))};h.prototype=new n,i.extend(h,{duration:350,repeat:0,rate:20,_percent:0,_startRepeatCount:0,_getStep:function(){var t=this._percent,e=this.easing;return e?e(t):t},_fire:function(t,i){var n=i||[];if(this[t])if(e.debugAtAllCosts)this[t].apply(this,n);else try{this[t].apply(this,n)}catch(t){}return this},play:function(t,e){var n=this;if(n._delayTimer&&n._clearTimer(),e)n._stopTimer(),n._active=n._paused=!1,n._percent=0;else if(n._active&&!n._paused)return n;n._fire("beforeBegin",[n.node]);var o=t||n.delay,r=i.hitch(n,"_play",e);return o>0?(n._delayTimer=setTimeout(r,o),n):(r(),n)},_play:function(t){var e=this;e._delayTimer&&e._clearTimer(),e._startTime=(new Date).valueOf(),e._paused&&(e._startTime-=e.duration*e._percent),e._active=!0,e._paused=!1;var i=e.curve.getValue(e._getStep());return e._percent||(e._startRepeatCount||(e._startRepeatCount=e.repeat),e._fire("onBegin",[i])),e._fire("onPlay",[i]),e._cycle(),e},pause:function(){var t=this;return t._delayTimer&&t._clearTimer(),t._stopTimer(),t._active?(t._paused=!0,t._fire("onPause",[t.curve.getValue(t._getStep())]),t):t},gotoPercent:function(t,e){var i=this;return i._stopTimer(),i._active=i._paused=!0,i._percent=t,e&&i.play(),i},stop:function(t){var e=this;return e._delayTimer&&e._clearTimer(),e._timer?(e._stopTimer(),t&&(e._percent=1),e._fire("onStop",[e.curve.getValue(e._getStep())]),e._active=e._paused=!1,e):e},destroy:function(){this.stop()},status:function(){return this._active?this._paused?"paused":"playing":"stopped"},_cycle:function(){var t=this;if(t._active){var e=(new Date).valueOf(),i=0===t.duration?1:(e-t._startTime)/t.duration;i>=1&&(i=1),t._percent=i,t.easing&&(i=t.easing(i)),t._fire("onAnimate",[t.curve.getValue(i)]),t._percent<1?t._startTimer():(t._active=!1,t.repeat>0?(t.repeat--,t.play(null,!0)):-1==t.repeat?t.play(null,!0):t._startRepeatCount&&(t.repeat=t._startRepeatCount,t._startRepeatCount=0),t._percent=0,t._fire("onEnd",[t.node]),!t.repeat&&t._stopTimer())}return t},_clearTimer:function(){clearTimeout(this._delayTimer),delete this._delayTimer}});var f=0,p=null,m={run:function(){}};i.extend(h,{_startTimer:function(){this._timer||(this._timer=r.after(m,"run",i.hitch(this,"_cycle"),!0),f++),p||(p=setInterval(i.hitch(m,"run"),this.rate))},_stopTimer:function(){this._timer&&(this._timer.remove(),this._timer=null,f--),f<=0&&(clearInterval(p),p=null,f=0)}});var g=s("ie")?function(t){var e=t.style;e.width.length||"auto"!=d.get(t,"width")||(e.width="auto")}:function(){};c._fade=function(t){t.node=a.byId(t.node);var e=l({properties:{}},t),n=e.properties.opacity={};n.start="start"in e?e.start:function(){return+d.get(e.node,"opacity")||0},n.end=e.end;var o=c.animateProperty(e);return r.after(o,"beforeBegin",i.partial(g,e.node),!0),o},c.fadeIn=function(t){return c._fade(l({end:1},t))},c.fadeOut=function(t){return c._fade(l({end:0},t))},c._defaultEasing=function(t){return.5+Math.sin((t+1.5)*Math.PI)/2};var _=function(t){this._properties=t;for(var e in t){var i=t[e];i.start instanceof o&&(i.tempColor=new o)}};return _.prototype.getValue=function(t){var e={};for(var n in this._properties){var r=this._properties[n],s=r.start;s instanceof o?e[n]=o.blendColors(s,r.end,t,r.tempColor).toCss():i.isArray(s)||(e[n]=(r.end-s)*t+s+("opacity"!=n?r.units||"px":0))}return e},c.animateProperty=function(e){var n=e.node=a.byId(e.node);e.easing||(e.easing=t._defaultEasing);var s=new h(e);return r.after(s,"beforeBegin",i.hitch(s,function(){function t(t,e){var i={height:t.offsetHeight,width:t.offsetWidth}[e];return void 0!==i?i:(i=d.get(t,e),"opacity"==e?+i:a?i:parseFloat(i))}var e={};for(var r in this.properties){"width"!=r&&"height"!=r||(this.node.display="block");var s=this.properties[r];i.isFunction(s)&&(s=s(n)),s=e[r]=l({},i.isObject(s)?s:{end:s}),i.isFunction(s.start)&&(s.start=s.start(n)),i.isFunction(s.end)&&(s.end=s.end(n));var a=r.toLowerCase().indexOf("color")>=0;"end"in s?"start"in s||(s.start=t(n,r)):s.end=t(n,r),a?(s.start=new o(s.start),s.end=new o(s.end)):s.start="opacity"==r?+s.start:parseFloat(s.start)}this.curve=new _(e)}),!0),r.after(s,"onAnimate",i.hitch(d,"set",s.node),!0),s},c.anim=function(t,e,i,n,o,r){return c.animateProperty({node:t,duration:i||h.prototype.duration,properties:e,easing:n,onEnd:o}).play(r||0)},l(t,c),t._Animation=h,c});//# sourceMappingURL=fx.js.map